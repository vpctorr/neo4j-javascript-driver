!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).neo4j=t()}(this,function(){"use strict";var B="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function x(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function M(r){var n;return r.__esModule?r:(n=Object.defineProperty({},"__esModule",{value:!0}),Object.keys(r).forEach(function(e){var t=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(n,e,t.get?t:{enumerable:!0,get:function(){return r[e]}})}),n)}var F={},j={},q=(Object.defineProperty(j,"__esModule",{value:!0}),j.default="0.0.0-dev",{});Object.defineProperty(q,"__esModule",{value:!0}),q.logging=void 0,q.logging={console:function(e){return{level:e,logger:function(e,t){return console.log("".concat(Date.now()," ").concat(e.toUpperCase()," ").concat(t))}}}};const z="ServiceUnavailable",H="SessionExpired",W="ProtocolError",V="N/A";class $ extends Error{code;retriable;__proto__;constructor(e,t,r){super(e,null!=r?{cause:r}:void 0),this.constructor=$,this.__proto__=$.prototype,this.code=t,this.name="Neo4jError",this.retriable=(e=t)===z||e===H||"Neo.ClientError.Security.AuthorizationExpired"===e||!0===e?.includes("TransientError")}static isRetriable(e){return null!=e&&e instanceof $&&e.retriable}}function b(e,t,r){return new $(e,t??V,r)}const K=$.isRetriable;const G=new Map;class d{low;high;constructor(e,t){this.low=e??0,this.high=t??0}inSafeRange(){return this.greaterThanOrEqual(d.MIN_SAFE_VALUE)&&this.lessThanOrEqual(d.MAX_SAFE_VALUE)}toInt(){return this.low}toNumber(){return this.high*Y+(this.low>>>0)}toBigInt(){var e;return this.isZero()?BigInt(0):this.isPositive()?BigInt(this.high>>>0)*BigInt(Y)+BigInt(this.low>>>0):(e=this.negate(),BigInt(-1)*(BigInt(e.high>>>0)*BigInt(Y)+BigInt(e.low>>>0)))}toNumberOrInfinity(){return this.lessThan(d.MIN_SAFE_VALUE)?Number.NEGATIVE_INFINITY:this.greaterThan(d.MAX_SAFE_VALUE)?Number.POSITIVE_INFINITY:this.toNumber()}toString(t){if((t=t??10)<2||36<t)throw RangeError("radix out of range: "+t.toString());if(this.isZero())return"0";let r;var e,n;if(this.isNegative())return this.equals(d.MIN_VALUE)?(e=d.fromNumber(t),n=this.div(e),r=n.multiply(e).subtract(this),n.toString(t)+r.toInt().toString(t)):"-"+this.negate().toString(t);var o=d.fromNumber(Math.pow(t,6));r=this;let i="";for(;;){var s=r.div(o);let e=(r.subtract(s.multiply(o)).toInt()>>>0).toString(t);if((r=s).isZero())return e+i;for(;e.length<6;)e="0"+e;i=""+e+i}}valueOf(){return this.toBigInt()}getHighBits(){return this.high}getLowBits(){return this.low}getNumBitsAbs(){if(this.isNegative())return this.equals(d.MIN_VALUE)?64:this.negate().getNumBitsAbs();var e=0!==this.high?this.high:this.low;let t=0;for(t=31;0<t&&0==(e&1<<t);t--);return 0!==this.high?t+33:t+1}isZero(){return 0===this.high&&0===this.low}isNegative(){return this.high<0}isPositive(){return 0<=this.high}isOdd(){return 1==(1&this.low)}isEven(){return 0==(1&this.low)}equals(e){e=d.fromValue(e);return this.high===e.high&&this.low===e.low}notEquals(e){return!this.equals(e)}lessThan(e){return this.compare(e)<0}lessThanOrEqual(e){return this.compare(e)<=0}greaterThan(e){return 0<this.compare(e)}greaterThanOrEqual(e){return 0<=this.compare(e)}compare(e){var t,r,e=d.fromValue(e);return this.equals(e)?0:(t=this.isNegative(),r=e.isNegative(),t&&!r||(t||!r)&&this.subtract(e).isNegative()?-1:1)}negate(){return this.equals(d.MIN_VALUE)?d.MIN_VALUE:this.not().add(d.ONE)}add(e){var e=d.fromValue(e),t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,i=e.high>>>16,s=65535&e.high,a=e.low>>>16,u=0,l=0,h=0,c=0;return h+=(c+=o+(65535&e.low))>>>16,c&=65535,l+=(h+=n+a)>>>16,h&=65535,u+=(l+=r+s)>>>16,l&=65535,u=u+(t+i)&65535,d.fromBits(h<<16|c,u<<16|l)}subtract(e){e=d.fromValue(e);return this.add(e.negate())}multiply(e){var t,r,n,o,i,s,a,u,l,h,c;return this.isZero()||(e=d.fromValue(e)).isZero()?d.ZERO:this.equals(d.MIN_VALUE)?e.isOdd()?d.MIN_VALUE:d.ZERO:e.equals(d.MIN_VALUE)?this.isOdd()?d.MIN_VALUE:d.ZERO:this.isNegative()?e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate():e.isNegative()?this.multiply(e.negate()).negate():this.lessThan(X)&&e.lessThan(X)?d.fromNumber(this.toNumber()*e.toNumber()):(t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,i=e.high>>>16,s=65535&e.high,a=e.low>>>16,c=h=l=u=0,h+=(c+=o*(e=65535&e.low))>>>16,c&=65535,l=((h+=n*e)>>>16)+((h=(h&65535)+o*a)>>>16),h&=65535,u=(u+=(l+=r*e)>>>16)+((l=(l&65535)+n*a)>>>16)+((l=(l&65535)+o*s)>>>16),l&=65535,u=t*e+r*a+n*s+o*i+u&65535,d.fromBits(h<<16|c,u<<16|l))}div(e){var r=d.fromValue(e);if(r.isZero())throw b("division by zero");if(this.isZero())return d.ZERO;let n,o,i;if(this.equals(d.MIN_VALUE))return r.equals(d.ONE)||r.equals(d.NEG_ONE)?d.MIN_VALUE:r.equals(d.MIN_VALUE)?d.ONE:(e=this.shiftRight(1),(n=e.div(r).shiftLeft(1)).equals(d.ZERO)?r.isNegative()?d.ONE:d.NEG_ONE:(o=this.subtract(r.multiply(n)),i=n.add(o.div(r))));if(r.equals(d.MIN_VALUE))return d.ZERO;if(this.isNegative())return r.isNegative()?this.negate().div(r.negate()):this.negate().div(r).negate();if(r.isNegative())return this.div(r.negate()).negate();for(i=d.ZERO,o=this;o.greaterThanOrEqual(r);){n=Math.max(1,Math.floor(o.toNumber()/r.toNumber()));var s=Math.ceil(Math.log(n)/Math.LN2),a=s<=48?1:Math.pow(2,s-48);let e=d.fromNumber(n),t=e.multiply(r);for(;t.isNegative()||t.greaterThan(o);)n-=a,e=d.fromNumber(n),t=e.multiply(r);e.isZero()&&(e=d.ONE),i=i.add(e),o=o.subtract(t)}return i}modulo(e){e=d.fromValue(e);return this.subtract(this.div(e).multiply(e))}not(){return d.fromBits(~this.low,~this.high)}and(e){e=d.fromValue(e);return d.fromBits(this.low&e.low,this.high&e.high)}or(e){e=d.fromValue(e);return d.fromBits(this.low|e.low,this.high|e.high)}xor(e){e=d.fromValue(e);return d.fromBits(this.low^e.low,this.high^e.high)}shiftLeft(e){e=d.toNumber(e);return 0==(e&=63)?d.ZERO:e<32?d.fromBits(this.low<<e,this.high<<e|this.low>>>32-e):d.fromBits(0,this.low<<e-32)}shiftRight(e){var t=d.toNumber(e),e=d.toNumber(e);return 0==(t&=63)?d.ZERO:e<32?d.fromBits(this.low>>>t|this.high<<32-t,this.high>>t):d.fromBits(this.high>>t-32,0<=this.high?0:-1)}static ZERO=d.fromInt(0);static ONE=d.fromInt(1);static NEG_ONE=d.fromInt(-1);static MAX_VALUE=d.fromBits(-1,2147483647);static MIN_VALUE=d.fromBits(0,-2147483648);static MIN_SAFE_VALUE=d.fromBits(1,-2097152);static MAX_SAFE_VALUE=d.fromBits(-1,2097151);static __isInteger__=!0;static isInteger(e){return!0===e?.__isInteger__}static fromInt(e){var t;return-128<=(e|=0)&&e<128&&null!=(t=G.get(e))||(t=new d(e,e<0?-1:0),-128<=e&&e<128&&G.set(e,t)),t}static fromBits(e,t){return new d(e,t)}static fromNumber(e){return isNaN(e)||!isFinite(e)?d.ZERO:e<=-Z?d.MIN_VALUE:e+1>=Z?d.MAX_VALUE:e<0?d.fromNumber(-e).negate():new d(e%Y|0,e/Y|0)}static fromString(t,r,{strictStringValidation:n}={}){if(0===t.length)throw b("number format error: empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return d.ZERO;if((r=r??10)<2||36<r)throw b("radix out of range: "+r.toString());var e;if(0<(e=t.indexOf("-")))throw b('number format error: interior "-" character: '+t);if(0===e)return d.fromString(t.substring(1),r).negate();var o,i,s=d.fromNumber(Math.pow(r,8));let a=d.ZERO;for(let e=0;e<t.length;e+=8){var u,l=Math.min(8,t.length-e),h=t.substring(e,e+l),c=parseInt(h,r);if(!0===n&&(o=h,u=c,i=r,Number.isNaN(o)||Number.isNaN(u)||function(e,t,r){e=e.toString(t),t=Math.max(r-e.length,0),r="0".repeat(t);return""+r+e}(u,i,o.length)!==o.toLowerCase()))throw b(`number format error: "${h}" is NaN in radix ${r}: `+t);a=(l<8?(u=d.fromNumber(Math.pow(r,l)),a.multiply(u)):a=a.multiply(s)).add(d.fromNumber(c))}return a}static fromValue(e,t={}){return e instanceof d?e:"number"==typeof e?(!0===t.ceilFloat&&(e=Math.ceil(e)),d.fromNumber(e)):"string"==typeof e?d.fromString(e,void 0,t):"bigint"==typeof e?d.fromString(e.toString()):new d(e.low,e.high)}static toNumber(e){switch(typeof e){case"number":return e;case"bigint":return Number(e);default:return d.fromValue(e).toNumber()}}static toString(e,t){return d.fromValue(e).toString(t)}static inSafeRange(e){return d.fromValue(e).inSafeRange()}}Object.defineProperty(d.prototype,"__isInteger__",{value:!0,enumerable:!1,configurable:!1});const Y=4294967296,Z=Y*Y/2,X=d.fromInt(1<<24),c=d.fromValue,Q=d.isInteger;var e=d.inSafeRange;const J=d.toNumber;var ee=d.toString;const te="__isBrokenObject__",re="__reason__";function ne(e){return null!==e&&"object"==typeof e&&!0===e[te]}function oe(e){return e[re]}var ie=Object.freeze({__proto__:null,createBrokenObject:function(r,e={}){const n=()=>{throw r};return new Proxy(e,{get:(e,t)=>t===te||(t===re?r:void("toJSON"!==t&&n())),set:n,apply:n,construct:n,defineProperty:n,deleteProperty:n,getOwnPropertyDescriptor:n,getPrototypeOf:n,has:n,isExtensible:n,ownKeys:n,preventExtensions:n,setPrototypeOf:n})},isBrokenObject:ne,getBrokenObjectReason:oe});function f(e){return JSON.stringify(e,(e,t)=>ne(t)?{__isBrokenObject__:!0,__reason__:oe(t)}:"bigint"==typeof t?t+"n":t)}var se=Object.freeze({__proto__:null,stringify:f});const ae="ENCRYPTION_ON";function ue(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}function le(e,t,r){let n="",o=t??{};t=r?.skipAsserts??!1;if("string"==typeof e?n=e:e instanceof String?n=e.toString():"object"==typeof e&&null!=e.text&&(n=e.text,o=e.parameters??{}),!t){r=n;if(ce(r,"Cypher query"),0===r.trim().length)throw new TypeError("Cypher query is expected to be a non-empty string.");e=o;if(!ue(e))throw t=null!=e.constructor?" "+e.constructor.name:"",new TypeError(`Query parameters are expected to either be undefined/null or an object, given:${t} `+JSON.stringify(e))}return{validatedQuery:n,params:o}}function he(e,t){if(ue(e))return e;throw new TypeError(t+" expected to be an object but was: "+f(e))}function ce(e,t){if(_e(e))return e;throw new TypeError(f(t)+" expected to be string but was: "+f(e))}function de(e,t){if("number"!=typeof e)throw new TypeError(t+" expected to be a number but was: "+f(e));return e}function l(e,t){if("number"==typeof e||"bigint"==typeof e||Q(e))return e;throw new TypeError(t+" expected to be either a number or an Integer object but was: "+f(e))}function fe(e,t){if("[object Date]"!==Object.prototype.toString.call(e))throw new TypeError(t+" expected to be a standard JavaScript Date but was: "+f(e));if(Number.isNaN(e.getTime()))throw new TypeError(t+" expected to be valid JavaScript Date but its time was NaN: "+f(e));return e}function _e(e){return"[object String]"===Object.prototype.toString.call(e)}function me(e,t){if(e!==t){if(null===e||null===t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const o of r)if(!me(e[o],t[o]))return!1}return!0}var t=Object.freeze({__proto__:null,isEmptyObjectOrNull:function(e){if(null!==e){if(!ue(e))return!1;for(const t in e)if(void 0!==e[t])return!1}return!0},isObject:ue,isString:_e,assertObject:he,assertString:ce,assertNumber:de,assertNumberOrInteger:l,assertValidDate:fe,validateQueryAndParameters:le,equals:me,ENCRYPTION_ON:ae,ENCRYPTION_OFF:"ENCRYPTION_OFF"});class pe{_minNumber;_maxNumber;_minInteger;_maxInteger;constructor(e,t){this._minNumber=e,this._maxNumber=t,this._minInteger=c(e),this._maxInteger=c(t)}contains(e){var t;return Q(e)&&e instanceof d?e.greaterThanOrEqual(this._minInteger)&&e.lessThanOrEqual(this._maxInteger):"bigint"==typeof e?(t=c(e)).greaterThanOrEqual(this._minInteger)&&t.lessThanOrEqual(this._maxInteger):e>=this._minNumber&&e<=this._maxNumber}toString(){return`[${this._minNumber}, ${this._maxNumber}]`}}const ge=new pe(-999999999,999999999),be=new pe(1,12),ye=new pe(1,31),ve=new pe(0,23),we=new pe(0,59),Ee=new pe(0,59),Te=new pe(0,999999999),Ce=60,Oe=60*Ce,Ie=1e9,ke=Ie*Ce,Re=60*ke,Se=719528;function Pe(e,t){return c(e).add(Xe(t,Ie))}function Ne(e){return Qe(e,Ie)}function Ae(e,t,r,n,o,i,s){e=Ue(e,t,r),t=function(e,t,r){e=c(e),t=c(t),r=c(r);let n=e.multiply(Oe);return(n=n.add(t.multiply(Ce))).add(r)}(n,o,i);return e.multiply(86400).add(t)}function Ue(e,t,r){e=c(e),t=c(t),r=c(r);let n=e.multiply(365);return n=(n=(n=e.greaterThanOrEqual(0)?n.add(e.add(3).div(4).subtract(e.add(99).div(100)).add(e.add(399).div(400))):n.subtract(e.div(-4).subtract(e.div(-100)).add(e.div(-400)))).add(t.multiply(367).subtract(362).div(12))).add(r.subtract(1)),(n=t.greaterThan(2)&&(n=n.subtract(1),!function(e){if((e=c(e)).modulo(4).equals(0)){if(e.modulo(100).equals(0))return!!e.modulo(400).equals(0);return 1}}(e))?n.subtract(1):n).subtract(Se)}function Le(e,t,r,n){return`P${o(e)}M${o(t)}DT${function(e,t){e=c(e),t=c(t);let r,n;var o=e.isNegative(),i=t.greaterThan(0);r=o&&i?e.equals(-1)?"-0":e.add(1).toString():e.toString();i&&(n=Je((o?t.negate().add(2*Ie):t.add(Ie)).modulo(Ie)));return null!=n?r+n:r}(r,n)}S`}function De(e,t,r,n){return o(e,2)+`:${o(t,2)}:`+o(r,2)+Je(n)}function Be(e){var t,r,n;return(e=c(e)).equals(0)?"Z":(t=(r=e.isNegative())?"-":"+",r=o((e=r?e.multiply(-1):e).div(Oe),2),n=o(e.div(Ce).modulo(60),2),null!=(e=(e=e.modulo(Ce)).equals(0)?null:o(e,2))?t+r+`:${n}:`+e:t+r+":"+n)}function xe(e,t,r){return function(e){e=c(e);if(e.isNegative()||e.greaterThan(9999))return o(e,6,{usePositiveSign:!0});return o(e,4)}(e)+`-${o(t,2)}-`+o(r,2)}function Me(e){return new Date(e)}function Fe(e){return new Date(e)}function je(e,t){t=t??0;e=1e6*e.getMilliseconds();return t instanceof d?t.add(e):"bigint"==typeof t?t+BigInt(e):t+e}function qe(e){var t=e.getSeconds()>=e.getUTCSeconds()?e.getSeconds()-e.getUTCSeconds():e.getSeconds()-e.getUTCSeconds()+60,e=e.getTimezoneOffset();return 0===e?0+t:-1*e*Ce+t}function ze(e){return Ze(e,ge,"Year")}function He(e){return Ze(e,be,"Month")}function We(e){return Ze(e,ye,"Day")}function Ve(e){return Ze(e,ve,"Hour")}function $e(e){return Ze(e,we,"Minute")}function Ke(e){return Ze(e,Ee,"Second")}function Ge(e){return Ze(e,Te,"Nanosecond")}function Ye(t,r){try{Intl.DateTimeFormat(void 0,{timeZone:r})}catch(e){throw b(t+` is expected to be a valid ZoneId but was: "${r}"`)}}function Ze(e,t,r){if(l(e,r),t.contains(e))return e;throw b(`${r} is expected to be in range ${t.toString()} but was: `+e.toString())}function Xe(e,t){e=c(e),t=c(t);let r=e.div(t);return r=e.isPositive()!==t.isPositive()&&r.multiply(t).notEquals(e)?r.subtract(1):r}function Qe(e,t){return e=c(e),t=c(t),e.subtract(Xe(e,t).multiply(t))}function Je(e){return(e=c(e)).equals(0)?"":"."+o(e,9)}function o(e,t,r){var n=(e=c(e)).isNegative();let o=(e=n?e.negate():e).toString();if(null!=t)for(;o.length<t;)o="0"+o;return n?"-"+o:!0===r?.usePositiveSign?"+"+o:o}var r=Object.freeze({__proto__:null,YEAR_RANGE:ge,MONTH_OF_YEAR_RANGE:be,DAY_OF_MONTH_RANGE:ye,HOUR_OF_DAY_RANGE:ve,MINUTE_OF_HOUR_RANGE:we,SECOND_OF_MINUTE_RANGE:Ee,NANOSECOND_OF_SECOND_RANGE:Te,MINUTES_PER_HOUR:60,SECONDS_PER_MINUTE:Ce,SECONDS_PER_HOUR:Oe,NANOS_PER_SECOND:Ie,NANOS_PER_MILLISECOND:1e6,NANOS_PER_MINUTE:ke,NANOS_PER_HOUR:Re,DAYS_0000_TO_1970:Se,DAYS_PER_400_YEAR_CYCLE:146097,SECONDS_PER_DAY:86400,normalizeSecondsForDuration:Pe,normalizeNanosecondsForDuration:Ne,localTimeToNanoOfDay:function(e,t,r,n){e=c(e),t=c(t),r=c(r),n=c(n);let o=e.multiply(Re);return(o=(o=o.add(t.multiply(ke))).add(r.multiply(Ie))).add(n)},localDateTimeToEpochSecond:Ae,dateToEpochDay:Ue,durationToIsoString:Le,timeToIsoString:De,timeZoneOffsetToIsoString:Be,dateToIsoString:xe,isoStringToStandardDate:Me,toStandardDate:Fe,newDate:function(e){return new Date(e)},totalNanoseconds:je,timeZoneOffsetInSeconds:qe,assertValidYear:ze,assertValidMonth:He,assertValidDay:We,assertValidHour:Ve,assertValidMinute:$e,assertValidSecond:Ke,assertValidNanosecond:Ge,assertValidZoneId:Ye,floorDiv:Xe,floorMod:Qe}),n={value:!0,enumerable:!1,configurable:!1,writable:!1};const et="__isDuration__",tt="__isLocalTime__",rt="__isTime__",nt="__isDate__",ot="__isLocalDateTime__",it="__isDateTime__";class st{months;days;seconds;nanoseconds;constructor(e,t,r,n){this.months=l(e,"Months"),this.days=l(t,"Days"),l(r,"Seconds"),l(n,"Nanoseconds"),this.seconds=Pe(r,n),this.nanoseconds=Ne(n),Object.freeze(this)}toString(){return Le(this.months,this.days,this.seconds,this.nanoseconds)}}function at(e){return bt(e,et)}Object.defineProperty(st.prototype,et,n);class ut{hour;minute;second;nanosecond;constructor(e,t,r,n){this.hour=Ve(e),this.minute=$e(t),this.second=Ke(r),this.nanosecond=Ge(n),Object.freeze(this)}static fromStandardDate(e,t){vt(e,t);t=je(e,t);return new ut(e.getHours(),e.getMinutes(),e.getSeconds(),t instanceof d?t.toInt():"bigint"==typeof t?c(t).toInt():t)}toString(){return De(this.hour,this.minute,this.second,this.nanosecond)}}function lt(e){return bt(e,tt)}Object.defineProperty(ut.prototype,tt,n);class ht{hour;minute;second;nanosecond;timeZoneOffsetSeconds;constructor(e,t,r,n,o){this.hour=Ve(e),this.minute=$e(t),this.second=Ke(r),this.nanosecond=Ge(n),this.timeZoneOffsetSeconds=l(o,"Time zone offset in seconds"),Object.freeze(this)}static fromStandardDate(e,t){return vt(e,t),new ht(e.getHours(),e.getMinutes(),e.getSeconds(),J(je(e,t)),qe(e))}toString(){return De(this.hour,this.minute,this.second,this.nanosecond)+Be(this.timeZoneOffsetSeconds)}}function ct(e){return bt(e,rt)}Object.defineProperty(ht.prototype,rt,n);class dt{year;month;day;constructor(e,t,r){this.year=ze(e),this.month=He(t),this.day=We(r),Object.freeze(this)}static fromStandardDate(e){return vt(e),new dt(e.getFullYear(),e.getMonth()+1,e.getDate())}toStandardDate(){return Me(this.toString())}toString(){return xe(this.year,this.month,this.day)}}function ft(e){return bt(e,nt)}Object.defineProperty(dt.prototype,nt,n);class _t{year;month;day;hour;minute;second;nanosecond;constructor(e,t,r,n,o,i,s){this.year=ze(e),this.month=He(t),this.day=We(r),this.hour=Ve(n),this.minute=$e(o),this.second=Ke(i),this.nanosecond=Ge(s),Object.freeze(this)}static fromStandardDate(e,t){return vt(e,t),new _t(e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),J(je(e,t)))}toStandardDate(){return Me(this.toString())}toString(){return yt(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)}}function mt(e){return bt(e,ot)}Object.defineProperty(_t.prototype,ot,n);class pt{year;month;day;hour;minute;second;nanosecond;timeZoneOffsetSeconds;timeZoneId;constructor(e,t,r,n,o,i,s,a,u){this.year=ze(e),this.month=He(t),this.day=We(r),this.hour=Ve(n),this.minute=$e(o),this.second=Ke(i),this.nanosecond=Ge(s);var[e,t]=function(e,t){var r=null!=e,n=null!=t&&""!==t;if(!r&&!n)throw b(`Unable to create DateTime without either time zone offset or id. Please specify either of them. Given offset: ${e} and id: `+t);var o=[void 0,void 0];r&&(l(e,"Time zone offset in seconds"),o[0]=e);n&&(ce(t,"Time zone ID"),Ye("Time zone ID",t),o[1]=t);return o}(a,u);this.timeZoneOffsetSeconds=e,this.timeZoneId=t??void 0,Object.freeze(this)}static fromStandardDate(e,t){return vt(e,t),new pt(e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),J(je(e,t)),qe(e),null)}toStandardDate(){return Fe(this._toUTC())}toString(){return yt(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)+(null!=this.timeZoneOffsetSeconds?Be(this.timeZoneOffsetSeconds??0):"")+(null!=this.timeZoneId?`[${this.timeZoneId}]`:"")}_toUTC(){if(void 0===this.timeZoneOffsetSeconds)throw new Error("Requires DateTime created with time zone offset");var e=Ae(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond).subtract(this.timeZoneOffsetSeconds??0);return c(e).multiply(1e3).add(c(this.nanosecond).div(1e6)).toNumber()}}function gt(e){return bt(e,it)}function bt(e,t){return null!=e&&!0===e[t]}function yt(e,t,r,n,o,i,s){return xe(e,t,r)+"T"+De(n,o,i,s)}function vt(e,t){fe(e,"Standard date"),null!=t&&l(t,"Nanosecond")}Object.defineProperty(pt.prototype,it,n);n={value:!0,enumerable:!1,configurable:!1,writable:!1};const wt="__isNode__",Et="__isRelationship__",Tt="__isUnboundRelationship__",Ct="__isPath__",Ot="__isPathSegment__";function It(e,t){return null!=e&&!0===e[t]}class kt{identity;labels;properties;elementId;constructor(e,t,r,n){this.identity=e,this.labels=t,this.properties=r,this.elementId=xt(n,()=>e.toString())}toString(){let t="("+this.elementId;for(let e=0;e<this.labels.length;e++)t+=":"+this.labels[e];var r=Object.keys(this.properties);if(0<r.length){t+=" {";for(let e=0;e<r.length;e++)0<e&&(t+=","),t+=r[e]+":"+f(this.properties[r[e]]);t+="}"}return t+=")"}}function Rt(e){return It(e,wt)}Object.defineProperty(kt.prototype,wt,n);class St{identity;start;end;type;properties;elementId;startNodeElementId;endNodeElementId;constructor(e,t,r,n,o,i,s,a){this.identity=e,this.start=t,this.end=r,this.type=n,this.properties=o,this.elementId=xt(i,()=>e.toString()),this.startNodeElementId=xt(s,()=>t.toString()),this.endNodeElementId=xt(a,()=>r.toString())}toString(){let t="("+this.startNodeElementId+")-[:"+this.type;var r=Object.keys(this.properties);if(0<r.length){t+=" {";for(let e=0;e<r.length;e++)0<e&&(t+=","),t+=r[e]+":"+f(this.properties[r[e]]);t+="}"}return t+="]->("+this.endNodeElementId+")"}}function Pt(e){return It(e,Et)}Object.defineProperty(St.prototype,Et,n);class Nt{identity;type;properties;elementId;constructor(e,t,r,n){this.identity=e,this.type=t,this.properties=r,this.elementId=xt(n,()=>e.toString())}bind(e,t){return new St(this.identity,e,t,this.type,this.properties,this.elementId)}bindTo(e,t){return new St(this.identity,e.identity,t.identity,this.type,this.properties,this.elementId,e.elementId,t.elementId)}toString(){let t="-[:"+this.type;var r=Object.keys(this.properties);if(0<r.length){t+=" {";for(let e=0;e<r.length;e++)0<e&&(t+=","),t+=r[e]+":"+f(this.properties[r[e]]);t+="}"}return t+="]->"}}function At(e){return It(e,Tt)}Object.defineProperty(Nt.prototype,Tt,n);class Ut{start;relationship;end;constructor(e,t,r){this.start=e,this.relationship=t,this.end=r}}function Lt(e){return It(e,Ot)}Object.defineProperty(Ut.prototype,Ot,n);class Dt{start;end;segments;length;constructor(e,t,r){this.start=e,this.end=t,this.segments=r,this.length=r.length}}function Bt(e){return It(e,Ct)}function xt(e,t){return null==e?t():e}Object.defineProperty(Dt.prototype,Ct,n);class Mt{keys;length;_fields;_fieldLookup;constructor(e,t,r){this.keys=e,this.length=e.length,this._fields=t,this._fieldLookup=r??function(e){const r={};return e.forEach((e,t)=>{r[e]=t}),r}(e)}forEach(e){for(var[t,r]of this.entries())e(r,t,this)}map(e){var t,r,n=[];for([t,r]of this.entries())n.push(e(r,t,this));return n}*entries(){for(let e=0;e<this.keys.length;e++)yield[this.keys[e],this._fields[e]]}*values(){for(let e=0;e<this.keys.length;e++)yield this._fields[e]}*[Symbol.iterator](){for(let e=0;e<this.keys.length;e++)yield this._fields[e]}toObject(){var e,t,r={};for([e,t]of this.entries())r[e]=t;return r}get(e){let t;if("number"!=typeof e){if(void 0===(t=this._fieldLookup[e]))throw b(`This record has no field with key '${e.toString()}', available keys are: [`+this.keys.toString()+"].")}else t=e;if(t>this._fields.length-1||t<0)throw b("This record has no field with index '"+t.toString()+"'. Remember that indexes start at `0`, and make sure your query returns records in the shape you meant it to.");return this._fields[t]}has(e){return"number"==typeof e?0<=e&&e<this._fields.length:void 0!==this._fieldLookup[e]}}const Ft="__isPoint__";class jt{srid;x;y;z;constructor(e,t,r,n){this.srid=l(e,"SRID"),this.x=de(t,"X coordinate"),this.y=de(r,"Y coordinate"),this.z=null==n?n:de(n,"Z coordinate"),Object.freeze(this)}toString(){return null==this.z||isNaN(this.z)?`Point{srid=${qt(this.srid)}, x=${qt(this.x)}, y=${qt(this.y)}}`:`Point{srid=${qt(this.srid)}, x=${qt(this.x)}, y=${qt(this.y)}, z=${qt(this.z)}}`}}function qt(e){return Number.isInteger(e)?e.toString()+".0":e.toString()}function zt(e){return null!=e&&!0===e[Ft]}Object.defineProperty(jt.prototype,Ft,{value:!0,enumerable:!1,configurable:!1,writable:!1});class Ht{query;queryType;counters;updateStatistics;plan;profile;notifications;server;resultConsumedAfter;resultAvailableAfter;database;constructor(e,t,r,n){this.query={text:e,parameters:t},this.queryType=r.type,this.counters=new Kt(r.stats??{}),this.updateStatistics=this.counters,this.plan=(null!=r.plan||null!=r.profile)&&new Wt(r.plan??r.profile),this.profile=null!=r.profile&&new Vt(r.profile),this.notifications=this._buildNotifications(r.notifications),this.server=new Jt(r.server,n),this.resultConsumedAfter=r.result_consumed_after,this.resultAvailableAfter=r.result_available_after,this.database={name:r.db??null}}_buildNotifications(e){return null==e?[]:e.map(function(e){return new Qt(e)})}hasPlan(){return this.plan instanceof Wt}hasProfile(){return this.profile instanceof Vt}}class Wt{operatorType;identifiers;arguments;children;constructor(e){this.operatorType=e.operatorType,this.identifiers=e.identifiers,this.arguments=e.args,this.children=null!=e.children?e.children.map(e=>new Wt(e)):[]}}class Vt{operatorType;identifiers;arguments;dbHits;rows;pageCacheMisses;pageCacheHits;pageCacheHitRatio;time;children;constructor(e){this.operatorType=e.operatorType,this.identifiers=e.identifiers,this.arguments=e.args,this.dbHits=tr("dbHits",e),this.rows=tr("rows",e),this.pageCacheMisses=tr("pageCacheMisses",e),this.pageCacheHits=tr("pageCacheHits",e),this.pageCacheHitRatio=tr("pageCacheHitRatio",e),this.time=tr("time",e),this.children=null!=e.children?e.children.map(e=>new Vt(e)):[]}hasPageCacheStats(){return 0<this.pageCacheMisses||0<this.pageCacheHits||0<this.pageCacheHitRatio}}class $t{nodesCreated;nodesDeleted;relationshipsCreated;relationshipsDeleted;propertiesSet;labelsAdded;labelsRemoved;indexesAdded;indexesRemoved;constraintsAdded;constraintsRemoved;constructor(){this.nodesCreated=0,this.nodesDeleted=0,this.relationshipsCreated=0,this.relationshipsDeleted=0,this.propertiesSet=0,this.labelsAdded=0,this.labelsRemoved=0,this.indexesAdded=0,this.indexesRemoved=0,this.constraintsAdded=0,this.constraintsRemoved=0}}class Kt{_stats;_systemUpdates;_containsSystemUpdates;_containsUpdates;constructor(r){this._stats={nodesCreated:0,nodesDeleted:0,relationshipsCreated:0,relationshipsDeleted:0,propertiesSet:0,labelsAdded:0,labelsRemoved:0,indexesAdded:0,indexesRemoved:0,constraintsAdded:0,constraintsRemoved:0},this._systemUpdates=0,Object.keys(r).forEach(e=>{var t=e.replace(/(-\w)/g,e=>e[1].toUpperCase());t in this._stats?this._stats[t]=er(r[e]):"systemUpdates"===t?this._systemUpdates=er(r[e]):"containsSystemUpdates"===t?this._containsSystemUpdates=r[e]:"containsUpdates"===t&&(this._containsUpdates=r[e])}),this._stats=Object.freeze(this._stats)}containsUpdates(){return void 0!==this._containsUpdates?this._containsUpdates:0<Object.keys(this._stats).reduce((e,t)=>e+this._stats[t],0)}updates(){return this._stats}containsSystemUpdates(){return void 0!==this._containsSystemUpdates?this._containsSystemUpdates:0<this._systemUpdates}systemUpdates(){return this._systemUpdates}}const Gt={WARNING:"WARNING",INFORMATION:"INFORMATION",UNKNOWN:"UNKNOWN"},Yt=(Object.freeze(Gt),Object.values(Gt)),Zt={HINT:"HINT",UNRECOGNIZED:"UNRECOGNIZED",UNSUPPORTED:"UNSUPPORTED",PERFORMANCE:"PERFORMANCE",DEPRECATION:"DEPRECATION",TOPOLOGY:"TOPOLOGY",SECURITY:"SECURITY",GENERIC:"GENERIC",UNKNOWN:"UNKNOWN"},Xt=(Object.freeze(Zt),Object.values(Zt));class Qt{code;title;description;severity;position;severityLevel;category;rawSeverityLevel;rawCategory;constructor(e){this.code=e.code,this.title=e.title,this.description=e.description,this.severity=e.severity,this.position=Qt._constructPosition(e.position),this.severityLevel=Yt.includes(e.severity)?e.severity:Gt.UNKNOWN,this.rawSeverityLevel=e.severity,this.category=Xt.includes(e.category)?e.category:Zt.UNKNOWN,this.rawCategory=e.category}static _constructPosition(e){return null==e?{}:{offset:er(e.offset),line:er(e.line),column:er(e.column)}}}class Jt{address;protocolVersion;agent;constructor(e,t){null!=e&&(this.address=e.address,this.agent=e.version),this.protocolVersion=t}}function er(e){return e instanceof d?e.toNumber():"bigint"==typeof e?c(e).toNumber():e}function tr(e,t,r=0){return!1!==t&&e in t?er(t[e]):r}var n={READ_ONLY:"r",READ_WRITE:"rw",WRITE_ONLY:"w",SCHEMA_WRITE:"s"},rr={OFF:"OFF",WARNING:"WARNING",INFORMATION:"INFORMATION"},nr=(Object.freeze(rr),{HINT:"HINT",UNRECOGNIZED:"UNRECOGNIZED",UNSUPPORTED:"UNSUPPORTED",PERFORMANCE:"PERFORMANCE",TOPOLOGY:"TOPOLOGY",SECURITY:"SECURITY",DEPRECATION:"DEPRECATION",GENERIC:"GENERIC"});Object.freeze(nr);class or{subscribe(e){ir(e,e.onKeys,[]),ir(e,e.onCompleted,{})}cancel(){}pause(){}resume(){}prepareToHandleSingleResponse(){}markCompleted(){}onError(e){throw new Error("CompletedObserver not supposed to call onError",{cause:e})}}class _{_error;_beforeError;_observers;constructor({error:e,onError:t}){this._error=e,this._beforeError=t,this._observers=[],this.onError(e)}subscribe(e){ir(e,e.onError,this._error),this._observers.push(e)}onError(t){ir(this,this._beforeError,t),this._observers.forEach(e=>ir(e,e.onError,t))}cancel(){}pause(){}resume(){}markCompleted(){}prepareToHandleSingleResponse(){}}function ir(e,t,r){null!=t&&t.bind(e)(r)}var sr=Object.freeze({__proto__:null,CompletedObserver:or,FailedObserver:_});class m{_values;constructor(e){this._values=function(e){if(null==e||""===e)return[];if(_e(e))return[e];if(Array.isArray(e)){var t=new Set,r=function r(e){return e.reduce((e,t)=>Array.isArray(t)?e.concat(r(t)):e.concat(t),[])}(e);for(let e=0;e<r.length;e++){var n=r[e];if(null!=n){if(!_e(n))throw new TypeError(`Bookmark value should be a string, given: '${n}'`);t.add(n)}}return[...t]}throw new TypeError(`Bookmarks should either be a string or a string array, given: '${e}'`)}(e)}static empty(){return ar}isEmpty(){return 0===this._values.length}values(){return this._values}[Symbol.iterator](){return this._values[Symbol.iterator]()}asBeginTransactionParameters(){return this.isEmpty()?{}:{bookmarks:this._values}}}const ar=new m(null);var ur=Object.freeze({__proto__:null,Bookmarks:m});const lr=-1,hr=3e4,cr="READ",p="WRITE";const dr={MANAGED_TRANSACTION:0,UNMANAGED_TRANSACTION:1,AUTO_COMMIT_TRANSACTION:2,EXECUTE_QUERY:3};var i=Object.freeze({__proto__:null,FETCH_ALL:lr,ACCESS_MODE_READ:cr,ACCESS_MODE_WRITE:p,DEFAULT_CONNECTION_TIMEOUT_MILLIS:hr,DEFAULT_POOL_ACQUISITION_TIMEOUT:6e4,DEFAULT_POOL_MAX_SIZE:100,BOLT_PROTOCOL_V1:1,BOLT_PROTOCOL_V2:2,BOLT_PROTOCOL_V3:3,BOLT_PROTOCOL_V4_0:4,BOLT_PROTOCOL_V4_1:4.1,BOLT_PROTOCOL_V4_2:4.2,BOLT_PROTOCOL_V4_3:4.3,BOLT_PROTOCOL_V4_4:4.4,BOLT_PROTOCOL_V5_0:5,BOLT_PROTOCOL_V5_1:5.1,BOLT_PROTOCOL_V5_2:5.2,BOLT_PROTOCOL_V5_3:5.3,BOLT_PROTOCOL_V5_4:5.4,TELEMETRY_APIS:dr});const fr="error",_r="warn",mr="info",pr="debug",gr=(mr,{error:0,warn:1,info:2,debug:3});class br{_level;_loggerFunction;constructor(e,t){this._level=e,this._loggerFunction=t}static create(e){var t;return null!=e?.logging?(t=function(e){if(null==e?.level)return"info";{var e=e.level,t=gr[e];if(null==t&&0!==t)throw b(`Illegal logging level: ${e}. Supported levels are: `+Object.keys(gr).toString());return e}}(e=e.logging),e=function(e){if(null!=e?.logger){var t=e.logger;if(null!=t&&"function"==typeof t)return t}throw b("Illegal logger function: "+(e?.logger?.toString()??"undefined"))}(e),new br(t,e)):this.noOp()}static noOp(){return yr}isErrorEnabled(){return vr(this._level,fr)}error(e){this.isErrorEnabled()&&this._loggerFunction(fr,e)}isWarnEnabled(){return vr(this._level,_r)}warn(e){this.isWarnEnabled()&&this._loggerFunction(_r,e)}isInfoEnabled(){return vr(this._level,mr)}info(e){this.isInfoEnabled()&&this._loggerFunction(mr,e)}isDebugEnabled(){return vr(this._level,pr)}debug(e){this.isDebugEnabled()&&this._loggerFunction(pr,e)}}br;const yr=new class extends br{constructor(){super(mr,(e,t)=>{})}isErrorEnabled(){return!1}error(e){}isWarnEnabled(){return!1}warn(e){}isInfoEnabled(){return!1}info(e){}isDebugEnabled(){return!1}debug(e){}};function vr(e,t){return gr[e]>=gr[t]}var wr=Object.freeze({__proto__:null,Logger:br});class Er{_mode;_database;_bookmarks;_connectionProvider;_referenceCount;_connectionPromise;_impersonatedUser;_getConnectionAcquistionBookmarks;_onDatabaseNameResolved;_auth;_log;_closed;constructor({mode:e,database:t="",bookmarks:r,connectionProvider:n,impersonatedUser:o,onDatabaseNameResolved:i,getConnectionAcquistionBookmarks:s,auth:a,log:u}){this._mode=e??p,this._closed=!1,this._database=null!=t?ce(t,"database"):"",this._bookmarks=r??m.empty(),this._connectionProvider=n,this._impersonatedUser=o,this._referenceCount=0,this._connectionPromise=Promise.resolve(null),this._onDatabaseNameResolved=i,this._auth=a,this._log=u,this._logError=this._logError.bind(this),this._getConnectionAcquistionBookmarks=s??(()=>Promise.resolve(m.empty()))}mode(){return this._mode}database(){return this._database}setDatabase(e){this._database=e}bookmarks(){return this._bookmarks}connectionProvider(){return this._connectionProvider}referenceCount(){return this._referenceCount}initializeConnection(){return 0!==this._referenceCount||null==this._connectionProvider?(this._referenceCount++,!1):(this._connectionPromise=this._createConnectionPromise(this._connectionProvider),this._referenceCount++,!0)}async _createConnectionPromise(e){return e.acquireConnection({accessMode:this._mode,database:this._database,bookmarks:await this._getBookmarks(),impersonatedUser:this._impersonatedUser,onDatabaseNameResolved:this._onDatabaseNameResolved,auth:this._auth})}async _getBookmarks(){return this._getConnectionAcquistionBookmarks()}getConnection(){return this._connectionPromise}releaseConnection(){return 0!==this._referenceCount&&(this._referenceCount--,0===this._referenceCount)?this._releaseConnection():this._connectionPromise}close(e){return this._closed=!0,0===this._referenceCount?this._connectionPromise:(this._referenceCount=0,this._releaseConnection(e))}log(){return this._log}_releaseConnection(t){return this._connectionPromise=this._connectionPromise.then(e=>null!=e?e.isOpen()&&(e.hasOngoingObservableRequests()||!0===t)?e.resetAndFlush().catch(Or).then(()=>e.release().then(()=>null)):e.release().then(()=>null):Promise.resolve(null)).catch(this._logError),this._connectionPromise}_logError(e){return this._log.isWarnEnabled()&&this._log.warn(`ConnectionHolder got an error while releasing the connection. Error ${e}. Stacktrace: `+e.stack),null}}class Tr extends Er{_connectionHolder;constructor(e){super({mode:e.mode(),database:e.database(),bookmarks:e.bookmarks(),getConnectionAcquistionBookmarks:e._getConnectionAcquistionBookmarks,connectionProvider:e.connectionProvider(),log:e.log()}),this._connectionHolder=e}initializeConnection(){return 0!==this._connectionHolder.referenceCount()}getConnection(){return this._connectionHolder.getConnection()}releaseConnection(){return this._connectionHolder.getConnection().catch(()=>Promise.resolve(null))}close(){return this._connectionHolder.getConnection().catch(()=>Promise.resolve(null))}}Er;const Cr=new class extends Er{constructor(){super({log:br.create({})})}mode(){}database(){}initializeConnection(){return!0}async getConnection(){return Promise.reject(b("This connection holder does not serve connections"))}async releaseConnection(){return Promise.resolve(null)}async close(){return Promise.resolve(null)}};function Or(e){return null}var Ir=Object.freeze({__proto__:null,default:Tr,ConnectionHolder:Er,ReadOnlyConnectionHolder:Tr,EMPTY_CONNECTION_HOLDER:Cr});class g{timeout;metadata;constructor(e,t){var r;null!=(r=e)&&he(r,"Transaction config"),this.timeout=function(e,t){if(ue(e)&&null!=e.timeout){l(e.timeout,"Transaction timeout"),!function(e){return"number"==typeof e.timeout&&!Number.isInteger(e.timeout)}(e)||!0!==t?.isInfoEnabled()||t?.info(`Transaction timeout expected to be an integer, got: ${e.timeout}. The value will be rounded up.`);t=c(e.timeout,{ceilFloat:!0});if(t.isNegative())throw b("Transaction timeout should not be negative");return t}return null}(e,t),this.metadata=function(e){if(ue(e)&&null!=e.metadata){e=e.metadata;if(he(e,"config.metadata"),0!==Object.keys(e).length)return e}return null}(e)}static empty(){return kr}isEmpty(){return Object.values(this).every(e=>null==e)}}const kr=new g({});var s=Object.freeze({__proto__:null,TxConfig:g});class Rr{_maxRetryTimeMs;_initialRetryDelayMs;_multiplier;_jitterFactor;_inFlightTimeoutIds;_setTimeout;_clearTimeout;telemetryApi;pipelineBegin;constructor(e,t,r,n,o={setTimeout:function(e,t,...r){return setTimeout(e,t,...r)},clearTimeout:function(e){return clearTimeout(e)}}){this._maxRetryTimeMs=Sr(e,3e4),this._initialRetryDelayMs=Sr(t,1e3),this._multiplier=Sr(r,2),this._jitterFactor=Sr(n,.2),this._setTimeout=o.setTimeout,this._clearTimeout=o.clearTimeout,this._inFlightTimeoutIds=[],this.pipelineBegin=!1,this.telemetryApi=dr.MANAGED_TRANSACTION,this._verifyAfterConstruction()}execute(n,o,i){const s={apiTransactionConfig:{api:this.telemetryApi,onTelemetrySuccess:()=>{s.apiTransactionConfig=void 0}}};return new Promise((e,t)=>{this._executeTransactionInsidePromise(n,o,e,t,i,s).catch(t)}).catch(e=>{var t=Date.now(),r=this._initialRetryDelayMs;return this._retryTransactionPromise(n,o,e,t,r,i,s)})}close(){this._inFlightTimeoutIds.forEach(e=>this._clearTimeout(e)),this._inFlightTimeoutIds=[]}_retryTransactionPromise(o,i,e,r,s,a,u){return Date.now()-r>this._maxRetryTimeMs||!K(e)?Promise.reject(e):new Promise((e,t)=>{var r=this._computeDelayWithJitter(s);const n=this._setTimeout(()=>{this._inFlightTimeoutIds=this._inFlightTimeoutIds.filter(e=>e!==n),this._executeTransactionInsidePromise(o,i,e,t,a,u).catch(t)},r);this._inFlightTimeoutIds.push(n)}).catch(e=>{var t=s*this._multiplier;return this._retryTransactionPromise(o,i,e,r,t,a,u)})}async _executeTransactionInsidePromise(e,t,r,n,o,i){let s;try{var a=e(null!=i?.apiTransactionConfig?{...i?.apiTransactionConfig}:void 0);s=this.pipelineBegin?a:await a}catch(e){return void n(e)}e=(o??(e=>e))(s);this._safeExecuteTransactionWork(e,t).then(e=>this._handleTransactionWorkSuccess(e,s,r,n)).catch(e=>this._handleTransactionWorkFailure(e,s,n))}_safeExecuteTransactionWork(e,t){try{var r=t(e);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}_handleTransactionWorkSuccess(e,t,r,n){t.isOpen()?t.commit().then(()=>{r(e)}).catch(e=>{n(e)}):r(e)}_handleTransactionWorkFailure(e,t,r){t.isOpen()?t.rollback().catch(e=>{}).then(()=>r(e)).catch(r):r(e)}_computeDelayWithJitter(e){var t=e*this._jitterFactor,r=e-t,e=e+t;return Math.random()*(e-r)+r}_verifyAfterConstruction(){if(this._maxRetryTimeMs<0)throw b("Max retry time should be >= 0: "+this._maxRetryTimeMs.toString());if(this._initialRetryDelayMs<0)throw b("Initial retry delay should >= 0: "+this._initialRetryDelayMs.toString());if(this._multiplier<1)throw b("Multiplier should be >= 1.0: "+this._multiplier.toString());if(this._jitterFactor<0||1<this._jitterFactor)throw b("Jitter factor should be in [0.0, 1.0]: "+this._jitterFactor.toFixed())}}function Sr(e,t){return null!=e?e:t}var Pr=Object.freeze({__proto__:null,TransactionExecutor:Rr});const Nr=7687,Ar=7474,Ur=7473;class Lr{scheme;host;port;hostAndPort;query;constructor(e,t,r,n,o){this.scheme=e,this.host=t,this.port=r,this.hostAndPort=n,this.query=o}}function Dr(e){ce(e,"URL");var t=(t=(t=e).trim()).includes("://")?{schemeMissing:!1,url:t}:{schemeMissing:!0,url:"none://"+t},r=function(e){function s(e,t){t=e.indexOf(t);return 0<=t?[e.substring(0,t),e[t],e.substring(t+1)]:[e,"",""]}function t(e){var t={};let r;"@"===(r=(i="@",0<=(i=(o=e).lastIndexOf(i))?[o.substring(0,i),o[i],o.substring(i+1)]:["","",o]))[1]&&(t.userInfo=decodeURIComponent(r[0]),e=r[2]);i="]",o=s(o=e,n="[");var n,[o,i]=[(n=s(o[2],i))[0],n[2]];return""!==o?(t.host=o,r=s(i,":")):(r=s(e,":"),t.host=r[0]),":"===r[1]&&(t.port=r[2]),t}let r={},n;":"===(n=s(e,":"))[1]&&(r.scheme=decodeURIComponent(n[0]),e=n[2]);"#"===(n=s(e,"#"))[1]&&(r.fragment=decodeURIComponent(n[2]),e=n[0]);"?"===(n=s(e,"?"))[1]&&(r.query=n[2],e=n[0]);e.startsWith("//")?(n=s(e.substr(2),"/"),(r={...r,...t(n[0])}).path=n[1]+n[2]):r.path=e;return r}(t.url),t=t.schemeMissing?null:function(e){if(null==e)return null;":"===(e=e.trim()).charAt(e.length-1)&&(e=e.substring(0,e.length-1));return e}(r.scheme),n=function(e){if(null!=e)return e.trim();throw new Error("Unable to extract host from null or undefined URL")}(r.host),o=function(e){if(""===e||null==e)throw new Error("Illegal host "+e);var t=e.includes(":");return t?xr(e):e}(n),i=function(e,t){e="string"==typeof e?parseInt(e,10):e;return null==e||isNaN(e)?Mr(t):e}(r.port,t),o=o+":"+i,r=function(e,r){const t=null!=e?function(e){"?"===(e=(e??"").trim())?.charAt(0)&&(e=e.substring(1,e.length));return e}(e):null,n={};null!=t&&t.split("&").forEach(e=>{e=e.split("=");if(2!==e.length)throw new Error(`Invalid parameters: '${e.toString()}' in URL '${r}'.`);var t=Br(e[0],"key",r),e=Br(e[1],"value",r);if(void 0!==n[t])throw new Error(`Duplicated query parameters with key '${t}' in URL '${r}'`);n[t]=e});return n}(r.query??function(e){if("string"!=typeof e)return null;var[,e]=e.split("?");return e}(r.resourceName),e);return new Lr(t,n,i,o,r)}function Br(e,t,r){if(""===(e=(e??"").trim()))throw new Error(`Illegal empty ${t} in URL query '${r}'`);return e}function xr(e){var t="["===e.charAt(0),r="]"===e.charAt(e.length-1);if(t||r){if(t&&r)return e;throw new Error("Illegal IPv6 address "+e)}return`[${e}]`}function Mr(e){return"http"===e?Ar:"https"===e?Ur:Nr}var Fr=Object.freeze({__proto__:null,parseDatabaseUrl:Dr,defaultPortForScheme:Mr,formatIPv4Address:function(e,t){return e+":"+t},formatIPv6Address:function(e,t){return xr(e)+":"+t},Url:Lr});class jr{_host;_resolved;_port;_hostPort;_stringValue;constructor(e,t,r,n){this._host=ce(e,"host"),this._resolved=null!=t?ce(t,"resolved"):null,this._port=de(r,"port"),this._hostPort=n,this._stringValue=null!=t?n+`(${t})`:""+n}host(){return this._host}resolvedHost(){return null!=this._resolved?this._resolved:this._host}port(){return this._port}resolveWith(e){return new jr(this._host,e,this._port,this._hostPort)}asHostPort(){return this._hostPort}asKey(){return this._hostPort}toString(){return this._stringValue}static fromUrl(e){e=Dr(e);return new jr(e.host,null,e.port,e.hostAndPort)}}var qr=Object.freeze({__proto__:null,ServerAddress:jr});function zr(e){return Promise.resolve([e])}class Hr{_resolverFunction;constructor(e){this._resolverFunction=e??zr}resolve(t){return new Promise(e=>e(this._resolverFunction(t.asHostPort()))).then(e=>{if(Array.isArray(e))return e.map(e=>jr.fromUrl(e));throw new TypeError("Configured resolver function should either return an array of addresses or a Promise resolved with an array of addresses.Each address is '<host>:<port>'. Got: "+e)})}}var Wr=Object.freeze({__proto__:null,BaseHostNameResolver:class{resolve(){throw new Error("Abstract function")}_resolveToItself(e){return Promise.resolve([e])}},ConfiguredCustomResolver:Hr});t=Object.freeze({__proto__:null,util:t,temporalUtil:r,observer:sr,bookmarks:ur,constants:i,connectionHolder:Ir,txConfig:s,transactionExecutor:Pr,logger:wr,urlUtil:Fr,serverAddress:qr,resolver:Wr,objectUtil:ie,boltAgent:Object.freeze({__proto__:null,fromVersion:function(e,t=()=>({get userAgent(){}})){return t=t(),{product:"neo4j-javascript/"+e,platform:null!=t.userAgent?t.userAgent.split("(")[1].split(")")[0]:void 0,languageDetails:t.userAgent||void 0}}})});const Vr=Ir["EMPTY_CONNECTION_HOLDER"],$r=e=>{console.log("Uncaught error when processing result: "+e)},Kr=e=>{},Gr=e=>{};class Yr{_stack;_streamObserverPromise;_p;_query;_parameters;_connectionHolder;_keys;_summary;_error;_watermarks;constructor(e,t,r,n,o={high:Number.MAX_VALUE,low:Number.MAX_VALUE}){var i;this._stack=null==(i=new Error("")).stack?null:i.stack.replace(/^Error(\n\r)*/,""),this._streamObserverPromise=e,this._p=null,this._query=t,this._parameters=r??{},this._connectionHolder=n??Vr,this._keys=null,this._summary=null,this._error=null,this._watermarks=o}keys(){return null!==this._keys?Promise.resolve(this._keys):null!==this._error?Promise.reject(this._error):new Promise((t,r)=>{this._streamObserverPromise.then(e=>e.subscribe(this._decorateObserver({onKeys:e=>t(e),onError:e=>r(e)}))).catch(r)})}summary(){return null!==this._summary?Promise.resolve(this._summary):null!==this._error?Promise.reject(this._error):new Promise((t,r)=>{this._streamObserverPromise.then(e=>{e.cancel(),e.subscribe(this._decorateObserver({onCompleted:e=>t(e),onError:e=>r(e)}))}).catch(r)})}_getOrCreatePromise(){return null==this._p&&(this._p=new Promise((t,r)=>{const n=[];this.subscribe({onNext:e=>{n.push(e)},onCompleted:e=>{t({records:n,summary:e})},onError:e=>{r(e)}})})),this._p}[Symbol.asyncIterator](){if(!this.isOpen()){const t=b("Result is already consumed");return{next:()=>Promise.reject(t),peek:()=>Promise.reject(t)}}const r={paused:!0,firstRun:!0,finished:!1},e=()=>{var e,t;null!=r.streaming&&(e=(t=r.queuedObserver?.size??0)>=this._watermarks.high,t=t<=this._watermarks.low,e&&!r.paused?(r.paused=!0,r.streaming.pause()):(t&&r.paused||r.firstRun&&!e)&&(r.firstRun=!1,r.paused=!1,r.streaming.resume()))},n=async()=>(void 0===r.queuedObserver&&(r.queuedObserver=this._createQueuedResultObserver(e),r.streaming=await this._subscribe(r.queuedObserver,!0).catch(()=>{}),e()),r.queuedObserver),o=e=>{if(void 0===e)throw b("InvalidState: Result stream finished without Summary",W);return!0};return{next:async()=>{var e;return r.finished&&o(r.summary)?{done:!0,value:r.summary}:(!0===(e=await(await n()).dequeue()).done&&(r.finished=e.done,r.summary=e.value),e)},return:async e=>{if(r.finished&&o(r.summary))return{done:!0,value:e??r.summary};r.streaming?.cancel();var t=await(await n()).dequeueUntilDone();return r.finished=!0,t.value=e??t.value,r.summary=t.value,t},peek:async()=>{return r.finished&&o(r.summary)?{done:!0,value:r.summary}:(await n()).head()}}}then(e,t){return this._getOrCreatePromise().then(e,t)}catch(e){return this._getOrCreatePromise().catch(e)}[Symbol.toStringTag]="Result";finally(e){return this._getOrCreatePromise().finally(e)}subscribe(e){this._subscribe(e).catch(()=>{})}isOpen(){return null===this._summary&&null===this._error}_subscribe(e,t=!1){const r=this._decorateObserver(e);return this._streamObserverPromise.then(e=>(t&&e.pause(),e.subscribe(r),e)).catch(e=>(null!=r.onError&&r.onError(e),Promise.reject(e)))}_decorateObserver(n){const t=n.onCompleted??Kr,o=n.onError??$r,r=n.onKeys??Gr;return{onNext:null!=n.onNext?n.onNext.bind(n):void 0,onKeys:e=>(this._keys=e,r.call(n,e)),onCompleted:e=>{this._releaseConnectionAndGetSummary(e).then(e=>null!==this._summary?t.call(n,this._summary):(this._summary=e,t.call(n,e))).catch(o)},onError:r=>{this._connectionHolder.releaseConnection().then(()=>{var e,t;e=r,null!=(t=this._stack)&&(e.stack=e.toString()+"\n"+t),this._error=r,o.call(n,r)}).catch(o)}}}_cancel(){null===this._summary&&null===this._error&&this._streamObserverPromise.then(e=>e.cancel()).catch(()=>{})}_releaseConnectionAndGetSummary(t){const{validatedQuery:r,params:n}=le(this._query,this._parameters,{skipAsserts:!0}),o=this._connectionHolder;return o.getConnection().then(e=>o.releaseConnection().then(()=>e?.getProtocolVersion()),e=>{}).then(e=>new Ht(r,n,t,e))}_createQueuedResultObserver(r){function n(){const r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r}function o(e){return e instanceof Error}async function t(){if(0<i.length){var e=i.shift()??b("Unexpected empty buffer",W);if(r(),o(e))throw e;return e}return s.resolvable=n(),s.resolvable.promise}const i=[],s={resolvable:null},a={onNext:e=>{a._push({done:!1,value:e})},onCompleted:e=>{a._push({done:!0,value:e})},onError:e=>{a._push(e)},_push(e){var t;null!==s.resolvable?(t=s.resolvable,s.resolvable=null,o(e)?t.reject(e):t.resolve(e)):(i.push(e),r())},dequeue:t,dequeueUntilDone:async()=>{for(;;){var e=await t();if(!0===e.done)return e}},head:async()=>{if(0<i.length){var e=i[0];if(o(e))throw e;return e}s.resolvable=n();try{var t=await s.resolvable.promise;return i.unshift(t),t}catch(e){throw i.unshift(e),e}finally{r()}},get size(){return i.length}};return a}}class Zr{keys;records;summary;constructor(e,t,r){this.keys=e,this.records=t,this.summary=r}}class Xr{acquireConnection(e){throw Error("Not implemented")}supportsMultiDb(){throw Error("Not implemented")}supportsTransactionConfig(){throw Error("Not implemented")}supportsUserImpersonation(){throw Error("Not implemented")}supportsSessionAuth(){throw Error("Not implemented")}verifyConnectivityAndGetServerInfo(e){throw Error("Not implemented")}verifyAuthentication(e){throw Error("Not implemented")}getNegotiatedProtocolVersion(){throw Error("Not Implemented")}close(){throw Error("Not implemented")}}class Qr{beginTransaction(e){throw new Error("Not implemented")}run(e,t,r){throw new Error("Not implemented")}commitTransaction(e){throw new Error("Not implemented")}rollbackTransaction(e){throw new Error("Not implemented")}resetAndFlush(){throw new Error("Not implemented")}isOpen(){throw new Error("Not implemented")}getProtocolVersion(){throw new Error("Not implemented")}hasOngoingObservableRequests(){throw new Error("Not implemented")}}class Jr{_connectionHolder;_reactive;_state;_onClose;_onBookmarks;_onConnection;_onError;_onComplete;_fetchSize;_results;_impersonatedUser;_lowRecordWatermak;_highRecordWatermark;_bookmarks;_activePromise;_acceptActive;_notificationFilter;_apiTelemetryConfig;constructor({connectionHolder:e,onClose:t,onBookmarks:r,onConnection:n,reactive:o,fetchSize:i,impersonatedUser:s,highRecordWatermark:a,lowRecordWatermark:u,notificationFilter:l,apiTelemetryConfig:h}){this._connectionHolder=e,this._reactive=o,this._state=y.ACTIVE,this._onClose=t,this._onBookmarks=r,this._onConnection=n,this._onError=this._onErrorCallback.bind(this),this._fetchSize=i,this._onComplete=this._onCompleteCallback.bind(this),this._results=[],this._impersonatedUser=s,this._lowRecordWatermak=u,this._highRecordWatermark=a,this._bookmarks=m.empty(),this._notificationFilter=l,this._apiTelemetryConfig=h,this._acceptActive=()=>{},this._activePromise=new Promise((e,t)=>{this._acceptActive=e})}_begin(t,r,n){this._connectionHolder.getConnection().then(async e=>{if(this._onConnection(),null!=e)return this._bookmarks=await t(),e.beginTransaction({bookmarks:this._bookmarks,txConfig:r,mode:this._connectionHolder.mode(),database:this._connectionHolder.database(),impersonatedUser:this._impersonatedUser,notificationFilter:this._notificationFilter,apiTelemetryConfig:this._apiTelemetryConfig,beforeError:e=>{null!=n&&n.onError(e),this._onError(e).catch(()=>{})},afterComplete:e=>{null!=n&&n.onComplete(e),this._onComplete(e)}});throw b("No connection available")}).catch(e=>{null!=n&&n.onError(e),this._onError(e).catch(()=>{})}).finally(()=>this._acceptActive())}run(e,t){var{validatedQuery:e,params:t}=le(e,t),e=this._state.run(e,t,{connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,reactive:this._reactive,fetchSize:this._fetchSize,highRecordWatermark:this._highRecordWatermark,lowRecordWatermark:this._lowRecordWatermak,preparationJob:this._activePromise});return this._results.push(e),e}commit(){const r=this._state.commit({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:e=>this._onCompleteCallback(e,this._bookmarks),onConnection:this._onConnection,pendingResults:this._results,preparationJob:this._activePromise});return this._state=r.state,this._onClose(),new Promise((e,t)=>{r.result.subscribe({onCompleted:()=>e(),onError:e=>t(e)})})}rollback(){const r=this._state.rollback({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,pendingResults:this._results,preparationJob:this._activePromise});return this._state=r.state,this._onClose(),new Promise((e,t)=>{r.result.subscribe({onCompleted:()=>e(),onError:e=>t(e)})})}isOpen(){return this._state===y.ACTIVE}async close(){this.isOpen()&&await this.rollback()}[Symbol.asyncDispose](){return this.close()}_onErrorCallback(t){return this._state=y.FAILED,this._onClose(),this._results.forEach(e=>{e.isOpen()&&e._streamObserverPromise.then(e=>e.onError(t)).catch(e=>{})}),this._connectionHolder.releaseConnection()}_onCompleteCallback(e,t){this._onBookmarks(new m(e?.bookmark),t??m.empty(),e?.db)}}const y={ACTIVE:{commit:({connectionHolder:e,onError:t,onComplete:r,onConnection:n,pendingResults:o,preparationJob:i})=>({result:en(!0,e,t,r,n,o,i),state:y.SUCCEEDED}),rollback:({connectionHolder:e,onError:t,onComplete:r,onConnection:n,pendingResults:o,preparationJob:i})=>({result:en(!1,e,t,r,n,o,i),state:y.ROLLED_BACK}),run:(t,r,{connectionHolder:e,onError:n,onComplete:o,onConnection:i,reactive:s,fetchSize:a,highRecordWatermark:u,lowRecordWatermark:l,preparationJob:h})=>{const c=h??Promise.resolve();return v(e.getConnection().then(e=>c.then(()=>e)).then(e=>{if(i(),null!=e)return e.run(t,r,{bookmarks:m.empty(),txConfig:g.empty(),beforeError:n,afterComplete:o,reactive:s,fetchSize:a,highRecordWatermark:u,lowRecordWatermark:l});throw b("No connection available")}).catch(e=>new _({error:e,onError:n})),t,r,e,u,l)}},FAILED:{commit:({connectionHolder:e,onError:t})=>({result:v(new _({error:b("Cannot commit this transaction, because it has been rolled back either because of an error or explicit termination."),onError:t}),"COMMIT",{},e,0,0),state:y.FAILED}),rollback:({connectionHolder:e})=>({result:v(new or,"ROLLBACK",{},e,0,0),state:y.FAILED}),run:(e,t,{connectionHolder:r,onError:n})=>v(new _({error:b("Cannot run query in this transaction, because it has been rolled back either because of an error or explicit termination."),onError:n}),e,t,r,0,0)},SUCCEEDED:{commit:({connectionHolder:e,onError:t})=>({result:v(new _({error:b("Cannot commit this transaction, because it has already been committed."),onError:t}),"COMMIT",{},Cr,0,0),state:y.SUCCEEDED,connectionHolder:e}),rollback:({connectionHolder:e,onError:t})=>({result:v(new _({error:b("Cannot rollback this transaction, because it has already been committed."),onError:t}),"ROLLBACK",{},Cr,0,0),state:y.SUCCEEDED,connectionHolder:e}),run:(e,t,{connectionHolder:r,onError:n})=>v(new _({error:b("Cannot run query in this transaction, because it has already been committed."),onError:n}),e,t,r,0,0)},ROLLED_BACK:{commit:({connectionHolder:e,onError:t})=>({result:v(new _({error:b("Cannot commit this transaction, because it has already been rolled back."),onError:t}),"COMMIT",{},e,0,0),state:y.ROLLED_BACK}),rollback:({connectionHolder:e})=>({result:v(new _({error:b("Cannot rollback this transaction, because it has already been rolled back.")}),"ROLLBACK",{},e,0,0),state:y.ROLLED_BACK}),run:(e,t,{connectionHolder:r,onError:n})=>v(new _({error:b("Cannot run query in this transaction, because it has already been rolled back."),onError:n}),e,t,r,0,0)}};function en(r,e,n,o,i,s,t){const a=t??Promise.resolve();t=e.getConnection().then(e=>a.then(()=>e)).then(t=>(i(),s.forEach(e=>e._cancel()),Promise.all(s.map(e=>e.summary())).then(e=>{if(null!=t)return r?t.commitTransaction({beforeError:n,afterComplete:o}):t.rollbackTransaction({beforeError:n,afterComplete:o});throw b("No connection available")}))).catch(e=>new _({error:e,onError:n}));return new Yr(t,r?"COMMIT":"ROLLBACK",{},e,{high:Number.MAX_VALUE,low:Number.MAX_VALUE})}function v(e,t,r,n=Cr,o,i){return new Yr(Promise.resolve(e),t,r,new Tr(n??Cr),{low:i,high:o})}class tn{_run;constructor({run:e}){this._run=e}static fromTransaction(e){return new tn({run:e.run.bind(e)})}run(e,t){return this._run(e,t)}}class rn extends Jr{[Symbol.toStringTag]="TransactionPromise";_beginError;_beginMetadata;_beginPromise;_reject;_resolve;constructor({connectionHolder:e,onClose:t,onBookmarks:r,onConnection:n,reactive:o,fetchSize:i,impersonatedUser:s,highRecordWatermark:a,lowRecordWatermark:u,notificationFilter:l,apiTelemetryConfig:h}){super({connectionHolder:e,onClose:t,onBookmarks:r,onConnection:n,reactive:o,fetchSize:i,impersonatedUser:s,highRecordWatermark:a,lowRecordWatermark:u,notificationFilter:l,apiTelemetryConfig:h})}then(e,t){return this._getOrCreateBeginPromise().then(e,t)}catch(e){return this._getOrCreateBeginPromise().catch(e)}finally(e){return this._getOrCreateBeginPromise().finally(e)}_getOrCreateBeginPromise(){return null==this._beginPromise&&(this._beginPromise=new Promise((e,t)=>{this._resolve=e,this._reject=t,null!=this._beginError&&t(this._beginError),null!=this._beginMetadata&&e(this._toTransaction())})),this._beginPromise}_toTransaction(){return{...this,run:super.run.bind(this),commit:super.commit.bind(this),rollback:super.rollback.bind(this),close:super.close.bind(this),isOpen:super.isOpen.bind(this),_begin:this._begin.bind(this)}}_begin(e,t){return super._begin(e,t,{onError:this._onBeginError.bind(this),onComplete:this._onBeginMetadata.bind(this)})}_onBeginError(e){this._beginError=e,null!=this._reject&&this._reject(e)}_onBeginMetadata(e){this._beginMetadata=e??{},null!=this._resolve&&this._resolve(this._toTransaction())}}class nn{_mode;_database;_reactive;_fetchSize;_readConnectionHolder;_writeConnectionHolder;_open;_hasTx;_lastBookmarks;_configuredBookmarks;_transactionExecutor;_impersonatedUser;_databaseNameResolved;_lowRecordWatermark;_highRecordWatermark;_results;_bookmarkManager;_notificationFilter;_log;constructor({mode:e,connectionProvider:t,bookmarks:r,database:n,config:o,reactive:i,fetchSize:s,impersonatedUser:a,bookmarkManager:u,notificationFilter:l,auth:h,log:c}){this._mode=e,this._database=n,this._reactive=i,this._fetchSize=s,this._onDatabaseNameResolved=this._onDatabaseNameResolved.bind(this),this._getConnectionAcquistionBookmarks=this._getConnectionAcquistionBookmarks.bind(this),this._readConnectionHolder=new Er({mode:cr,auth:h,database:n,bookmarks:r,connectionProvider:t,impersonatedUser:a,onDatabaseNameResolved:this._onDatabaseNameResolved,getConnectionAcquistionBookmarks:this._getConnectionAcquistionBookmarks,log:c}),this._writeConnectionHolder=new Er({mode:p,auth:h,database:n,bookmarks:r,connectionProvider:t,impersonatedUser:a,onDatabaseNameResolved:this._onDatabaseNameResolved,getConnectionAcquistionBookmarks:this._getConnectionAcquistionBookmarks,log:c}),this._open=!0,this._hasTx=!1,this._impersonatedUser=a,this._lastBookmarks=r??m.empty(),this._configuredBookmarks=this._lastBookmarks,this._transactionExecutor=function(e){e=e?.maxTransactionRetryTime??null;return new Rr(e)}(o),this._databaseNameResolved=""!==this._database;e=this._calculateWatermaks();this._lowRecordWatermark=e.low,this._highRecordWatermark=e.high,this._results=[],this._bookmarkManager=u,this._notificationFilter=l,this._log=c}run(e,t,r){const{validatedQuery:n,params:o}=le(e,t),i=null!=r?new g(r,this._log):g.empty();e=this._run(n,o,async e=>{const t=await this._bookmarks();return this._assertSessionIsOpen(),e.run(n,o,{bookmarks:t,txConfig:i,mode:this._mode,database:this._database,apiTelemetryConfig:{api:dr.AUTO_COMMIT_TRANSACTION},impersonatedUser:this._impersonatedUser,afterComplete:e=>this._onCompleteCallback(e,t),reactive:this._reactive,fetchSize:this._fetchSize,lowRecordWatermark:this._lowRecordWatermark,highRecordWatermark:this._highRecordWatermark,notificationFilter:this._notificationFilter})});return this._results.push(e),e}_run(e,t,r){var{connectionHolder:r,resultPromise:n}=this._acquireAndConsumeConnection(r),n=n.catch(e=>Promise.resolve(new _({error:e}))),o={high:this._highRecordWatermark,low:this._lowRecordWatermark};return new Yr(n,e,t,r,o)}_acquireConnection(e){const{connectionHolder:t,resultPromise:r}=this._acquireAndConsumeConnection(e);return r.then(async e=>(await t.releaseConnection(),e))}_acquireAndConsumeConnection(t){let e;var r=this._connectionHolderWithMode(this._mode);return e=this._open?!this._hasTx&&r.initializeConnection()?r.getConnection().then(e=>t(e)):Promise.reject(b("Queries cannot be run directly on a session with an open transaction; either run from within the transaction or use a different session.")):Promise.reject(b("Cannot run query in a closed session.")),{connectionHolder:r,resultPromise:e}}beginTransaction(e){let t=g.empty();return null!=e&&(t=new g(e,this._log)),this._beginTransaction(this._mode,t,{api:dr.UNMANAGED_TRANSACTION})}_beginTransaction(e,t,r){if(!this._open)throw b("Cannot begin a transaction on a closed session.");if(this._hasTx)throw b("You cannot begin a transaction on a session with an open transaction; either run from within the transaction or use a different session.");e=nn._validateSessionMode(e),e=this._connectionHolderWithMode(e),e.initializeConnection(),this._hasTx=!0,e=new rn({connectionHolder:e,impersonatedUser:this._impersonatedUser,onClose:this._transactionClosed.bind(this),onBookmarks:(e,t,r)=>this._updateBookmarks(e,t,r),onConnection:this._assertSessionIsOpen.bind(this),reactive:this._reactive,fetchSize:this._fetchSize,lowRecordWatermark:this._lowRecordWatermark,highRecordWatermark:this._highRecordWatermark,notificationFilter:this._notificationFilter,apiTelemetryConfig:r});return e._begin(()=>this._bookmarks(),t),e}_assertSessionIsOpen(){if(!this._open)throw b("You cannot run more transactions on a closed session.")}_transactionClosed(){this._hasTx=!1}lastBookmark(){return this.lastBookmarks()}lastBookmarks(){return this._lastBookmarks.values()}async _bookmarks(){var e=await this._bookmarkManager?.getBookmarks();return void 0===e?this._lastBookmarks:new m([...e,...this._configuredBookmarks])}readTransaction(e,t){t=new g(t,this._log);return this._runTransaction(cr,t,e)}writeTransaction(e,t){t=new g(t,this._log);return this._runTransaction(p,t,e)}_runTransaction(t,r,e){return this._transactionExecutor.execute(e=>this._beginTransaction(t,r,e),e)}executeRead(e,t){t=new g(t,this._log);return this._executeInTransaction(cr,t,e)}executeWrite(e,t){t=new g(t,this._log);return this._executeInTransaction(p,t,e)}_executeInTransaction(t,r,e){return this._transactionExecutor.execute(e=>this._beginTransaction(t,r,e),e,tn.fromTransaction)}_onDatabaseNameResolved(e){this._databaseNameResolved||(this._database=e=e??"",this._readConnectionHolder.setDatabase(e),this._writeConnectionHolder.setDatabase(e),this._databaseNameResolved=!0)}async _getConnectionAcquistionBookmarks(){var e=await this._bookmarkManager?.getBookmarks();return void 0===e?this._lastBookmarks:new m([...this._configuredBookmarks,...e])}_updateBookmarks(e,t,r){null==e||e.isEmpty()||(this._bookmarkManager?.updateBookmarks(t?.values()??[],e?.values()??[]).catch(()=>{}),this._lastBookmarks=e,this._configuredBookmarks=m.empty())}async close(){this._open&&(this._open=!1,this._results.forEach(e=>e._cancel()),this._transactionExecutor.close(),await this._readConnectionHolder.close(this._hasTx),await this._writeConnectionHolder.close(this._hasTx))}[Symbol.asyncDispose](){return this.close()}_connectionHolderWithMode(e){if(e===cr)return this._readConnectionHolder;if(e===p)return this._writeConnectionHolder;throw b("Unknown access mode: "+e)}_onCompleteCallback(e,t){this._updateBookmarks(new m(e.bookmark),t,e.db)}_calculateWatermaks(){return this._fetchSize===lr?{low:Number.MAX_VALUE,high:Number.MAX_VALUE}:{low:.3*this._fetchSize,high:.7*this._fetchSize}}_configureTransactionExecutor(e,t){this._transactionExecutor.pipelineBegin=e,this._transactionExecutor.telemetryApi=t}static _validateSessionMode(e){e=e??p;if(e!==cr&&e!==p)throw b("Illegal session mode "+e);return e}}function on(e={}){var t=new Set(e.initialBookmarks);return new sn(t,e.bookmarksSupplier,e.bookmarksConsumer)}class sn{_bookmarks;_bookmarksSupplier;_bookmarksConsumer;constructor(e,t,r){this._bookmarks=e,this._bookmarksSupplier=t,this._bookmarksConsumer=r}async updateBookmarks(e,t){var r=this._bookmarks;for(const n of e)r.delete(n);for(const o of t)r.add(o);"function"==typeof this._bookmarksConsumer&&await this._bookmarksConsumer([...r])}async getBookmarks(){var e=new Set(this._bookmarks);if("function"==typeof this._bookmarksSupplier)for(const t of await this._bookmarksSupplier()??[])e.add(t);return[...e]}}async function an(e){var{summary:t,records:r}=await e,e=await e.keys();return new Zr(e,r,t)}const un=new class{eagerResultTransformer(){return an}mappedResultTransformer(o){if(null==o||null==o.collect&&null==o.map)throw b("Requires a map or/and a collect functions.");return async e=>new Promise((t,r)=>{const n={records:[],keys:[]};e.subscribe({onKeys(e){n.keys=e},onNext(e){var t;null!=o.map?void 0!==(t=o.map(e))&&n.records.push(t):n.records.push(e)},onCompleted(e){null!=o.collect?t(o.collect(n.records,e,n.keys)):(e={records:n.records,summary:e,keys:n.keys},t(e))},onError(e){r(e)}})})}};Object.freeze(un);class ln{_createSession;constructor(e){this._createSession=e}async execute(t,r,n){var e=this._createSession({database:t.database,bookmarkManager:t.bookmarkManager,impersonatedUser:t.impersonatedUser});e._configureTransactionExecutor(!0,dr.EXECUTE_QUERY);try{return await("READ"===t.routing?e.executeRead:e.executeWrite).bind(e)(async e=>{e=e.run(r,n);return t.resultTransformer(e)},t.transactionConfig)}finally{await e.close()}}}const hn=cr,cn=p;let dn=0;const fn={WRITE:"WRITE",READ:"READ"};Object.freeze(fn);class _n{_id;_meta;_config;_log;_createConnectionProvider;_connectionProvider;_createSession;_defaultExecuteQueryBookmarkManager;_queryExecutor;constructor(e,t={},r,n=e=>new nn(e),o=e=>new ln(e)){(i=t).maxConnectionLifetime=mn(i.maxConnectionLifetime,36e5),i.maxConnectionPoolSize=mn(i.maxConnectionPoolSize,100),i.connectionAcquisitionTimeout=mn(i.connectionAcquisitionTimeout,6e4),i.fetchSize=pn(i.fetchSize,1e3),i.connectionTimeout=function(e){e=parseInt(e.connectionTimeout,10);return 0===e||!isNaN(e)&&e<0?null:isNaN(e)?hr:e}(i),i.connectionLivenessCheckTimeout=function(e){if(null==e)return;e=parseInt(e,10);if(e<0||Number.isNaN(e))throw new Error("The connectionLivenessCheckTimeout can only be a positive value or 0 for always. However connectionLivenessCheckTimeout = "+e);return e}(i.connectionLivenessCheckTimeout);var i=br.create(t),s=t,a=i,u=s.resolver;if(null!=u&&"function"!=typeof u)throw new TypeError("Configured resolver should be a function. Got: "+typeof u);s.connectionAcquisitionTimeout<s.connectionTimeout&&a.warn('Configuration for "connectionAcquisitionTimeout" should be greater than or equal to "connectionTimeout". Otherwise, the connection acquisition timeout will take precedence for over the connection timeout in scenarios where a new connection is created while it is acquired'),this._id=dn++,this._meta=e,this._config=t,this._log=i,this._createConnectionProvider=r,this._createSession=n,this._defaultExecuteQueryBookmarkManager=on(),this._queryExecutor=o(this.session.bind(this)),this._connectionProvider=null,this._afterConstruction()}get executeQueryBookmarkManager(){return this._defaultExecuteQueryBookmarkManager}async executeQuery(e,t,r={}){var n=null===r.bookmarkManager?void 0:r.bookmarkManager??this.executeQueryBookmarkManager,o=r.resultTransformer??un.eagerResultTransformer(),i=r.routing??fn.WRITE;if(i!==fn.READ&&i!==fn.WRITE)throw b(`Illegal query routing config: "${i}"`);return this._queryExecutor.execute({resultTransformer:o,bookmarkManager:n,routing:i,database:r.database,impersonatedUser:r.impersonatedUser,transactionConfig:r.transactionConfig},e,t)}verifyConnectivity({database:e=""}={}){return this._getOrCreateConnectionProvider().verifyConnectivityAndGetServerInfo({database:e,accessMode:hn})}async verifyAuthentication({database:e,auth:t}={}){return this._getOrCreateConnectionProvider().verifyAuthentication({database:e??"system",auth:t,accessMode:hn})}getServerInfo({database:e=""}={}){return this._getOrCreateConnectionProvider().verifyConnectivityAndGetServerInfo({database:e,accessMode:hn})}supportsMultiDb(){return this._getOrCreateConnectionProvider().supportsMultiDb()}supportsTransactionConfig(){return this._getOrCreateConnectionProvider().supportsTransactionConfig()}supportsUserImpersonation(){return this._getOrCreateConnectionProvider().supportsUserImpersonation()}supportsSessionAuth(){return this._getOrCreateConnectionProvider().supportsSessionAuth()}getNegotiatedProtocolVersion(){return this._getOrCreateConnectionProvider().getNegotiatedProtocolVersion()}isEncrypted(){return this._isEncrypted()}_supportsRouting(){return this._meta.routing}_isEncrypted(){return this._config.encrypted===ae||!0===this._config.encrypted}_getTrust(){return this._config.trust}session({defaultAccessMode:e=cn,bookmarks:t,database:r="",impersonatedUser:n,fetchSize:o,bookmarkManager:i,notificationFilter:s,auth:a}={}){return this._newSession({defaultAccessMode:e,bookmarkOrBookmarks:t,database:r,reactive:!1,impersonatedUser:n,fetchSize:pn(o,this._config.fetchSize),bookmarkManager:i,notificationFilter:s,auth:a})}close(){return this._log.info(`Driver ${this._id} closing`),null!=this._connectionProvider?this._connectionProvider.close():Promise.resolve()}[Symbol.asyncDispose](){return this.close()}_afterConstruction(){this._log.info(`${this._meta.typename} driver ${this._id} created for server address `+this._meta.address.toString())}_newSession({defaultAccessMode:e,bookmarkOrBookmarks:t,database:r,reactive:n,impersonatedUser:o,fetchSize:i,bookmarkManager:s,notificationFilter:a,auth:u}){var e=nn._validateSessionMode(e),l=this._getOrCreateConnectionProvider(),t=null!=t?new m(t):m.empty();return this._createSession({mode:e,database:r??"",connectionProvider:l,bookmarks:t,config:this._config,reactive:n,impersonatedUser:o,fetchSize:i,bookmarkManager:s,notificationFilter:a,auth:u,log:this._log})}_getOrCreateConnectionProvider(){var e;return null==this._connectionProvider&&(this._connectionProvider=this._createConnectionProvider(this._id,this._config,this._log,(e=this._config,new Hr(e.resolver)))),this._connectionProvider}}function mn(e,t){e=parseInt(e,10);return 0<e||0===e?e:e<0?Number.MAX_SAFE_INTEGER:t}function pn(e,t){e=parseInt(e,10);if(0<e||e===lr)return e;if(0===e||e<0)throw new Error(`The fetch size can only be a positive value or ${lr} for ALL. However fetchSize = `+e);return t}r=Object.freeze({__proto__:null,Driver:_n,READ:hn,WRITE:cn,routing:fn,SessionConfig:class{defaultAccessMode;bookmarks;database;impersonatedUser;fetchSize;bookmarkManager;notificationFilter;auth;constructor(){this.defaultAccessMode=cn,this.bookmarks=[],this.database="",this.impersonatedUser=void 0,this.auth=void 0,this.fetchSize=void 0,this.bookmarkManager=void 0,this.notificationFilter=void 0}},QueryConfig:class{routing;database;impersonatedUser;bookmarkManager;resultTransformer;transactionConfig;constructor(){this.routing=fn.WRITE,this.resultTransformer=void 0,this.database="",this.impersonatedUser=void 0,this.bookmarkManager=void 0,this.transactionConfig=void 0}},default:_n}),sr={basic:(e,t,r)=>null!=r?{scheme:"basic",principal:e,credentials:t,realm:r}:{scheme:"basic",principal:e,credentials:t},kerberos:e=>({scheme:"kerberos",principal:"",credentials:e}),bearer:e=>({scheme:"bearer",credentials:e}),none:()=>({scheme:"none"}),custom:(e,t,r,n,o)=>{n={scheme:n,principal:e};return gn(t)&&(n.credentials=t),gn(r)&&(n.realm=r),gn(o)&&(n.parameters=o),n}};function gn(e){return null!=e&&""!==e&&(Object.getPrototypeOf(e)!==Object.prototype||0!==Object.keys(e).length)}ur=new class{bearer({tokenProvider:e}){if("function"!=typeof e)throw new TypeError("tokenProvider should be function, but got: "+typeof e);return new vn(e,["Neo.ClientError.Security.Unauthorized","Neo.ClientError.Security.TokenExpired"])}basic({tokenProvider:e}){if("function"!=typeof e)throw new TypeError("tokenProvider should be function, but got: "+typeof e);return new vn(async()=>({token:await e()}),["Neo.ClientError.Security.Unauthorized"])}};function bn({authToken:e}){return new wn(e)}Object.freeze(ur);class yn{_subscribers;constructor(e=[]){this._subscribers=e}subscribe(e){this._subscribers.push(e)}onCompleted(t){this._subscribers.forEach(e=>e.onCompleted(t))}onError(t){this._subscribers.forEach(e=>e.onError(t))}}class vn{_tokenProvider;_handledSecurityCodes;_currentAuthData;_refreshObservable;constructor(e,t,r,n){this._tokenProvider=e,this._handledSecurityCodes=t,this._currentAuthData=r,this._refreshObservable=n}async getToken(){return(void 0===this._currentAuthData||void 0!==this._currentAuthData.expiration&&this._currentAuthData.expiration<new Date)&&await this._refreshAuthToken(),this._currentAuthData?.token}handleSecurityException(e,t){return!!this._handledSecurityCodes.includes(t)&&(me(e,this._currentAuthData?.token)&&this._scheduleRefreshAuthToken(),!0)}_scheduleRefreshAuthToken(e){void 0===this._refreshObservable&&(this._currentAuthData=void 0,this._refreshObservable=new yn,Promise.resolve(this._tokenProvider()).then(e=>{this._currentAuthData=e,this._refreshObservable?.onCompleted(e)}).catch(e=>{this._refreshObservable?.onError(e)}).finally(()=>{this._refreshObservable=void 0})),void 0!==e&&this._refreshObservable.subscribe(e)}async _refreshAuthToken(){return new Promise((e,t)=>{this._scheduleRefreshAuthToken({onCompleted:e,onError:t})})}}class wn{_authToken;constructor(e){this._authToken=e}getToken(){return this._authToken}handleSecurityException(e,t){return!1}}class En{encrypted;trust;trustedCertificates;knownHosts;fetchSize;maxConnectionPoolSize;maxTransactionRetryTime;maxConnectionLifetime;connectionAcquisitionTimeout;connectionLivenessCheckTimeout;connectionTimeout;disableLosslessIntegers;notificationFilter;useBigInt;logging;resolver;userAgent;telemetryDisabled;constructor(){this.encrypted=void 0,this.trust=void 0,this.trustedCertificates=[],this.maxConnectionPoolSize=100,this.maxConnectionLifetime=36e5,this.connectionAcquisitionTimeout=6e4,this.maxTransactionRetryTime=3e4,this.connectionLivenessCheckTimeout=void 0,this.connectionTimeout=3e4,this.disableLosslessIntegers=!1,this.useBigInt=!1,this.logging=void 0,this.resolver=void 0,this.notificationFilter=void 0,this.userAgent=void 0,this.telemetryDisabled=!1}}i=Object.freeze({__proto__:null,Config:En,InternalConfig:class extends En{boltAgent}}),s={SERVICE_UNAVAILABLE:z,SESSION_EXPIRED:H,PROTOCOL_ERROR:W},Pr={authTokenManagers:ur,newError:b,Neo4jError:$,isRetriableError:K,error:s,Integer:d,int:c,isInt:Q,inSafeRange:e,toNumber:J,toString:ee,internal:t,isPoint:zt,Point:jt,Date:dt,DateTime:pt,Duration:st,isDate:ft,isDateTime:gt,isDuration:at,isLocalDateTime:mt,isLocalTime:lt,isTime:ct,LocalDateTime:_t,LocalTime:ut,Time:ht,Node:kt,isNode:Rt,Relationship:St,isRelationship:Pt,UnboundRelationship:Nt,isUnboundRelationship:At,Path:Dt,isPath:Bt,PathSegment:Ut,isPathSegment:Lt,Record:Mt,ResultSummary:Ht,queryType:n,ServerInfo:Jt,Notification:Qt,Plan:Wt,ProfiledPlan:Vt,QueryStatistics:Kt,Stats:$t,Result:Yr,EagerResult:Zr,Transaction:Jr,ManagedTransaction:tn,TransactionPromise:rn,Session:nn,Driver:_n,Connection:Qr,types:i,driver:r,json:se,auth:sr,bookmarkManager:on,routing:fn,resultTransformers:un,notificationCategory:Zt,notificationSeverityLevel:Gt,notificationFilterDisabledCategory:nr,notificationFilterMinimumSeverityLevel:rr},wr=M(Object.freeze({__proto__:null,authTokenManagers:ur,newError:b,Neo4jError:$,isRetriableError:K,error:s,Integer:d,int:c,isInt:Q,inSafeRange:e,toNumber:J,toString:ee,internal:t,isPoint:zt,Point:jt,Date:dt,DateTime:pt,Duration:st,isDate:ft,isDateTime:gt,isDuration:at,isLocalDateTime:mt,isLocalTime:lt,isTime:ct,LocalDateTime:_t,LocalTime:ut,Time:ht,Node:kt,isNode:Rt,Relationship:St,isRelationship:Pt,UnboundRelationship:Nt,isUnboundRelationship:At,Path:Dt,isPath:Bt,PathSegment:Ut,isPathSegment:Lt,Record:Mt,ResultSummary:Ht,queryType:n,ServerInfo:Jt,Notification:Qt,Plan:Wt,ProfiledPlan:Vt,QueryStatistics:Kt,Stats:$t,Result:Yr,EagerResult:Zr,ConnectionProvider:Xr,Connection:Qr,Transaction:Jr,ManagedTransaction:tn,TransactionPromise:rn,Session:nn,Driver:_n,types:i,driver:r,json:se,auth:sr,bookmarkManager:on,staticAuthTokenManager:bn,routing:fn,resultTransformers:un,notificationCategory:Zt,notificationSeverityLevel:Gt,notificationFilterDisabledCategory:nr,notificationFilterMinimumSeverityLevel:rr,default:Pr}));class Tn{selectReader(e){throw new Error("Abstract function")}selectWriter(e){throw new Error("Abstract function")}}class Cn{constructor(e){this._offset=e||0}next(e){var t;return 0===e?-1:(t=this._offset,this._offset+=1,this._offset===Number.MAX_SAFE_INTEGER&&(this._offset=0),t%e)}}class On extends Tn{constructor(e){super(),this._readersIndex=new Cn,this._writersIndex=new Cn,this._connectionPool=e}selectReader(e){return this._select(e,this._readersIndex)}selectWriter(e){return this._select(e,this._writersIndex)}_select(e,t){var r=e.length;if(0===r)return null;var n=t.next(r);let o=n,i=null,s=Number.MAX_SAFE_INTEGER;do{var a=e[o],u=this._connectionPool.activeResourceCount(a);u<s&&(i=a,s=u),o===r-1?o=0:o++}while(o!==n);return i}}var Fr=Object.freeze({__proto__:null,default:On,LoadBalancingStrategy:Tn,LeastConnectedLoadBalancingStrategy:On}),a={},qr={byteLength:function(e){var e=Pn(e),t=e[0],e=e[1];return 3*(t+e)/4-e}};qr.toByteArray=function(e){var t,r,n=Pn(e),o=n[0],n=n[1],i=new In(function(e,t){return 3*(e+t)/4-t}(o,n)),s=0,a=0<n?o-4:o;for(r=0;r<a;r+=4)t=h[e.charCodeAt(r)]<<18|h[e.charCodeAt(r+1)]<<12|h[e.charCodeAt(r+2)]<<6|h[e.charCodeAt(r+3)],i[s++]=t>>16&255,i[s++]=t>>8&255,i[s++]=255&t;2===n&&(t=h[e.charCodeAt(r)]<<2|h[e.charCodeAt(r+1)]>>4,i[s++]=255&t);1===n&&(t=h[e.charCodeAt(r)]<<10|h[e.charCodeAt(r+1)]<<4|h[e.charCodeAt(r+2)]>>2,i[s++]=t>>8&255,i[s++]=255&t);return i},qr.fromByteArray=function(e){for(var t,r=e.length,n=r%3,o=[],i=0,s=r-n;i<s;i+=16383)o.push(function(e,t,r){for(var n,o=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(function(e){return u[e>>18&63]+u[e>>12&63]+u[e>>6&63]+u[63&e]}(n));return o.join("")}(e,i,s<i+16383?s:i+16383));1==n?(t=e[r-1],o.push(u[t>>2]+u[t<<4&63]+"==")):2==n&&(t=(e[r-2]<<8)+e[r-1],o.push(u[t>>10]+u[t>>4&63]+u[t<<2&63]+"="));return o.join("")};for(var u=[],h=[],In="undefined"!=typeof Uint8Array?Uint8Array:Array,kn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Rn=0,Sn=kn.length;Rn<Sn;++Rn)u[Rn]=kn[Rn],h[kn.charCodeAt(Rn)]=Rn;function Pn(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("="),t=(e=-1===e?t:e)===t?0:4-e%4;return[e,t]}h["-".charCodeAt(0)]=62,h["_".charCodeAt(0)]=63;Wr={read:function(e,t,r,n,o){var i,s,a=8*o-n-1,u=(1<<a)-1,l=u>>1,h=-7,c=r?o-1:0,d=r?-1:1,o=e[t+c];for(c+=d,i=o&(1<<-h)-1,o>>=-h,h+=a;0<h;i=256*i+e[t+c],c+=d,h-=8);for(s=i&(1<<-h)-1,i>>=-h,h+=n;0<h;s=256*s+e[t+c],c+=d,h-=8);if(0===i)i=1-l;else{if(i===u)return s?NaN:1/0*(o?-1:1);s+=Math.pow(2,n),i-=l}return(o?-1:1)*s*Math.pow(2,i-n)},write:function(e,t,r,n,o,i){var s,a,u=8*i-o-1,l=(1<<u)-1,h=l>>1,c=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:i-1,f=n?1:-1,i=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-s))<1&&(s--,n*=2),2<=(t+=1<=s+h?c/n:c*Math.pow(2,1-h))*n&&(s++,n/=2),l<=s+h?(a=0,s=l):1<=s+h?(a=(t*n-1)*Math.pow(2,o),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,o),s=0));8<=o;e[r+d]=255&a,d+=f,a/=256,o-=8);for(s=s<<o|a,u+=o;0<u;e[r+d]=255&s,d+=f,s/=256,u-=8);e[r+d-f]|=128*i}};{var Nn=a;const uu=qr,lu=Wr,hu=(ie="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null,Nn.Buffer=w,Nn.SlowBuffer=function(e){+e!=e&&(e=0);return w.alloc(+e)},Nn.INSPECT_MAX_BYTES=50,2147483647);function An(e){if(e>hu)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return Object.setPrototypeOf(e,w.prototype),e}function w(e,t,r){if("number"!=typeof e)return Un(e,t,r);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return Dn(e)}function Un(t,r,e){if("string"==typeof t){var n=t;var o=r;"string"==typeof o&&""!==o||(o="utf8");if(!w.isEncoding(o))throw new TypeError("Unknown encoding: "+o);var i=0|Fn(n,o);let e=An(i);n=e.write(n,o);n!==i&&(e=e.slice(0,n));return e}if(ArrayBuffer.isView(t))return C(o=t,Uint8Array)?xn((i=new Uint8Array(o)).buffer,i.byteOffset,i.byteLength):Bn(o);if(null!=t){if(C(t,ArrayBuffer)||t&&C(t.buffer,ArrayBuffer))return xn(t,r,e);if("undefined"!=typeof SharedArrayBuffer&&(C(t,SharedArrayBuffer)||t&&C(t.buffer,SharedArrayBuffer)))return xn(t,r,e);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return w.from(n,r,e);var s=function(e){{var t,r;if(w.isBuffer(e))return t=0|Mn(e.length),0!==(r=An(t)).length&&e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||so(e.length)?An(0):Bn(e);if("Buffer"===e.type&&Array.isArray(e.data))return Bn(e.data)}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return w.from(t[Symbol.toPrimitive]("string"),r,e)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function Ln(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function Dn(e){return Ln(e),An(e<0?0:0|Mn(e))}function Bn(t){var r=t.length<0?0:0|Mn(t.length),n=An(r);for(let e=0;e<r;e+=1)n[e]=255&t[e];return n}function xn(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,w.prototype),n}function Mn(e){if(e>=hu)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+hu.toString(16)+" bytes");return 0|e}function Fn(e,t){if(w.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||C(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=2<arguments.length&&!0===arguments[2];if(!n&&0===r)return 0;let o=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return no(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return oo(e).length;default:if(o)return n?-1:no(e).length;t=(""+t).toLowerCase(),o=!0}}function jn(e,r,n){let t=!1;if((r=void 0===r||r<0?0:r)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(r>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":{var o=this;var i=r;var s=n;var a=o.length;(!i||i<0)&&(i=0);(!s||s<0||a<s)&&(s=a);let t="";for(let e=i;e<s;++e)t+=_u[o[e]];return t;return}case"utf8":case"utf-8":return $n(this,r,n);case"ascii":{var u=this;a=r;var l=n;let t="";l=Math.min(u.length,l);for(let e=a;e<l;++e)t+=String.fromCharCode(127&u[e]);return t;return}case"latin1":case"binary":{var h=this;i=r;var c=n;let t="";c=Math.min(h.length,c);for(let e=i;e<c;++e)t+=String.fromCharCode(h[e]);return t;return}case"base64":return f=this,m=n,0===(_=r)&&m===f.length?uu.fromByteArray(f):uu.fromByteArray(f.slice(_,m));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":{f=this;_=r;m=n;var d=f.slice(_,m);let t="";for(let e=0;e<d.length-1;e+=2)t+=String.fromCharCode(d[e]+256*d[e+1]);return t;return}default:if(t)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),t=!0}var f,_,m}function qn(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function zn(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),(r=(r=so(r=+r)?o?0:e.length-1:r)<0?e.length+r:r)>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=w.from(t,n)),w.isBuffer(t))return 0===t.length?-1:Hn(e,t,r,n,o);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(o?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,r):Hn(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function Hn(r,n,t,e,o){let i=1,s=r.length,a=n.length;if(void 0!==e&&("ucs2"===(e=String(e).toLowerCase())||"ucs-2"===e||"utf16le"===e||"utf-16le"===e)){if(r.length<2||n.length<2)return-1;i=2,s/=2,a/=2,t/=2}function u(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}let l;if(o){let e=-1;for(l=t;l<s;l++)if(u(r,l)===u(n,-1===e?0:l-e)){if(-1===e&&(e=l),l-e+1===a)return e*i}else-1!==e&&(l-=l-e),e=-1}else for(t+a>s&&(t=s-a),l=t;0<=l;l--){let t=!0;for(let e=0;e<a;e++)if(u(r,l+e)!==u(n,e)){t=!1;break}if(t)return l}return-1}function Wn(e,t,r,n){return io(function(t){var r=[];for(let e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}(t),e,r,n)}function Vn(e,t,r,n){return io(function(t,r){var n,o;var i=[];for(let e=0;e<t.length&&!((r-=2)<0);++e)n=t.charCodeAt(e),o=n>>8,i.push(n%256),i.push(o);return i}(t,e.length-r),e,r,n)}function $n(s,e,t){t=Math.min(s.length,t);var r=[];let a=e;for(;a<t;){var u=s[a];let o=null,i=239<u?4:223<u?3:191<u?2:1;if(a+i<=t){let e,t,r,n;switch(i){case 1:u<128&&(o=u);break;case 2:128==(192&(e=s[a+1]))&&127<(n=(31&u)<<6|63&e)&&(o=n);break;case 3:e=s[a+1],t=s[a+2],128==(192&e)&&128==(192&t)&&2047<(n=(15&u)<<12|(63&e)<<6|63&t)&&(n<55296||57343<n)&&(o=n);break;case 4:e=s[a+1],t=s[a+2],r=s[a+3],128==(192&e)&&128==(192&t)&&128==(192&r)&&65535<(n=(15&u)<<18|(63&e)<<12|(63&t)<<6|63&r)&&n<1114112&&(o=n)}}null===o?(o=65533,i=1):65535<o&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),a+=i}{var n=r,o=n.length;if(o<=cu)return String.fromCharCode.apply(String,n);let e="",t=0;for(;t<o;)e+=String.fromCharCode.apply(String,n.slice(t,t+=cu));return e}}Nn.kMaxLength=hu,(w.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(w.prototype,"parent",{enumerable:!0,get:function(){if(w.isBuffer(this))return this.buffer}}),Object.defineProperty(w.prototype,"offset",{enumerable:!0,get:function(){if(w.isBuffer(this))return this.byteOffset}}),w.poolSize=8192,w.from=Un,Object.setPrototypeOf(w.prototype,Uint8Array.prototype),Object.setPrototypeOf(w,Uint8Array),w.alloc=function(e,t,r){return t=t,r=r,Ln(e=e),!(e<=0)&&void 0!==t?"string"==typeof r?An(e).fill(t,r):An(e).fill(t):An(e)},w.allocUnsafe=Dn,w.allocUnsafeSlow=Dn,w.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==w.prototype},w.compare=function(r,n){if(C(r,Uint8Array)&&(r=w.from(r,r.offset,r.byteLength)),C(n,Uint8Array)&&(n=w.from(n,n.offset,n.byteLength)),!w.isBuffer(r)||!w.isBuffer(n))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===n)return 0;let o=r.length,i=n.length;for(let e=0,t=Math.min(o,i);e<t;++e)if(r[e]!==n[e]){o=r[e],i=n[e];break}return o<i?-1:i<o?1:0},w.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},w.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return w.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=w.allocUnsafe(e);let o=0;for(r=0;r<t.length;++r){let e=t[r];if(C(e,Uint8Array))o+e.length>n.length?(e=w.isBuffer(e)?e:w.from(e)).copy(n,o):Uint8Array.prototype.set.call(n,e,o);else{if(!w.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,o)}o+=e.length}return n},w.byteLength=Fn,w.prototype._isBuffer=!0,w.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)qn(this,e,e+1);return this},w.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)qn(this,e,e+3),qn(this,e+1,e+2);return this},w.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)qn(this,e,e+7),qn(this,e+1,e+6),qn(this,e+2,e+5),qn(this,e+3,e+4);return this},w.prototype.toLocaleString=w.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?$n(this,0,e):jn.apply(this,arguments)},w.prototype.equals=function(e){if(w.isBuffer(e))return this===e||0===w.compare(this,e);throw new TypeError("Argument must be a Buffer")},w.prototype.inspect=function(){let e="";var t=Nn.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},ie&&(w.prototype[ie]=w.prototype.inspect),w.prototype.compare=function(e,t,r,n,o){if(C(e,Uint8Array)&&(e=w.from(e,e.offset,e.byteLength)),!w.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),(t=void 0===t?0:t)<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(o<=n&&r<=t)return 0;if(o<=n)return-1;if(r<=t)return 1;if(this===e)return 0;let i=(o>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0);var a=Math.min(i,s),u=this.slice(n,o),l=e.slice(t,r);for(let e=0;e<a;++e)if(u[e]!==l[e]){i=u[e],s=l[e];break}return i<s?-1:s<i?1:0},w.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},w.prototype.indexOf=function(e,t,r){return zn(this,e,t,r,!0)},w.prototype.lastIndexOf=function(e,t,r){return zn(this,e,t,r,!1)},w.prototype.write=function(t,r,n,e){if(void 0===r)e="utf8",n=this.length,r=0;else if(void 0===n&&"string"==typeof r)e=r,n=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r>>>=0,isFinite(n)?(n>>>=0,void 0===e&&(e="utf8")):(e=n,n=void 0)}var o,i,s,a=this.length-r;if((void 0===n||a<n)&&(n=a),0<t.length&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");e=e||"utf8";let u=!1;for(;;)switch(e){case"hex":{var l=this;var h=t;var c=r;var d=n;c=Number(c)||0;var f=l.length-c;(!d||f<(d=Number(d)))&&(d=f),(f=h.length)/2<d&&(d=f/2);let e;for(e=0;e<d;++e){var _=parseInt(h.substr(2*e,2),16);if(so(_))return e;l[c+e]=_}return e;return}case"utf8":case"utf-8":return f=r,s=n,io(no(t,(i=this).length-f),i,f,s);case"ascii":case"latin1":case"binary":return Wn(this,t,r,n);case"base64":return i=this,s=r,o=n,io(oo(t),i,s,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Vn(this,t,r,n);default:if(u)throw new TypeError("Unknown encoding: "+e);e=(""+e).toLowerCase(),u=!0}},w.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const cu=4096;function E(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function T(e,t,r,n,o,i){if(!w.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(o<t||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function Kn(e,t,r,n,o){eo(t,n,o,e,r,7);n=Number(t&BigInt(4294967295)),e[r++]=n,e[r++]=n>>=8,e[r++]=n>>=8,e[r++]=n>>=8,o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,e[r++]=o>>=8,e[r++]=o>>=8,e[r++]=o>>=8,r}function Gn(e,t,r,n,o){eo(t,n,o,e,r,7);n=Number(t&BigInt(4294967295)),e[r+7]=n,e[r+6]=n>>=8,e[r+5]=n>>=8,e[r+4]=n>>=8,o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,e[r+2]=o>>=8,e[r+1]=o>>=8,e[r]=o>>=8,r+8}function Yn(e,t,r,n){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Zn(e,t,r,n,o){return t=+t,r>>>=0,o||Yn(e,0,r,4),lu.write(e,t,r,n,23,4),r+4}function Xn(e,t,r,n,o){return t=+t,r>>>=0,o||Yn(e,0,r,8),lu.write(e,t,r,n,52,8),r+8}w.prototype.slice=function(e,t){var r=this.length,r=((e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e),this.subarray(e,t));return Object.setPrototypeOf(r,w.prototype),r},w.prototype.readUintLE=w.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||E(e,t,this.length);let n=this[e],o=1,i=0;for(;++i<t&&(o*=256);)n+=this[e+i]*o;return n},w.prototype.readUintBE=w.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||E(e,t,this.length);let n=this[e+--t],o=1;for(;0<t&&(o*=256);)n+=this[e+--t]*o;return n},w.prototype.readUint8=w.prototype.readUInt8=function(e,t){return e>>>=0,t||E(e,1,this.length),this[e]},w.prototype.readUint16LE=w.prototype.readUInt16LE=function(e,t){return e>>>=0,t||E(e,2,this.length),this[e]|this[e+1]<<8},w.prototype.readUint16BE=w.prototype.readUInt16BE=function(e,t){return e>>>=0,t||E(e,2,this.length),this[e]<<8|this[e+1]},w.prototype.readUint32LE=w.prototype.readUInt32LE=function(e,t){return e>>>=0,t||E(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},w.prototype.readUint32BE=w.prototype.readUInt32BE=function(e,t){return e>>>=0,t||E(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},w.prototype.readBigUInt64LE=ao(function(e){to(e>>>=0,"offset");var t=this[e],r=this[e+7],t=(void 0!==t&&void 0!==r||ro(e,this.length-8),t+256*this[++e]+65536*this[++e]+this[++e]*2**24),e=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(t)+(BigInt(e)<<BigInt(32))}),w.prototype.readBigUInt64BE=ao(function(e){to(e>>>=0,"offset");var t=this[e],r=this[e+7],t=(void 0!==t&&void 0!==r||ro(e,this.length-8),t*2**24+65536*this[++e]+256*this[++e]+this[++e]),e=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(t)<<BigInt(32))+BigInt(e)}),w.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||E(e,t,this.length);let n=this[e],o=1,i=0;for(;++i<t&&(o*=256);)n+=this[e+i]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*t)),n},w.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||E(e,t,this.length);let n=t,o=1,i=this[e+--n];for(;0<n&&(o*=256);)i+=this[e+--n]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},w.prototype.readInt8=function(e,t){return e>>>=0,t||E(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},w.prototype.readInt16LE=function(e,t){e>>>=0,t||E(e,2,this.length);t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},w.prototype.readInt16BE=function(e,t){e>>>=0,t||E(e,2,this.length);t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},w.prototype.readInt32LE=function(e,t){return e>>>=0,t||E(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},w.prototype.readInt32BE=function(e,t){return e>>>=0,t||E(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},w.prototype.readBigInt64LE=ao(function(e){to(e>>>=0,"offset");var t=this[e],r=this[e+7],r=(void 0!==t&&void 0!==r||ro(e,this.length-8),this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24));return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),w.prototype.readBigInt64BE=ao(function(e){to(e>>>=0,"offset");var t=this[e],r=this[e+7],t=(void 0!==t&&void 0!==r||ro(e,this.length-8),(t<<24)+65536*this[++e]+256*this[++e]+this[++e]);return(BigInt(t)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)}),w.prototype.readFloatLE=function(e,t){return e>>>=0,t||E(e,4,this.length),lu.read(this,e,!0,23,4)},w.prototype.readFloatBE=function(e,t){return e>>>=0,t||E(e,4,this.length),lu.read(this,e,!1,23,4)},w.prototype.readDoubleLE=function(e,t){return e>>>=0,t||E(e,8,this.length),lu.read(this,e,!0,52,8)},w.prototype.readDoubleBE=function(e,t){return e>>>=0,t||E(e,8,this.length),lu.read(this,e,!1,52,8)},w.prototype.writeUintLE=w.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||T(this,e,t,r,Math.pow(2,8*r)-1,0);let o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},w.prototype.writeUintBE=w.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||T(this,e,t,r,Math.pow(2,8*r)-1,0);let o=r-1,i=1;for(this[t+o]=255&e;0<=--o&&(i*=256);)this[t+o]=e/i&255;return t+r},w.prototype.writeUint8=w.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,1,255,0),this[t]=255&e,t+1},w.prototype.writeUint16LE=w.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},w.prototype.writeUint16BE=w.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},w.prototype.writeUint32LE=w.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},w.prototype.writeUint32BE=w.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},w.prototype.writeBigUInt64LE=ao(function(e,t=0){return Kn(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),w.prototype.writeBigUInt64BE=ao(function(e,t=0){return Gn(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),w.prototype.writeIntLE=function(e,t,r,n){e=+e,t>>>=0,n||T(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);let o=0,i=1,s=0;for(this[t]=255&e;++o<r&&(i*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+r},w.prototype.writeIntBE=function(e,t,r,n){e=+e,t>>>=0,n||T(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);let o=r-1,i=1,s=0;for(this[t+o]=255&e;0<=--o&&(i*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+r},w.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},w.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},w.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},w.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},w.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||T(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},w.prototype.writeBigInt64LE=ao(function(e,t=0){return Kn(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),w.prototype.writeBigInt64BE=ao(function(e,t=0){return Gn(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),w.prototype.writeFloatLE=function(e,t,r){return Zn(this,e,t,!0,r)},w.prototype.writeFloatBE=function(e,t,r){return Zn(this,e,t,!1,r)},w.prototype.writeDoubleLE=function(e,t,r){return Xn(this,e,t,!0,r)},w.prototype.writeDoubleBE=function(e,t,r){return Xn(this,e,t,!1,r)},w.prototype.copy=function(e,t,r,n){if(!w.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r=r||0,n||0===n||(n=this.length),t>=e.length&&(t=e.length),(n=0<n&&n<r?r:n)===r)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length);var o=(n=e.length-t<n-r?e.length-t+r:n)-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),o},w.prototype.fill=function(t,r,n,o){if("string"==typeof t){if("string"==typeof r?(o=r,r=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!w.isEncoding(o))throw new TypeError("Unknown encoding: "+o);var e;1===t.length&&(e=t.charCodeAt(0),"utf8"===o&&e<128||"latin1"===o)&&(t=e)}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(!(n<=r)){r>>>=0,n=void 0===n?this.length:n>>>0;let e;if("number"==typeof(t=t||0))for(e=r;e<n;++e)this[e]=t;else{var i=w.isBuffer(t)?t:w.from(t,o),s=i.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(e=0;e<n-r;++e)this[e+r]=i[e%s]}}return this};const du={};function Qn(e,t,r){du[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=this.name+` [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return this.name+` [${e}]: `+this.message}}}function Jn(e){let t="",r=e.length;for(var n="-"===e[0]?1:0;r>=4+n;r-=3)t="_"+e.slice(r-3,r)+t;return""+e.slice(0,r)+t}function eo(t,r,n,e,o,i){if(n<t||t<r){var s="bigint"==typeof r?"n":"";let e;throw e=3<i?0===r||r===BigInt(0)?`>= 0${s} and < 2${s} ** `+8*(i+1)+s:`>= -(2${s} ** ${8*(i+1)-1}${s}) and < 2 ** `+(8*(i+1)-1)+s:`>= ${r}${s} and <= `+n+s,new du.ERR_OUT_OF_RANGE("value",e,t)}r=e,n=i,to(s=o,"offset"),void 0!==r[s]&&void 0!==r[s+n]||ro(s,r.length-(n+1))}function to(e,t){if("number"!=typeof e)throw new du.ERR_INVALID_ARG_TYPE(t,"number",e)}function ro(e,t,r){if(Math.floor(e)!==e)throw to(e,r),new du.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new du.ERR_BUFFER_OUT_OF_BOUNDS;throw new du.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= `+t,e)}Qn("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?e+" is outside of buffer bounds":"Attempt to access memory outside buffer bounds"},RangeError),Qn("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type `+typeof t},TypeError),Qn("ERR_OUT_OF_RANGE",function(e,t,r){e=`The value of "${e}" is out of range.`;let n=r;return Number.isInteger(r)&&Math.abs(r)>2**32?n=Jn(String(r)):"bigint"==typeof r&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=Jn(n)),n+="n"),e+=` It must be ${t}. Received `+n},RangeError);const fu=/[^+/0-9A-Za-z-_]/g;function no(t,r){r=r||1/0;let n;var o=t.length;let i=null;var s=[];for(let e=0;e<o;++e){if(55295<(n=t.charCodeAt(e))&&n<57344){if(!i){if(56319<n){-1<(r-=3)&&s.push(239,191,189);continue}if(e+1===o){-1<(r-=3)&&s.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(r-=3)&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(r-=3)&&s.push(239,191,189);if(i=null,n<128){if(--r<0)break;s.push(n)}else if(n<2048){if((r-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((r-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function oo(e){return uu.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(fu,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function io(e,t,r,n){let o;for(o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function C(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function so(e){return e!=e}const _u=function(){var r="0123456789abcdef",n=new Array(256);for(let t=0;t<16;++t){var o=16*t;for(let e=0;e<16;++e)n[o+e]=r[t]+r[e]}return n}();function ao(e){return"undefined"==typeof BigInt?uo:e}function uo(){throw new Error("BigInt not supported")}}class lo{constructor(e){this.position=0,this.length=e}getUInt8(e){throw new Error("Not implemented")}getInt8(e){throw new Error("Not implemented")}getFloat64(e){throw new Error("Not implemented")}putUInt8(e,t){throw new Error("Not implemented")}putInt8(e,t){throw new Error("Not implemented")}putFloat64(e,t){throw new Error("Not implemented")}getInt16(e){return this.getInt8(e)<<8|this.getUInt8(e+1)}getUInt16(e){return this.getUInt8(e)<<8|this.getUInt8(e+1)}getInt32(e){return this.getInt8(e)<<24|this.getUInt8(e+1)<<16|this.getUInt8(e+2)<<8|this.getUInt8(e+3)}getUInt32(e){return this.getUInt8(e)<<24|this.getUInt8(e+1)<<16|this.getUInt8(e+2)<<8|this.getUInt8(e+3)}getInt64(e){return this.getInt8(e)<<56|this.getUInt8(e+1)<<48|this.getUInt8(e+2)<<40|this.getUInt8(e+3)<<32|this.getUInt8(e+4)<<24|this.getUInt8(e+5)<<16|this.getUInt8(e+6)<<8|this.getUInt8(e+7)}getSlice(e,t){return new ho(e,t,this)}putInt16(e,t){this.putInt8(e,t>>8),this.putUInt8(e+1,255&t)}putUInt16(e,t){this.putUInt8(e,t>>8&255),this.putUInt8(e+1,255&t)}putInt32(e,t){this.putInt8(e,t>>24),this.putUInt8(e+1,t>>16&255),this.putUInt8(e+2,t>>8&255),this.putUInt8(e+3,255&t)}putUInt32(e,t){this.putUInt8(e,t>>24&255),this.putUInt8(e+1,t>>16&255),this.putUInt8(e+2,t>>8&255),this.putUInt8(e+3,255&t)}putInt64(e,t){this.putInt8(e,t>>48),this.putUInt8(e+1,t>>42&255),this.putUInt8(e+2,t>>36&255),this.putUInt8(e+3,t>>30&255),this.putUInt8(e+4,t>>24&255),this.putUInt8(e+5,t>>16&255),this.putUInt8(e+6,t>>8&255),this.putUInt8(e+7,255&t)}putBytes(r,n){for(let e=0,t=n.remaining();e<t;e++)this.putUInt8(r+e,n.readUInt8())}readUInt8(){return this.getUInt8(this._updatePos(1))}readInt8(){return this.getInt8(this._updatePos(1))}readUInt16(){return this.getUInt16(this._updatePos(2))}readUInt32(){return this.getUInt32(this._updatePos(4))}readInt16(){return this.getInt16(this._updatePos(2))}readInt32(){return this.getInt32(this._updatePos(4))}readInt64(){return this.getInt32(this._updatePos(8))}readFloat64(){return this.getFloat64(this._updatePos(8))}writeUInt8(e){this.putUInt8(this._updatePos(1),e)}writeInt8(e){this.putInt8(this._updatePos(1),e)}writeInt16(e){this.putInt16(this._updatePos(2),e)}writeInt32(e){this.putInt32(this._updatePos(4),e)}writeUInt32(e){this.putUInt32(this._updatePos(4),e)}writeInt64(e){this.putInt64(this._updatePos(8),e)}writeFloat64(e){this.putFloat64(this._updatePos(8),e)}writeBytes(e){this.putBytes(this._updatePos(e.remaining()),e)}readSlice(e){return this.getSlice(this._updatePos(e),e)}_updatePos(e){var t=this.position;return this.position+=e,t}remaining(){return this.length-this.position}hasRemaining(){return 0<this.remaining()}reset(){this.position=0}toString(){return this.constructor.name+"( position="+this.position+" )\n  "+this.toHex()}toHex(){let r="";for(let t=0;t<this.length;t++){let e=this.getUInt8(t).toString(16);1===e.length&&(e="0"+e),r+=e,t!==this.length-1&&(r+=" ")}return r}}class ho extends lo{constructor(e,t,r){super(t),this._start=e,this._inner=r}putUInt8(e,t){this._inner.putUInt8(this._start+e,t)}getUInt8(e){return this._inner.getUInt8(this._start+e)}putInt8(e,t){this._inner.putInt8(this._start+e,t)}putFloat64(e,t){this._inner.putFloat64(this._start+e,t)}getInt8(e){return this._inner.getInt8(this._start+e)}getFloat64(e){return this._inner.getFloat64(this._start+e)}}Ir=Object.freeze({__proto__:null,default:lo,BaseBuffer:lo});class co extends lo{constructor(e){e=(e=e)instanceof a.Buffer?e:"number"==typeof e&&"function"==typeof a.Buffer.alloc?a.Buffer.alloc(e):new a.Buffer(e);super(e.length),this._buffer=e}getUInt8(e){return this._buffer.readUInt8(e)}getInt8(e){return this._buffer.readInt8(e)}getFloat64(e){return this._buffer.readDoubleBE(e)}putUInt8(e,t){this._buffer.writeUInt8(t,e)}putInt8(e,t){this._buffer.writeInt8(t,e)}putFloat64(e,t){this._buffer.writeDoubleBE(t,e)}putBytes(e,t){var r;t instanceof co?(r=Math.min(t.length-t.position,this.length-e),t._buffer.copy(this._buffer,e,t.position,t.position+r),t.position+=r):super.putBytes(e,t)}getSlice(e,t){return new co(this._buffer.slice(e,e+t))}}function fo(e){return new co(e)}const{ENCRYPTION_OFF:_o,ENCRYPTION_ON:mo}=t["util"];var ur=t["resolver"]["BaseHostNameResolver"];class po extends ur{resolve(e){return this._resolveToItself(e)}}const go=class{constructor(e,t=function(){return"undefined"!=typeof window&&window.location?window.location.protocol:null},r=e=>new WebSocket(e)){this._open=!0,this._pending=[],this._error=null,this._handleConnectionError=this._handleConnectionError.bind(this),this._config=e,this._receiveTimeout=null,this._receiveTimeoutStarted=!1,this._receiveTimeoutId=null,this._closingPromise=null;var{scheme:t,error:n}=function(e,t){var r=function(e){return!0===e.encrypted||e.encrypted===mo}(e),n=function(e){return!1===e.encrypted||e.encrypted===_o}(e),e=e.trust,t=function(e){e="function"==typeof e?e():"";return e&&0<=e.toLowerCase().indexOf("https")}(t);if(function(e,t,r){null!==r&&(e&&!r?console.warn("Neo4j driver is configured to use secure WebSocket on a HTTP web page. WebSockets might not work in a mixed content environment. Please consider configuring driver to not use encryption."):t&&r&&console.warn("Neo4j driver is configured to use insecure WebSocket on a HTTPS web page. WebSockets might not work in a mixed content environment. Please consider configuring driver to use encryption."))}(r,n,t),!n){if(t)return{scheme:"wss",error:null};if(r)return e&&"TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"!==e?{scheme:null,error:b("The browser version of this driver only supports one trust strategy, 'TRUST_SYSTEM_CA_SIGNED_CERTIFICATES'. "+e+' is not supported. Please either use TRUST_SYSTEM_CA_SIGNED_CERTIFICATES or disable encryption by setting `encrypted:"'+_o+'"` in the driver configuration.')}:{scheme:"wss",error:null}}return{scheme:"ws",error:null}}(e,t);if(n)this._error=n;else{this._ws=function(t,r,n){var o=t+"://"+r.asHostPort();try{return n(o)}catch(e){if(function(e,t){return"SyntaxError"===e.name&&function(e){return"["===e.charAt(0)&&-1!==e.indexOf("]")}(t.asHostPort())}(e,r))return o=function(e,t){var r=t.host().replace(/:/g,"-"),r=r.replace("%","s"),r=r+".ipv6-literal.net";return e+`://${r}:`+t.port()}(t,r),n(o);throw e}}(t,e.address,r),this._ws.binaryType="arraybuffer";const o=this;this._ws.onclose=function(e){e&&!e.wasClean&&o._handleConnectionError(),o._open=!1},this._ws.onopen=function(){o._clearConnectionTimeout();var t=o._pending;o._pending=null;for(let e=0;e<t.length;e++)o.write(t[e])},this._ws.onmessage=e=>{this._resetTimeout(),o.onmessage&&(e=new co(e.data),o.onmessage(e))},this._ws.onerror=this._handleConnectionError,this._connectionTimeoutFired=!1,this._connectionTimeoutId=this._setupConnectionTimeout()}}_handleConnectionError(){this._connectionTimeoutFired?(this._error=b(`Failed to establish connection in ${this._config.connectionTimeout}ms`,this._config.connectionErrorCode),this.onerror&&this.onerror(this._error)):this._open&&!this._timedout&&(this._error=b("WebSocket connection failure. Due to security constraints in your web browser, the reason for the failure is not available to this Neo4j Driver. Please use your browsers development console to determine the root cause of the failure. Common reasons include the database being unavailable, using the wrong connection URL or temporary network problems. If you have enabled encryption, ensure your browser is configured to trust the certificate Neo4j is configured to use. WebSocket `readyState` is: "+this._ws.readyState,this._config.connectionErrorCode),this.onerror)&&this.onerror(this._error)}write(e){if(null!==this._pending)this._pending.push(e);else{if(!(e instanceof co))throw b("Don't know how to send buffer: "+e);try{this._ws.send(e._buffer)}catch(e){if(1===this._ws.readyState)throw e;this._handleConnectionError()}}}close(){return null===this._closingPromise&&(this._closingPromise=new Promise((e,t)=>{this._clearConnectionTimeout(),this._ws&&3!==this._ws.readyState?(this._open=!1,this.stopReceiveTimeout(),this._ws.onclose=()=>{e()},this._ws.close()):e()})),this._closingPromise}setupReceiveTimeout(e){this._receiveTimeout=e}stopReceiveTimeout(){null!==this._receiveTimeout&&this._receiveTimeoutStarted&&(this._receiveTimeoutStarted=!1,null!=this._receiveTimeoutId&&clearTimeout(this._receiveTimeoutId),this._receiveTimeoutId=null)}startReceiveTimeout(){this._open&&null!==this._receiveTimeout&&!this._receiveTimeoutStarted&&(this._receiveTimeoutStarted=!0,this._resetTimeout())}_resetTimeout(){this._receiveTimeoutStarted&&(null!==this._receiveTimeoutId&&clearTimeout(this._receiveTimeoutId),this._receiveTimeoutId=setTimeout(()=>{this._receiveTimeoutId=null,this._timedout=!0,this.stopReceiveTimeout(),this._error=b(`Connection lost. Server didn't respond in ${this._receiveTimeout}ms`,this._config.connectionErrorCode),this.close(),this.onerror&&this.onerror(this._error)},this._receiveTimeout))}_setupConnectionTimeout(){var e=this._config.connectionTimeout;if(e){const t=this._ws;return setTimeout(()=>{1!==t.readyState&&(this._connectionTimeoutFired=!0,t.close())},e)}return null}_clearConnectionTimeout(){var e=this._connectionTimeoutId;!e&&0!==e||(this._connectionTimeoutFired=!1,this._connectionTimeoutId=null,clearTimeout(e))}},bo=po;class yo extends lo{constructor(t){let r=0;for(let e=0;e<t.length;e++)r+=t[e].length;super(r),this._buffers=t}getUInt8(t){for(let e=0;e<this._buffers.length;e++){var r=this._buffers[e];if(!(t>=r.length))return r.getUInt8(t);t-=r.length}}getInt8(t){for(let e=0;e<this._buffers.length;e++){var r=this._buffers[e];if(!(t>=r.length))return r.getInt8(t);t-=r.length}}getFloat64(t){var r=fo(8);for(let e=0;e<8;e++)r.putUInt8(e,this.getUInt8(t+e));return r.getFloat64(0)}}class vo extends lo{constructor(e,t){super(0),this._bufferSize=t||1400,this._ch=e,this._buffer=fo(this._bufferSize),this._currentChunkStart=0,this._chunkOpen=!1}putUInt8(e,t){this._ensure(1),this._buffer.writeUInt8(t)}putInt8(e,t){this._ensure(1),this._buffer.writeInt8(t)}putFloat64(e,t){this._ensure(8),this._buffer.writeFloat64(t)}putBytes(e,t){for(;0<t.remaining();)this._ensure(1),this._buffer.remaining()>t.remaining()?this._buffer.writeBytes(t):this._buffer.writeBytes(t.readSlice(this._buffer.remaining()));return this}flush(){var e;return 0<this._buffer.position&&(this._closeChunkIfOpen(),e=this._buffer,this._buffer=null,this._ch.write(e.getSlice(0,e.position)),this._buffer=fo(this._bufferSize),this._chunkOpen=!1),this}messageBoundary(){this._closeChunkIfOpen(),this._buffer.remaining()<2&&this.flush(),this._buffer.writeInt16(0)}_ensure(e){e=this._chunkOpen?e:e+2;this._buffer.remaining()<e&&this.flush(),this._chunkOpen||(this._currentChunkStart=this._buffer.position,this._buffer.position=this._buffer.position+2,this._chunkOpen=!0)}_closeChunkIfOpen(){var e;this._chunkOpen&&(e=this._buffer.position-(this._currentChunkStart+2),this._buffer.putUInt16(this._currentChunkStart,e),this._chunkOpen=!1)}}class wo{constructor(){this._currentMessage=[],this._partialChunkHeader=0,this._state=this.AWAITING_CHUNK}AWAITING_CHUNK(e){return 2<=e.remaining()?this._onHeader(e.readUInt16()):(this._partialChunkHeader=e.readUInt8()<<8,this.IN_HEADER)}IN_HEADER(e){return this._onHeader(65535&(this._partialChunkHeader|e.readUInt8()))}IN_CHUNK(e){return this._chunkSize<=e.remaining()?(this._currentMessage.push(e.readSlice(this._chunkSize)),this.AWAITING_CHUNK):(this._chunkSize-=e.remaining(),this._currentMessage.push(e.readSlice(e.remaining())),this.IN_CHUNK)}CLOSED(e){}_onHeader(e){if(0!==e)return this._chunkSize=e,this.IN_CHUNK;{let e;switch(this._currentMessage.length){case 0:return this.AWAITING_CHUNK;case 1:e=this._currentMessage[0];break;default:e=new yo(this._currentMessage)}return this._currentMessage=[],this.onmessage(e),this.AWAITING_CHUNK}}write(e){for(;e.hasRemaining();)this._state=this._state(e)}}var{ENCRYPTION_OFF:e,ENCRYPTION_ON:ee}=t["util"];const Eo=s["SERVICE_UNAVAILABLE"],To=[null,void 0,!0,!1,ee,e],Co=[null,void 0,"TRUST_ALL_CERTIFICATES","TRUST_CUSTOM_CA_SIGNED_CERTIFICATES","TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"];class Oo{constructor(e,t,r){this.address=e,this.encrypted=function(e){e=e.encrypted;if(-1!==To.indexOf(e))return e;throw b(`Illegal value of the encrypted setting ${e}. Expected one of `+To)}(t),this.trust=function(e){e=e.trust;if(-1!==Co.indexOf(e))return e;throw b(`Illegal value of the trust setting ${e}. Expected one of `+Co)}(t),this.trustedCertificates=t.trustedCertificates||[],this.knownHostsPath=t.knownHosts||null,this.connectionErrorCode=r||Eo,this.connectionTimeout=t.connectionTimeout}}var Io,O,n={exports:{}};function ko(e,t){for(var r in e)t[r]=e[r]}function Ro(e,t,r){return O(e,t,r)}r=(i=n).exports,(O=(Io=a).Buffer).from&&O.alloc&&O.allocUnsafe&&O.allocUnsafeSlow?i.exports=Io:(ko(Io,r),r.Buffer=Ro),Ro.prototype=Object.create(O.prototype),ko(O,Ro),Ro.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return O(e,t,r)},Ro.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");e=O(e);return void 0!==t?"string"==typeof r?e.fill(t,r):e.fill(t):e.fill(0),e},Ro.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return O(e)},Ro.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return Io.SlowBuffer(e)};var So=n.exports.Buffer,Po=So.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function No(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"==typeof t||So.isEncoding!==Po&&Po(e))return t||e;throw new Error("Unknown encoding: "+e)}se=Ao;function Ao(e){var t;switch(this.encoding=No(e),this.encoding){case"utf16le":this.text=Do,this.end=Bo,t=4;break;case"utf8":this.fillLast=Lo,t=4;break;case"base64":this.text=xo,this.end=Mo,t=3;break;default:return this.write=Fo,void(this.end=jo)}this.lastNeed=0,this.lastTotal=0,this.lastChar=So.allocUnsafe(t)}function Uo(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function Lo(e){var t,r=this.lastTotal-this.lastNeed,n=(t=this,128!=(192&(n=e)[0])?(t.lastNeed=0,"�"):1<t.lastNeed&&1<n.length?128!=(192&n[1])?(t.lastNeed=1,"�"):2<t.lastNeed&&2<n.length&&128!=(192&n[2])?(t.lastNeed=2,"�"):void 0:void 0);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,r,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,r,0,e.length),void(this.lastNeed-=e.length))}function Do(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);t=e.toString("utf16le",t);if(t){var r=t.charCodeAt(t.length-1);if(55296<=r&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}function Bo(e){var t,e=e&&e.length?this.write(e):"";return this.lastNeed?(t=this.lastTotal-this.lastNeed,e+this.lastChar.toString("utf16le",0,t)):e}function xo(e,t){var r=(e.length-t)%3;return 0==r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1==r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function Mo(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function Fo(e){return e.toString(this.encoding)}function jo(e){return e&&e.length?this.write(e):""}Ao.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},Ao.prototype.end=function(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+"�":e},Ao.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(!(n<r)){var o=Uo(t[n]);if(0<=o)return 0<o&&(e.lastNeed=o-1),o;if(!(--n<r||-2===o)){if(0<=(o=Uo(t[n])))return 0<o&&(e.lastNeed=o-2),o;if(!(--n<r||-2===o)&&0<=(o=Uo(t[n])))return 0<o&&(2===o?o=0:e.lastNeed=o-3),o}}return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;r=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},Ao.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};const qo=new se("utf8");var zo={encode:function(e){return new co((e=e,"function"==typeof a.Buffer.from?a.Buffer.from(e,"utf8"):new a.Buffer(e,"utf8")))},decode:function(e,t){if(Object.prototype.hasOwnProperty.call(e,"_buffer"))return r=t,u=(a=e).position,r=u+r,a.position=Math.min(r,a.length),a._buffer.toString("utf8",u,r);if(Object.prototype.hasOwnProperty.call(e,"_buffers")){a=e,u=t;{var r=a,t=u,s=e=>qo.write(e._buffer),n=()=>qo.end();let o=t,i=r.position;return r._updatePos(Math.min(t,r.length-i)),(t=r._buffers.reduce(function(e,t){var r,n;return o<=0?e:i>=t.length?(i-=t.length,""):(t._updatePos(i-t.position),r=Math.min(t.length-i,o),n=t.readSlice(r),t._updatePos(r),o=Math.max(o-n.length,0),i=0,e+s(n))},""))+n()}}throw b(`Don't know how to decode strings from '${e}'`);var a,r,u}},sr=Object.freeze({__proto__:null,ChannelConfig:Oo,alloc:fo,utf8:zo,Channel:go,HostNameResolver:bo,Chunker:vo,Dechunker:wo});const Ho=1616949271;function Wo(e,t){return{major:e,minor:t}}function Vo(){{var e=[[Wo(5,4),Wo(5,0)],[Wo(4,4),Wo(4,2)],Wo(4,1),Wo(3,0)];if(4<e.length)throw b("It should not have more than 4 versions of the protocol");const o=fo(20);return o.writeInt32(Ho),e.forEach(e=>{var t,r,n;e instanceof Array?({major:t,minor:n}=e[0],r=e[1]["minor"],r=n-r,o.writeInt32(r<<16|n<<8|t)):({major:r,minor:n}=e,o.writeInt32(n<<8|r))}),o.reset(),o}}class $o{static ofRecord(e){return null===e?$o.ofNull():new Yo(e)}static ofMessageResponse(e){return null===e?$o.ofNull():new Ko(e)}static ofNull(){return new Go}get ttl(){throw new Error("Not implemented")}get db(){throw new Error("Not implemented")}get servers(){throw new Error("Not implemented")}get isNull(){throw new Error("Not implemented")}}class Ko extends $o{constructor(e){super(),this._response=e}get ttl(){return this._response.rt.ttl}get servers(){return this._response.rt.servers}get db(){return this._response.rt.db}get isNull(){return null===this._response}}class Go extends $o{get isNull(){return!0}}class Yo extends $o{constructor(e){super(),this._record=e}get ttl(){return this._record.get("ttl")}get servers(){return this._record.get("servers")}get db(){return this._record.has("db")?this._record.get("db"):null}get isNull(){return null===this._record}}const Zo=t["constants"]["FETCH_ALL"],Xo=s["PROTOCOL_ERROR"];class Qo{onNext(e){}onError(e){}onCompleted(e){}}class I extends Qo{constructor({reactive:e=!1,moreFunction:t,discardFunction:r,fetchSize:n=Zo,beforeError:o,afterError:i,beforeKeys:s,afterKeys:a,beforeComplete:u,afterComplete:l,server:h,highRecordWatermark:c=Number.MAX_VALUE,lowRecordWatermark:d=Number.MAX_VALUE}={}){super(),this._fieldKeys=null,this._fieldLookup=null,this._head=null,this._queuedRecords=[],this._tail=null,this._error=null,this._observers=[],this._meta={},this._server=h,this._beforeError=o,this._afterError=i,this._beforeKeys=s,this._afterKeys=a,this._beforeComplete=u,this._afterComplete=l,this._queryId=null,this._moreFunction=t,this._discardFunction=r,this._discard=!1,this._fetchSize=n,this._lowRecordWatermark=d,this._highRecordWatermark=c,this._setState(e?R.READY:R.READY_STREAMING),this._setupAutoPull(),this._paused=!1}pause(){this._paused=!0}resume(){this._paused=!1,this._setupAutoPull(!0),this._state.pull(this)}onNext(e){const t=new Mt(this._fieldKeys,e,this._fieldLookup);this._observers.some(e=>e.onNext)?this._observers.forEach(e=>{e.onNext&&e.onNext(t)}):(this._queuedRecords.push(t),this._queuedRecords.length>this._highRecordWatermark&&(this._autoPull=!1))}onCompleted(e){this._state.onSuccess(this,e)}onError(e){this._state.onError(this,e)}cancel(){this._discard=!0}prepareToHandleSingleResponse(){this._head=[],this._fieldKeys=[],this._setState(R.STREAMING)}markCompleted(){this._head=[],this._fieldKeys=[],this._tail={},this._setState(R.SUCCEEDED)}subscribe(t){if(this._head&&t.onKeys&&t.onKeys(this._head),0<this._queuedRecords.length&&t.onNext)for(let e=0;e<this._queuedRecords.length;e++)t.onNext(this._queuedRecords[e]),this._queuedRecords.length-e-1<=this._lowRecordWatermark&&(this._autoPull=!0,this._state===R.READY)&&this._handleStreaming();this._tail&&t.onCompleted&&t.onCompleted(this._tail),this._error&&t.onError(this._error),this._observers.push(t),this._state===R.READY&&this._handleStreaming()}_handleHasMore(e){this._setState(R.READY),this._handleStreaming(),delete e.has_more}_handlePullSuccess(e){const t=Object.assign(this._server?{server:this._server}:{},this._meta,e);if([void 0,null,"r","w","rw","s"].includes(t.type)){this._setState(R.SUCCEEDED);let e=null;this._beforeComplete&&(e=this._beforeComplete(t));const r=()=>{this._tail=t,this._observers.some(e=>e.onCompleted)&&this._observers.forEach(e=>{e.onCompleted&&e.onCompleted(t)}),this._afterComplete&&this._afterComplete(t)};e?Promise.resolve(e).then(()=>r()):r()}else this.onError(b(`Server returned invalid query type. Expected one of [undefined, null, "r", "w", "rw", "s"] but got '${t.type}'`,Xo))}_handleRunSuccess(t,r){if(null===this._fieldKeys){if(this._fieldKeys=[],this._fieldLookup={},t.fields&&0<t.fields.length){this._fieldKeys=t.fields;for(let e=0;e<t.fields.length;e++)this._fieldLookup[t.fields[e]]=e;delete t.fields}null!==t.qid&&void 0!==t.qid&&(this._queryId=t.qid,delete t.qid),this._storeMetadataForCompletion(t);let e=null;this._beforeKeys&&(e=this._beforeKeys(this._fieldKeys));const n=()=>{this._head=this._fieldKeys,this._observers.some(e=>e.onKeys)&&this._observers.forEach(e=>{e.onKeys&&e.onKeys(this._fieldKeys)}),this._afterKeys&&this._afterKeys(this._fieldKeys),r()};e?Promise.resolve(e).then(()=>n()):n()}}_handleError(t){this._setState(R.FAILED),this._error=t;let e=null;this._beforeError&&(e=this._beforeError(t));const r=()=>{this._observers.some(e=>e.onError)&&this._observers.forEach(e=>{e.onError&&e.onError(t)}),this._afterError&&this._afterError(t)};e?Promise.resolve(e).then(()=>r()):r()}_handleStreaming(){this._head&&this._observers.some(e=>e.onNext||e.onCompleted)&&(this._paused||!this._discard&&!this._autoPull||this._more())}_more(){this._discard?this._discardFunction(this._queryId,this):this._moreFunction(this._queryId,this._fetchSize,this),this._setState(R.STREAMING)}_storeMetadataForCompletion(e){var t=Object.keys(e);let r=t.length;for(var n;r--;)n=t[r],this._meta[n]=e[n]}_setState(e){this._state=e}_setupAutoPull(){this._autoPull=!0}}class k extends Qo{constructor({onError:e,onCompleted:t}={}){super(),this._onError=e,this._onCompleted=t}onNext(e){this.onError(b("Received RECORD when initializing "+f(e)))}onError(e){this._onError&&this._onError(e)}onCompleted(e){this._onCompleted&&this._onCompleted(e)}}class Jo extends Qo{constructor({onError:e,onCompleted:t}={}){super(),this._onError=e,this._onCompleted=t}onNext(e){this.onError(b("Received RECORD when logging off "+f(e)))}onError(e){this._onError&&this._onError(e)}onCompleted(e){this._onCompleted&&this._onCompleted(e)}}class ei extends Qo{constructor({onProtocolError:e,onError:t,onComplete:r}={}){super(),this._onProtocolError=e,this._onError=t,this._onComplete=r}onNext(e){this.onError(b("Received RECORD when resetting: received record is: "+f(e),Xo))}onError(e){e.code===Xo&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)}onCompleted(e){this._onComplete&&this._onComplete(e)}}class ti extends I{constructor({onError:e,onCompleted:t}={}){super(),this._onError=e,this._onCompleted=t}onNext(e){this.onError(b("Received RECORD when sending telemetry "+f(e),Xo))}onError(e){this._onError&&this._onError(e)}onCompleted(e){this._onCompleted&&this._onCompleted(e)}}I;class ri extends I{constructor(){super(),super.markCompleted()}}class ni extends Qo{constructor({resultObserver:e,onProtocolError:t,onError:r,onCompleted:n}){super(),this._resultObserver=e,this._onError=r,this._onCompleted=n,this._records=[],this._onProtocolError=t,e.subscribe(this)}onNext(e){this._records.push(e)}onError(e){e.code===Xo&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)}onCompleted(){null!==this._records&&1!==this._records.length?this.onError(b("Illegal response from router. Received "+this._records.length+" records but expected only one.\n"+f(this._records),Xo)):this._onCompleted&&this._onCompleted($o.ofRecord(this._records[0]))}}class oi extends Qo{constructor({onProtocolError:e,onError:t,onCompleted:r}={}){super(),this._onProtocolError=e,this._onError=t,this._onCompleted=r}onNext(e){this.onError(b("Received RECORD when resetting: received record is: "+f(e),Xo))}onError(e){e.code===Xo&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)}onCompleted(e){this._onCompleted&&this._onCompleted($o.ofMessageResponse(e))}}const R={READY_STREAMING:{onSuccess:(e,t)=>{e._handleRunSuccess(t,()=>{e._setState(R.STREAMING)})},onError:(e,t)=>{e._handleError(t)},name:()=>"READY_STREAMING",pull:()=>{}},READY:{onSuccess:(e,t)=>{e._handleRunSuccess(t,()=>e._handleStreaming())},onError:(e,t)=>{e._handleError(t)},name:()=>"READY",pull:e=>e._more()},STREAMING:{onSuccess:(e,t)=>{t.has_more?e._handleHasMore(t):e._handlePullSuccess(t)},onError:(e,t)=>{e._handleError(t)},name:()=>"STREAMING",pull:()=>{}},FAILED:{onError:e=>{},name:()=>"FAILED",pull:()=>{}},SUCCEEDED:{name:()=>"SUCCEEDED",pull:()=>{}}};function ii(e,t=()=>{},r){if(e)throw t((e=b("Driver is connected to the database that does not support multiple databases. Please upgrade to neo4j 4.0.0 or later in order to use this functionality")).message),r.onError(e),e}function si(e,t=()=>{},r){if(e)throw t((t=b("Driver is connected to the database that does not support user impersonation. Please upgrade to neo4j 4.4.0 or later in order to use this functionality. "+`Trying to impersonate ${e}.`)).message),r.onError(t),t}function S(e,t=()=>{},r){if(void 0!==e)throw t((t=b("Driver is connected to a database that does not support user notification filters. Please upgrade to Neo4j 5.7.0 or later in order to use this functionality. "+`Trying to set notifications to ${f(e)}.`)).message),r.onError(t),t}function ai(e){return e}function ui(e,t){if(e!==t){if(null===e||null===t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const o of r)if(e[o]!==t[o])return!1}return!0}const li=s["PROTOCOL_ERROR"];class P{constructor(e,t){this.signature=e,this.fields=t}get size(){return this.fields.length}toString(){let t="";for(let e=0;e<this.fields.length;e++)0<e&&(t+=", "),t+=this.fields[e];return"Structure("+this.signature+", ["+t+"])"}}function N(e,t,r){if(t!==r)throw b(`Wrong struct size for ${e}, expected ${t} but was `+r,li)}nr=Object.freeze({__proto__:null,Structure:P,verifyStructSize:N,default:P});const hi=s["PROTOCOL_ERROR"];class ci{constructor(e){this._ch=e,this._byteArraysSupported=!0}packable(o,i=ai){try{o=i(o)}catch(e){return()=>{throw e}}if(null===o)return()=>this._ch.writeUInt8(192);if(!0===o)return()=>this._ch.writeUInt8(195);if(!1===o)return()=>this._ch.writeUInt8(194);if("number"==typeof o)return()=>this.packFloat(o);if("string"==typeof o)return()=>this.packString(o);if("bigint"==typeof o)return()=>this.packInteger(c(o));if(Q(o))return()=>this.packInteger(o);if(o instanceof Int8Array)return()=>this.packBytes(o);if(o instanceof Array)return()=>{this.packListHeader(o.length);for(let e=0;e<o.length;e++)this.packable(void 0===o[e]?null:o[e],i)()};if(null!=(e=o)&&"function"==typeof e[Symbol.iterator])return this.packableIterable(o,i);if(o instanceof P){const t=[];for(let e=0;e<o.fields.length;e++)t[e]=this.packable(o.fields[e],i);return()=>this.packStruct(o.signature,t)}return"object"==typeof o?()=>{var t=Object.keys(o);let r=0;for(let e=0;e<t.length;e++)void 0!==o[t[e]]&&r++;this.packMapHeader(r);for(let e=0;e<t.length;e++){var n=t[e];void 0!==o[n]&&(this.packString(n),this.packable(o[n],i)())}}:this._nonPackableValue("Unable to pack the given value: "+o);var e}packableIterable(t,e){try{var r=Array.from(t);return this.packable(r,e)}catch(e){throw b(`Cannot pack given iterable, ${e.message}: `+t)}}packStruct(e,t){this.packStructHeader((t=t||[]).length,e);for(let e=0;e<t.length;e++)t[e]()}packInteger(e){var t=e.high,r=e.low;e.greaterThanOrEqual(-16)&&e.lessThan(128)?this._ch.writeInt8(r):e.greaterThanOrEqual(-128)&&e.lessThan(-16)?(this._ch.writeUInt8(200),this._ch.writeInt8(r)):e.greaterThanOrEqual(-32768)&&e.lessThan(32768)?(this._ch.writeUInt8(201),this._ch.writeInt16(r)):(e.greaterThanOrEqual(-2147483648)&&e.lessThan(2147483648)?this._ch.writeUInt8(202):(this._ch.writeUInt8(203),this._ch.writeInt32(t)),this._ch.writeInt32(r))}packFloat(e){this._ch.writeUInt8(193),this._ch.writeFloat64(e)}packString(e){var e=zo.encode(e),t=e.length;if(t<16)this._ch.writeUInt8(128|t);else if(t<256)this._ch.writeUInt8(208),this._ch.writeUInt8(t);else{if(t<65536)this._ch.writeUInt8(209),this._ch.writeUInt8(t/256>>0);else{if(!(t<4294967296))throw b("UTF-8 strings of size "+t+" are not supported");this._ch.writeUInt8(210),this._ch.writeUInt8((t/16777216>>0)%256),this._ch.writeUInt8((t/65536>>0)%256),this._ch.writeUInt8((t/256>>0)%256)}this._ch.writeUInt8(t%256)}this._ch.writeBytes(e)}packListHeader(e){if(e<16)this._ch.writeUInt8(144|e);else if(e<256)this._ch.writeUInt8(212),this._ch.writeUInt8(e);else{if(e<65536)this._ch.writeUInt8(213);else{if(!(e<4294967296))throw b("Lists of size "+e+" are not supported");this._ch.writeUInt8(214),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256)}this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}}packBytes(t){if(!this._byteArraysSupported)throw b("Byte arrays are not supported by the database this driver is connected to");this.packBytesHeader(t.length);for(let e=0;e<t.length;e++)this._ch.writeInt8(t[e])}packBytesHeader(e){if(e<256)this._ch.writeUInt8(204),this._ch.writeUInt8(e);else{if(e<65536)this._ch.writeUInt8(205);else{if(!(e<4294967296))throw b("Byte arrays of size "+e+" are not supported");this._ch.writeUInt8(206),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256)}this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}}packMapHeader(e){if(e<16)this._ch.writeUInt8(160|e);else if(e<256)this._ch.writeUInt8(216),this._ch.writeUInt8(e);else{if(e<65536)this._ch.writeUInt8(217),this._ch.writeUInt8(e/256>>0);else{if(!(e<4294967296))throw b("Maps of size "+e+" are not supported");this._ch.writeUInt8(218),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256),this._ch.writeUInt8((e/256>>0)%256)}this._ch.writeUInt8(e%256)}}packStructHeader(e,t){if(e<16)this._ch.writeUInt8(176|e),this._ch.writeUInt8(t);else if(e<256)this._ch.writeUInt8(220),this._ch.writeUInt8(e),this._ch.writeUInt8(t);else{if(!(e<65536))throw b("Structures of size "+e+" are not supported");this._ch.writeUInt8(221),this._ch.writeUInt8(e/256>>0),this._ch.writeUInt8(e%256)}}disableByteArrays(){this._byteArraysSupported=!1}_nonPackableValue(e){return()=>{throw b(e,hi)}}}class di{constructor(e=!1,t=!1){this._disableLosslessIntegers=e,this._useBigInt=t}unpack(e,t=ai){var r=e.readUInt8(),n=240&r,o=15&r;if(192===r)return null;var i=this._unpackBoolean(r);if(null!==i)return i;i=this._unpackNumberOrInteger(r,e);if(null!==i){if(Q(i)){if(this._useBigInt)return i.toBigInt();if(this._disableLosslessIntegers)return i.toNumberOrInfinity()}return i}i=this._unpackString(r,n,o,e);if(null!==i)return i;i=this._unpackList(r,n,o,e,t);if(null!==i)return i;i=this._unpackByteArray(r,e);if(null!==i)return i;i=this._unpackMap(r,n,o,e,t);if(null!==i)return i;i=this._unpackStruct(r,n,o,e,t);if(null!==i)return i;throw b("Unknown packed value with marker "+r.toString(16))}unpackInteger(e){var t=e.readUInt8(),e=this._unpackInteger(t,e);if(null==e)throw b("Unable to unpack integer value with marker "+t.toString(16));return e}_unpackBoolean(e){return 195===e||194!==e&&null}_unpackNumberOrInteger(e,t){return 193===e?t.readFloat64():this._unpackInteger(e,t)}_unpackInteger(e,t){var r;return 0<=e&&e<128?c(e):240<=e&&e<256?c(e-256):200===e?c(t.readInt8()):201===e?c(t.readInt16()):202===e?(r=t.readInt32(),c(r)):203===e?(r=t.readInt32(),e=t.readInt32(),new d(e,r)):null}_unpackString(e,t,r,n){return 128===t?zo.decode(n,r):208===e?zo.decode(n,n.readUInt8()):209===e?zo.decode(n,n.readUInt16()):210===e?zo.decode(n,n.readUInt32()):null}_unpackList(e,t,r,n,o){return 144===t?this._unpackListWithSize(r,n,o):212===e?this._unpackListWithSize(n.readUInt8(),n,o):213===e?this._unpackListWithSize(n.readUInt16(),n,o):214===e?this._unpackListWithSize(n.readUInt32(),n,o):null}_unpackListWithSize(t,r,n){var o=[];for(let e=0;e<t;e++)o.push(this.unpack(r,n));return o}_unpackByteArray(e,t){return 204===e?this._unpackByteArrayWithSize(t.readUInt8(),t):205===e?this._unpackByteArrayWithSize(t.readUInt16(),t):206===e?this._unpackByteArrayWithSize(t.readUInt32(),t):null}_unpackByteArrayWithSize(t,r){var n=new Int8Array(t);for(let e=0;e<t;e++)n[e]=r.readInt8();return n}_unpackMap(e,t,r,n,o){return 160===t?this._unpackMapWithSize(r,n,o):216===e?this._unpackMapWithSize(n.readUInt8(),n,o):217===e?this._unpackMapWithSize(n.readUInt16(),n,o):218===e?this._unpackMapWithSize(n.readUInt32(),n,o):null}_unpackMapWithSize(t,r,n){var o={};for(let e=0;e<t;e++)o[this.unpack(r,n)]=this.unpack(r,n);return o}_unpackStruct(e,t,r,n,o){return 176===t?this._unpackStructWithSize(r,n,o):220===e?this._unpackStructWithSize(n.readUInt8(),n,o):221===e?this._unpackStructWithSize(n.readUInt16(),n,o):null}_unpackStructWithSize(t,r,n){var e=r.readUInt8(),o=new P(e,[]);for(let e=0;e<t;e++)o.fields.push(this.unpack(r,n));return n(o)}}rr=Object.freeze({__proto__:null,Packer:ci,Unpacker:di});ci;di;var fi=Object.freeze({__proto__:null,Packer:class extends ci{disableByteArrays(){throw new Error("Bolt V2 should always support byte arrays")}},Unpacker:class extends di{constructor(e=!1,t=!1){super(e,t)}}}),Pr=Object.freeze({__proto__:null,v1:rr,v2:fi,structure:nr,default:fi});const{constants:{ACCESS_MODE_READ:_i,FETCH_ALL:mi},util:{assertString:pi}}=t;const gi=Object.freeze({INIT:1,RESET:15,RUN:16,PULL_ALL:63,HELLO:1,GOODBYE:2,BEGIN:17,COMMIT:18,ROLLBACK:19,TELEMETRY:84,ROUTE:102,LOGON:106,LOGOFF:107,DISCARD:47,PULL:63});class A{constructor(e,t,r){this.signature=e,this.fields=t,this.toString=r}static init(e,t){return new A(1,[e,t],()=>`INIT ${e} {...}`)}static run(e,t){return new A(16,[e,t],()=>`RUN ${e} `+f(t))}static pullAll(){return vi}static reset(){return wi}static hello(e,t,r=null,n=null){t=Object.assign({user_agent:e},t);return r&&(t.routing=r),n&&(t.patch_bolt=n),new A(1,[t],()=>`HELLO {user_agent: '${e}', ...}`)}static hello5x1(e,t=null){var r={user_agent:e};return t&&(r.routing=t),new A(1,[r],()=>`HELLO {user_agent: '${e}', ...}`)}static hello5x2(e,t=null,r=null){const n={user_agent:e};return t&&(t.minimumSeverityLevel&&(n.notifications_minimum_severity=t.minimumSeverityLevel),t.disabledCategories)&&(n.notifications_disabled_categories=t.disabledCategories),r&&(n.routing=r),new A(1,[n],()=>"HELLO "+f(n))}static hello5x3(e,t,r=null,n=null){const o={};return e&&(o.user_agent=e),t&&(o.bolt_agent={product:t.product,platform:t.platform,language:t.language,language_details:t.languageDetails}),r&&(r.minimumSeverityLevel&&(o.notifications_minimum_severity=r.minimumSeverityLevel),r.disabledCategories)&&(o.notifications_disabled_categories=r.disabledCategories),n&&(o.routing=n),new A(1,[o],()=>"HELLO "+f(o))}static logon(e){return new A(106,[e],()=>"LOGON { ... }")}static logoff(){return new A(107,[],()=>"LOGOFF")}static begin({bookmarks:e,txConfig:t,database:r,mode:n,impersonatedUser:o,notificationFilter:i}={}){const s=bi(e,t,r,n,o,i);return new A(17,[s],()=>"BEGIN "+f(s))}static commit(){return Ei}static rollback(){return Ti}static runWithMetadata(e,t,{bookmarks:r,txConfig:n,database:o,mode:i,impersonatedUser:s,notificationFilter:a}={}){const u=bi(r,n,o,i,s,a);return new A(16,[e,t,u],()=>`RUN ${e} ${f(t)} `+f(u))}static goodbye(){return Ci}static pull({stmtId:e=-1,n:t=mi}={}){const r=yi(null==e?-1:e,t||mi);return new A(63,[r],()=>"PULL "+f(r))}static discard({stmtId:e=-1,n:t=mi}={}){const r=yi(null==e?-1:e,t||mi);return new A(47,[r],()=>"DISCARD "+f(r))}static telemetry({api:e}){const t=c(e);return new A(84,[t],()=>"TELEMETRY "+t.toString())}static route(e={},t=[],r=null){return new A(102,[e,t,r],()=>`ROUTE ${f(e)} ${f(t)} `+r)}static routeV4x4(e={},t=[],r={}){const n={};return r.databaseName&&(n.db=r.databaseName),r.impersonatedUser&&(n.imp_user=r.impersonatedUser),new A(102,[e,t,n],()=>`ROUTE ${f(e)} ${f(t)} `+f(n))}}function bi(e,t,r,n,o,i){var s={};return e.isEmpty()||(s.bookmarks=e.values()),null!==t.timeout&&(s.tx_timeout=t.timeout),t.metadata&&(s.tx_metadata=t.metadata),r&&(s.db=pi(r,"database")),o&&(s.imp_user=pi(o,"impersonatedUser")),n===_i&&(s.mode="r"),i&&(i.minimumSeverityLevel&&(s.notifications_minimum_severity=i.minimumSeverityLevel),i.disabledCategories)&&(s.notifications_disabled_categories=i.disabledCategories),s}function yi(e,t){t={n:c(t)};return-1!==e&&(t.qid=c(e)),t}const vi=new A(63,[],()=>"PULL_ALL"),wi=new A(15,[],()=>"RESET"),Ei=new A(18,[],()=>"COMMIT"),Ti=new A(19,[],()=>"ROLLBACK"),Ci=new A(2,[],()=>"GOODBYE"),Oi=t["objectUtil"];class U{constructor(e){this._transformers=e,this._transformersPerSignature=new Map(e.map(e=>[e.signature,e])),this.fromStructure=this.fromStructure.bind(this),this.toStructure=this.toStructure.bind(this),Object.freeze(this)}fromStructure(e){try{var t;return e instanceof P&&this._transformersPerSignature.has(e.signature)?(t=this._transformersPerSignature.get(e.signature)["fromStructure"],t(e)):e}catch(e){return Oi.createBrokenObject(e)}}toStructure(t){var e=this._transformers.find(({isTypeInstance:e})=>e(t));return void 0!==e?e.toStructure(t):t}}class L{constructor({signature:e,fromStructure:t,toStructure:r,isTypeInstance:n}){this.signature=e,this.isTypeInstance=n,this.fromStructure=t,this.toStructure=r,Object.freeze(this)}extendsWith({signature:e,fromStructure:t,toStructure:r,isTypeInstance:n}){return new L({signature:e||this.signature,fromStructure:t||this.fromStructure,toStructure:r||this.toStructure,isTypeInstance:n||this.isTypeInstance})}}const Ii=s["PROTOCOL_ERROR"];var ki={createNodeTransformer:function(){return new L({signature:78,isTypeInstance:e=>e instanceof kt,toStructure:e=>{throw b("It is not allowed to pass nodes in query parameters, given: "+e,Ii)},fromStructure:e=>{N("Node",3,e.size);var[e,t,r]=e.fields;return new kt(e,t,r)}})},createRelationshipTransformer:function(){return new L({signature:82,isTypeInstance:e=>e instanceof St,toStructure:e=>{throw b("It is not allowed to pass relationships in query parameters, given: "+e,Ii)},fromStructure:e=>{N("Relationship",5,e.size);var[e,t,r,n,o]=e.fields;return new St(e,t,r,n,o)}})},createUnboundRelationshipTransformer:function(){return new L({signature:114,isTypeInstance:e=>e instanceof Nt,toStructure:e=>{throw b("It is not allowed to pass unbound relationships in query parameters, given: "+e,Ii)},fromStructure:e=>{N("UnboundRelationship",3,e.size);var[e,t,r]=e.fields;return new Nt(e,t,r)}})},createPathTransformer:function(){return new L({signature:80,isTypeInstance:e=>e instanceof Dt,toStructure:e=>{throw b("It is not allowed to pass paths in query parameters, given: "+e,Ii)},fromStructure:e=>{N("Path",3,e.size);var[r,n,o]=e.fields,i=[];let s=r[0];for(let t=0;t<o.length;t+=2){var a=r[o[t+1]],u=J(o[t]);let e;0<u?(e=n[u-1])instanceof Nt&&(n[u-1]=e=e.bindTo(s,a)):(e=n[-u-1])instanceof Nt&&(n[-u-1]=e=e.bindTo(a,s)),i.push(new Ut(s,e,a)),s=a}return new Dt(r[0],r[r.length-1],i)}})}};const{bookmarks:{Bookmarks:Ri},constants:{ACCESS_MODE_WRITE:Si,BOLT_PROTOCOL_V1:Pi},logger:{},txConfig:{TxConfig:Ni}}=t;class Ai{constructor(e,t,{disableLosslessIntegers:r,useBigInt:n}={},o=()=>null,i,s){this._server=e||{},this._chunker=t,this._packer=this._createPacker(t),this._unpacker=this._createUnpacker(r,n),this._responseHandler=o(this),this._log=i,this._onProtocolError=s,this._fatalError=null,this._lastMessageSignature=null,this._config={disableLosslessIntegers:r,useBigInt:n}}get transformer(){return void 0===this._transformer&&(this._transformer=new U(Object.values(ki).map(e=>e(this._config,this._log)))),this._transformer}get version(){return Pi}get supportsReAuth(){return!1}get initialized(){return!!this._initialized}get authToken(){return this._authToken}packer(){return this._packer}packable(e){return this._packer.packable(e,this.transformer.toStructure)}unpacker(){return this._unpacker}unpack(e){return this._unpacker.unpack(e,this.transformer.fromStructure)}transformMetadata(e){return e}initialize({userAgent:e,authToken:t,notificationFilter:r,onError:n,onComplete:o}={}){var i=new k({onError:e=>this._onLoginError(e,n),onCompleted:e=>this._onLoginCompleted(e,o)});return S(r,this._onProtocolError,i),this.write(A.init(e,t),i,!0),i}logoff({onComplete:e,onError:t}={}){e=new Jo({onCompleted:e,onError:t}),t=b("Driver is connected to a database that does not support logoff. Please upgrade to Neo4j 5.5.0 or later in order to use this functionality.");throw this._onProtocolError(t.message),e.onError(t),t}logon({authToken:e,onComplete:t,onError:r}={}){var n=new k({onCompleted:()=>this._onLoginCompleted({},e,t),onError:e=>this._onLoginError(e,r)}),o=b("Driver is connected to a database that does not support logon. Please upgrade to Neo4j 5.5.0 or later in order to use this functionality.");throw this._onProtocolError(o.message),n.onError(o),o}prepareToClose(){}beginTransaction({bookmarks:e,txConfig:t,database:r,mode:n,impersonatedUser:o,notificationFilter:i,beforeError:s,afterError:a,beforeComplete:u,afterComplete:l}={}){return this.run("BEGIN",e?e.asBeginTransactionParameters():{},{bookmarks:e,txConfig:t,database:r,mode:n,impersonatedUser:o,notificationFilter:i,beforeError:s,afterError:a,beforeComplete:u,afterComplete:l,flush:!1})}commitTransaction({beforeError:e,afterError:t,beforeComplete:r,afterComplete:n}={}){return this.run("COMMIT",{},{bookmarks:Ri.empty(),txConfig:Ni.empty(),mode:Si,beforeError:e,afterError:t,beforeComplete:r,afterComplete:n})}rollbackTransaction({beforeError:e,afterError:t,beforeComplete:r,afterComplete:n}={}){return this.run("ROLLBACK",{},{bookmarks:Ri.empty(),txConfig:Ni.empty(),mode:Si,beforeError:e,afterError:t,beforeComplete:r,afterComplete:n})}run(e,t,{txConfig:r,database:n,impersonatedUser:o,notificationFilter:i,beforeKeys:s,afterKeys:a,beforeError:u,afterError:l,beforeComplete:h,afterComplete:c,flush:d=!0,highRecordWatermark:f=Number.MAX_VALUE,lowRecordWatermark:_=Number.MAX_VALUE}={}){var s=new I({server:this._server,beforeKeys:s,afterKeys:a,beforeError:u,afterError:l,beforeComplete:h,afterComplete:c,highRecordWatermark:f,lowRecordWatermark:_}),[a,u=()=>{},l]=[r,this._onProtocolError,s];if(a&&!a.isEmpty())throw u((a=b("Driver is connected to the database that does not support transaction configuration. Please upgrade to neo4j 3.5.0 or later in order to use this functionality")).message),l.onError(a),a;return ii(n,this._onProtocolError,s),si(o,this._onProtocolError,s),S(i,this._onProtocolError,s),this.write(A.run(e,t),s,!1),this.write(A.pullAll(),s,d),s}get currentFailure(){return this._responseHandler.currentFailure}reset({onError:e,onComplete:t}={}){e=new ei({onProtocolError:this._onProtocolError,onError:e,onComplete:t});return this.write(A.reset(),e,!0),e}telemetry({},{onCompleted:e}={}){var t=new ri;return e&&e(),t}_createPacker(e){return new ci(e)}_createUnpacker(e,t){return new di(e,t)}write(e,t,r){this.queueObserverIfProtocolIsNotBroken(t)&&(this._log.isDebugEnabled()&&this._log.debug("C: "+e),this._lastMessageSignature=e.signature,t=new P(e.signature,e.fields),this.packable(t)(),this._chunker.messageBoundary(),r)&&this._chunker.flush()}isLastMessageLogon(){return this._lastMessageSignature===gi.HELLO||this._lastMessageSignature===gi.LOGON}isLastMessageReset(){return this._lastMessageSignature===gi.RESET}notifyFatalError(e){return this._fatalError=e,this._responseHandler._notifyErrorToObservers(e)}updateCurrentObserver(){return this._responseHandler._updateCurrentObserver()}hasOngoingObservableRequests(){return this._responseHandler.hasOngoingObservableRequests()}queueObserverIfProtocolIsNotBroken(e){return this.isBroken()?(this.notifyFatalErrorToObserver(e),!1):this._responseHandler._queueObserver(e)}isBroken(){return!!this._fatalError}notifyFatalErrorToObserver(e){e&&e.onError&&e.onError(this._fatalError)}resetFailure(){this._responseHandler._resetFailure()}_onLoginCompleted(e,t,r){this._initialized=!0,this._authToken=t,e&&(t=e.server,this._server.version||(this._server.version=t)),r&&r(e)}_onLoginError(e,t){this._onProtocolError(e.message),t&&t(e)}}const{DAYS_0000_TO_1970:Ui,DAYS_PER_400_YEAR_CYCLE:Li,NANOS_PER_HOUR:Di,NANOS_PER_MINUTE:Bi,NANOS_PER_SECOND:xi,SECONDS_PER_DAY:Mi,floorDiv:Fi,floorMod:ji}=t["temporalUtil"];function qi(e){let t=(e=c(e)).add(Ui).subtract(60),r=c(0);t.lessThan(0)&&(e=t.add(1).div(Li).subtract(1),r=e.multiply(400),t=t.add(e.multiply(-Li)));let n=t.multiply(400).add(591).div(Li),o=t.subtract(n.multiply(365).add(n.div(4)).subtract(n.div(100)).add(n.div(400)));o.lessThan(0)&&(n=n.subtract(1),o=t.subtract(n.multiply(365).add(n.div(4)).subtract(n.div(100)).add(n.div(400)))),n=n.add(r);var e=o,i=e.multiply(5).add(2).div(153),s=i.add(2).modulo(12).add(1),e=e.subtract(i.multiply(306).add(5).div(10)).add(1);return n=n.add(i.div(10)),new dt(n,s,e)}function zi(e){var t=(e=c(e)).div(Di),r=(e=e.subtract(t.multiply(Di))).div(Bi),n=(e=e.subtract(r.multiply(Bi))).div(xi),e=e.subtract(n.multiply(xi));return new ut(t,r,n,e)}function Hi(e,t){var r=Fi(e,Mi),e=ji(e,Mi).multiply(xi).add(t),t=qi(r),r=zi(e);return new _t(t.year,t.month,t.day,r.hour,r.minute,r.second,r.nanosecond)}const{dateToEpochDay:Wi,localDateTimeToEpochSecond:Vi,localTimeToNanoOfDay:$i}=t["temporalUtil"];function Ki(e,t,r){if(!t&&!r)return e;var n,o,i=Object.create(Object.getPrototypeOf(e));for(const s in e)!0===Object.prototype.hasOwnProperty.call(e,s)&&(n=e[s],i[s]=Q(n)?(o=n,r?o.toBigInt():o.toNumberOrInfinity()):n);return Object.freeze(i),i}var Gi={...ki,createPoint2DTransformer:function(){return new L({signature:88,isTypeInstance:e=>zt(e)&&(null===e.z||void 0===e.z),toStructure:e=>new P(88,[c(e.srid),e.x,e.y]),fromStructure:e=>{N("Point2D",3,e.size);var[e,t,r]=e.fields;return new jt(e,t,r,void 0)}})},createPoint3DTransformer:function(){return new L({signature:89,isTypeInstance:e=>zt(e)&&null!==e.z&&void 0!==e.z,toStructure:e=>new P(89,[c(e.srid),e.x,e.y,e.z]),fromStructure:e=>{N("Point3D",4,e.size);var[e,t,r,n]=e.fields;return new jt(e,t,r,n)}})},createDurationTransformer:function(){return new L({signature:69,isTypeInstance:at,toStructure:e=>{var t=c(e.months),r=c(e.days),n=c(e.seconds),e=c(e.nanoseconds);return new P(69,[t,r,n,e])},fromStructure:e=>{N("Duration",4,e.size);var[e,t,r,n]=e.fields;return new st(e,t,r,n)}})},createLocalTimeTransformer:function({disableLosslessIntegers:t,useBigInt:r}){return new L({signature:116,isTypeInstance:lt,toStructure:e=>{e=$i(e.hour,e.minute,e.second,e.nanosecond);return new P(116,[e])},fromStructure:e=>{N("LocalTime",1,e.size);var[e]=e.fields;return Ki(zi(e),t,r)}})},createTimeTransformer:function({disableLosslessIntegers:r,useBigInt:n}){return new L({signature:84,isTypeInstance:ct,toStructure:e=>{var t=$i(e.hour,e.minute,e.second,e.nanosecond),e=c(e.timeZoneOffsetSeconds);return new P(84,[t,e])},fromStructure:e=>{N("Time",2,e.size);var[e,t]=e.fields,e=zi(e);return Ki(new ht(e.hour,e.minute,e.second,e.nanosecond,t),r,n)}})},createDateTransformer:function({disableLosslessIntegers:t,useBigInt:r}){return new L({signature:68,isTypeInstance:ft,toStructure:e=>{e=Wi(e.year,e.month,e.day);return new P(68,[e])},fromStructure:e=>{N("Date",1,e.size);var[e]=e.fields;return Ki(qi(e),t,r)}})},createLocalDateTimeTransformer:function({disableLosslessIntegers:r,useBigInt:n}){return new L({signature:100,isTypeInstance:mt,toStructure:e=>{var t=Vi(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),e=c(e.nanosecond);return new P(100,[t,e])},fromStructure:e=>{N("LocalDateTime",2,e.size);var[e,t]=e.fields;return Ki(Hi(e,t),r,n)}})},createDateTimeWithZoneIdTransformer:function({disableLosslessIntegers:n,useBigInt:o}){return new L({signature:102,isTypeInstance:e=>gt(e)&&null!=e.timeZoneId,toStructure:e=>{var t=Vi(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=c(e.nanosecond),e=e.timeZoneId;return new P(102,[t,r,e])},fromStructure:e=>{N("DateTimeWithZoneId",3,e.size);var[e,t,r]=e.fields,e=Hi(e,t);return Ki(new pt(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond,null,r),n,o)}})},createDateTimeWithOffsetTransformer:function({disableLosslessIntegers:n,useBigInt:o}){return new L({signature:70,isTypeInstance:e=>gt(e)&&null==e.timeZoneId,toStructure:e=>{var t=Vi(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=c(e.nanosecond),e=c(e.timeZoneOffsetSeconds);return new P(70,[t,r,e])},fromStructure:e=>{N("DateTimeWithZoneOffset",3,e.size);var[e,t,r]=e.fields,e=Hi(e,t);return Ki(new pt(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond,r,null),n,o)}})}};const Yi=t["constants"]["BOLT_PROTOCOL_V2"];class Zi extends Ai{_createPacker(e){return new fi.Packer(e)}_createUnpacker(e,t){return new fi.Unpacker(e,t)}get transformer(){return void 0===this._transformer&&(this._transformer=new U(Object.values(Gi).map(e=>e(this._config,this._log)))),this._transformer}get version(){return Yi}}var Xi={...Gi};const{bookmarks:{},constants:{BOLT_PROTOCOL_V3:Qi},txConfig:{TxConfig:Ji}}=t,es="context",ts=(es,new Qo);class rs extends Zi{get version(){return Qi}get transformer(){return void 0===this._transformer&&(this._transformer=new U(Object.values(Xi).map(e=>e(this._config,this._log)))),this._transformer}transformMetadata(e){return"t_first"in e&&(e.result_available_after=e.t_first,delete e.t_first),"t_last"in e&&(e.result_consumed_after=e.t_last,delete e.t_last),e}initialize({userAgent:e,authToken:t,notificationFilter:r,onError:n,onComplete:o}={}){var i=new k({onError:e=>this._onLoginError(e,n),onCompleted:e=>this._onLoginCompleted(e,t,o)});return S(r,this._onProtocolError,i),this.write(A.hello(e,t),i,!0),i}prepareToClose(){this.write(A.goodbye(),ts,!0)}beginTransaction({bookmarks:e,txConfig:t,database:r,impersonatedUser:n,notificationFilter:o,mode:i,beforeError:s,afterError:a,beforeComplete:u,afterComplete:l}={}){s=new I({server:this._server,beforeError:s,afterError:a,beforeComplete:u,afterComplete:l});return s.prepareToHandleSingleResponse(),ii(r,this._onProtocolError,s),si(n,this._onProtocolError,s),S(o,this._onProtocolError,s),this.write(A.begin({bookmarks:e,txConfig:t,mode:i}),s,!0),s}commitTransaction({beforeError:e,afterError:t,beforeComplete:r,afterComplete:n}={}){e=new I({server:this._server,beforeError:e,afterError:t,beforeComplete:r,afterComplete:n});return e.prepareToHandleSingleResponse(),this.write(A.commit(),e,!0),e}rollbackTransaction({beforeError:e,afterError:t,beforeComplete:r,afterComplete:n}={}){e=new I({server:this._server,beforeError:e,afterError:t,beforeComplete:r,afterComplete:n});return e.prepareToHandleSingleResponse(),this.write(A.rollback(),e,!0),e}run(e,t,{bookmarks:r,txConfig:n,database:o,impersonatedUser:i,notificationFilter:s,mode:a,beforeKeys:u,afterKeys:l,beforeError:h,afterError:c,beforeComplete:d,afterComplete:f,flush:_=!0,highRecordWatermark:m=Number.MAX_VALUE,lowRecordWatermark:p=Number.MAX_VALUE}={}){u=new I({server:this._server,beforeKeys:u,afterKeys:l,beforeError:h,afterError:c,beforeComplete:d,afterComplete:f,highRecordWatermark:m,lowRecordWatermark:p});return ii(o,this._onProtocolError,u),si(i,this._onProtocolError,u),S(s,this._onProtocolError,u),this.write(A.runWithMetadata(e,t,{bookmarks:r,txConfig:n,mode:a}),u,!1),this.write(A.pullAll(),u,_),u}requestRoutingInformation({routingContext:e={},sessionContext:t={},onError:r,onCompleted:n}){e=this.run("CALL dbms.cluster.routing.getRoutingTable($context)",{context:e},{...t,txConfig:Ji.empty()});return new ni({resultObserver:e,onProtocolError:this._onProtocolError,onError:r,onCompleted:n})}}var ns={...Xi};const{bookmarks:{},constants:{BOLT_PROTOCOL_V4_0:os,FETCH_ALL:is},txConfig:{TxConfig:ss}}=t,as="context",us="database";as,us;class ls extends rs{get version(){return os}get transformer(){return void 0===this._transformer&&(this._transformer=new U(Object.values(ns).map(e=>e(this._config,this._log)))),this._transformer}beginTransaction({bookmarks:e,txConfig:t,database:r,impersonatedUser:n,notificationFilter:o,mode:i,beforeError:s,afterError:a,beforeComplete:u,afterComplete:l}={}){s=new I({server:this._server,beforeError:s,afterError:a,beforeComplete:u,afterComplete:l});return s.prepareToHandleSingleResponse(),si(n,this._onProtocolError,s),S(o,this._onProtocolError,s),this.write(A.begin({bookmarks:e,txConfig:t,database:r,mode:i}),s,!0),s}run(e,t,{bookmarks:r,txConfig:n,database:o,impersonatedUser:i,notificationFilter:s,mode:a,beforeKeys:u,afterKeys:l,beforeError:h,afterError:c,beforeComplete:d,afterComplete:f,flush:_=!0,reactive:m=!1,fetchSize:p=is,highRecordWatermark:g=Number.MAX_VALUE,lowRecordWatermark:b=Number.MAX_VALUE}={}){u=new I({server:this._server,reactive:m,fetchSize:p,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:u,afterKeys:l,beforeError:h,afterError:c,beforeComplete:d,afterComplete:f,highRecordWatermark:g,lowRecordWatermark:b}),si(i,this._onProtocolError,u),S(s,this._onProtocolError,u),l=m;return this.write(A.runWithMetadata(e,t,{bookmarks:r,txConfig:n,database:o,mode:a}),u,l&&_),m||this.write(A.pull({n:p}),u,_),u}_requestMore(e,t,r){this.write(A.pull({stmtId:e,n:t}),r,!0)}_requestDiscard(e,t){this.write(A.discard({stmtId:e}),t,!0)}_noOp(){}requestRoutingInformation({routingContext:e={},databaseName:t=null,sessionContext:r={},onError:n,onCompleted:o}){e=this.run("CALL dbms.routing.getRoutingTable($context, $database)",{context:e,database:t},{...r,txConfig:ss.empty()});return new ni({resultObserver:e,onProtocolError:this._onProtocolError,onError:n,onCompleted:o})}}var hs={...ns};const cs=t["constants"]["BOLT_PROTOCOL_V4_1"];class ds extends ls{constructor(e,t,r,n=()=>null,o,i,s){super(e,t,r,n,o,i),this._serversideRouting=s}get version(){return cs}get transformer(){return void 0===this._transformer&&(this._transformer=new U(Object.values(hs).map(e=>e(this._config,this._log)))),this._transformer}initialize({userAgent:e,authToken:t,notificationFilter:r,onError:n,onComplete:o}={}){var i=new k({onError:e=>this._onLoginError(e,n),onCompleted:e=>this._onLoginCompleted(e,t,o)});return S(r,this._onProtocolError,i),this.write(A.hello(e,t,this._serversideRouting),i,!0),i}}var fs={...hs};const _s=t["constants"]["BOLT_PROTOCOL_V4_2"];class ms extends ds{get version(){return _s}get transformer(){return void 0===this._transformer&&(this._transformer=new U(Object.values(fs).map(e=>e(this._config,this._log)))),this._transformer}}var ps={...fs},gs={...ps};const bs=t["temporalUtil"]["localDateTimeToEpochSecond"];function ys(e,t,r){e=new Intl.DateTimeFormat("en-US",{timeZone:e,year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1,era:"narrow"}),r=c(t).multiply(1e3).add(c(r).div(1e6)).toNumber(),e=e.formatToParts(r).reduce((e,t)=>("era"===t.type?e.adjustEra="B"===t.value.toUpperCase()?e=>e.subtract(1).negate():ai:"hour"===t.type?e.hour=c(t.value).modulo(24):"literal"!==t.type&&(e[t.type]=c(t.value)),e),{}),e.year=e.adjustEra(e.year),r=bs(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond);return e.timeZoneOffsetSeconds=r.subtract(t),e.hour=e.hour.modulo(24),e}function vs(e,t,r){if(!t&&!r)return e;var n,o,i=Object.create(Object.getPrototypeOf(e));for(const s in e)!0===Object.prototype.hasOwnProperty.call(e,s)&&(n=e[s],i[s]=Q(n)?(o=n,r?o.toBigInt():o.toNumberOrInfinity()):n);return Object.freeze(i),i}var ws={createDateTimeWithZoneIdTransformer:function(e,s){const{disableLosslessIntegers:n,useBigInt:o}=e;return gs.createDateTimeWithZoneIdTransformer(e).extendsWith({signature:105,fromStructure:e=>{N("DateTimeWithZoneId",3,e.size);var[e,t,r]=e.fields,e=ys(r,e,t);return vs(new pt(e.year,e.month,e.day,e.hour,e.minute,e.second,c(t),e.timeZoneOffsetSeconds,r),n,o)},toStructure:e=>{var t=bs(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=null!=e.timeZoneOffsetSeconds?e.timeZoneOffsetSeconds:(n=e.timeZoneId,o=t,r=e.nanosecond,i=ys(n,o,r),i=(i=bs(i.year,i.month,i.day,i.hour,i.minute,i.second,r)).subtract(o),o=o.subtract(i),i=ys(n,o,r),n=bs(i.year,i.month,i.day,i.hour,i.minute,i.second,r),i=n.subtract(o)),n=(null==e.timeZoneOffsetSeconds&&s.warn('DateTime objects without "timeZoneOffsetSeconds" property are prune to bugs related to ambiguous times. For instance, 2022-10-30T2:30:00[Europe/Berlin] could be GMT+1 or GMT+2.'),t.subtract(r)),o=c(e.nanosecond),i=e.timeZoneId;return new P(105,[n,o,i])}})},createDateTimeWithOffsetTransformer:function(e){const{disableLosslessIntegers:n,useBigInt:o}=e;return gs.createDateTimeWithOffsetTransformer(e).extendsWith({signature:73,toStructure:e=>{var t=bs(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=c(e.nanosecond),e=c(e.timeZoneOffsetSeconds),t=t.subtract(e);return new P(73,[t,r,e])},fromStructure:e=>{N("DateTimeWithZoneOffset",3,e.size);var[e,t,r]=e.fields,e=Hi(c(e).add(r),t);return vs(new pt(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond,r,null),n,o)}})}};const{bookmarks:{Bookmarks:Es},constants:{BOLT_PROTOCOL_V4_3:Ts}}=t;class Cs extends ms{get version(){return Ts}get transformer(){return void 0===this._transformer&&(this._transformer=new U(Object.values(ps).map(e=>e(this._config,this._log)))),this._transformer}requestRoutingInformation({routingContext:e={},databaseName:t=null,sessionContext:r={},onError:n,onCompleted:o}){n=new oi({onProtocolError:this._onProtocolError,onError:n,onCompleted:o}),o=r.bookmarks||Es.empty();return this.write(A.route(e,o.values(),t),n,!0),n}initialize({userAgent:e,authToken:t,notificationFilter:r,onError:n,onComplete:o}={}){var i=new k({onError:e=>this._onLoginError(e,n),onCompleted:e=>(void 0!==e.patch_bolt&&this._applyPatches(e.patch_bolt),this._onLoginCompleted(e,t,o))});return S(r,this._onProtocolError,i),this.write(A.hello(e,t,this._serversideRouting,["utc"]),i,!0),i}_applyPatches(e){e.includes("utc")&&this._applyUtcPatch()}_applyUtcPatch(){this._transformer=new U(Object.values({...ps,...ws}).map(e=>e(this._config,this._log)))}}const{constants:{BOLT_PROTOCOL_V4_4:Os,FETCH_ALL:Is},bookmarks:{Bookmarks:ks}}=t;class Rs extends Cs{get version(){return Os}get transformer(){return void 0===this._transformer&&(this._transformer=new U(Object.values(gs).map(e=>e(this._config,this._log)))),this._transformer}requestRoutingInformation({routingContext:e={},databaseName:t=null,impersonatedUser:r=null,sessionContext:n={},onError:o,onCompleted:i}){o=new oi({onProtocolError:this._onProtocolError,onError:o,onCompleted:i}),i=n.bookmarks||ks.empty();return this.write(A.routeV4x4(e,i.values(),{databaseName:t,impersonatedUser:r}),o,!0),o}run(e,t,{bookmarks:r,txConfig:n,database:o,mode:i,impersonatedUser:s,notificationFilter:a,beforeKeys:u,afterKeys:l,beforeError:h,afterError:c,beforeComplete:d,afterComplete:f,flush:_=!0,reactive:m=!1,fetchSize:p=Is,highRecordWatermark:g=Number.MAX_VALUE,lowRecordWatermark:b=Number.MAX_VALUE}={}){u=new I({server:this._server,reactive:m,fetchSize:p,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:u,afterKeys:l,beforeError:h,afterError:c,beforeComplete:d,afterComplete:f,highRecordWatermark:g,lowRecordWatermark:b}),S(a,this._onProtocolError,u),l=m;return this.write(A.runWithMetadata(e,t,{bookmarks:r,txConfig:n,database:o,mode:i,impersonatedUser:s}),u,l&&_),m||this.write(A.pull({n:p}),u,_),u}beginTransaction({bookmarks:e,txConfig:t,database:r,mode:n,impersonatedUser:o,notificationFilter:i,beforeError:s,afterError:a,beforeComplete:u,afterComplete:l}={}){s=new I({server:this._server,beforeError:s,afterError:a,beforeComplete:u,afterComplete:l});return s.prepareToHandleSingleResponse(),S(i,this._onProtocolError,s),this.write(A.begin({bookmarks:e,txConfig:t,database:r,mode:n,impersonatedUser:o}),s,!0),s}_applyUtcPatch(){this._transformer=new U(Object.values({...gs,...ws}).map(e=>e(this._config,this._log)))}}var Ss={...gs,...ws,createNodeTransformer:function(e){return gs.createNodeTransformer(e).extendsWith({fromStructure:e=>{N("Node",4,e.size);var[e,t,r,n]=e.fields;return new kt(e,t,r,n)}})},createRelationshipTransformer:function(e){return gs.createRelationshipTransformer(e).extendsWith({fromStructure:e=>{N("Relationship",8,e.size);var[e,t,r,n,o,i,s,a]=e.fields;return new St(e,t,r,n,o,i,s,a)}})},createUnboundRelationshipTransformer:function(e){return gs.createUnboundRelationshipTransformer(e).extendsWith({fromStructure:e=>{N("UnboundRelationship",4,e.size);var[e,t,r,n]=e.fields;return new Nt(e,t,r,n)}})}};const Ps=t["constants"]["BOLT_PROTOCOL_V5_0"];class Ns extends Rs{get version(){return Ps}get transformer(){return void 0===this._transformer&&(this._transformer=new U(Object.values(Ss).map(e=>e(this._config,this._log)))),this._transformer}initialize({userAgent:e,authToken:t,notificationFilter:r,onError:n,onComplete:o}={}){var i=new k({onError:e=>this._onLoginError(e,n),onCompleted:e=>this._onLoginCompleted(e,t,o)});return S(r,this._onProtocolError,i),this.write(A.hello(e,t,this._serversideRouting),i,!0),i}}var As={...Ss};const Us=t["constants"]["BOLT_PROTOCOL_V5_1"];class Ls extends Ns{get version(){return Us}get transformer(){return void 0===this._transformer&&(this._transformer=new U(Object.values(As).map(e=>e(this._config,this._log)))),this._transformer}get supportsReAuth(){return!0}initialize({userAgent:e,authToken:t,notificationFilter:r,onError:n,onComplete:o}={}){const i={};var s=new k({onError:e=>this._onLoginError(e,n),onCompleted:e=>(i.metadata=e,this._onLoginCompleted(e))});return S(r,this._onProtocolError,s),this.write(A.hello5x1(e,this._serversideRouting),s,!1),this.logon({authToken:t,onComplete:e=>o({...e,...i.metadata}),onError:n,flush:!0})}logon({authToken:e,onComplete:t,onError:r,flush:n}={}){var o=new k({onCompleted:()=>this._onLoginCompleted(null,e,t),onError:e=>this._onLoginError(e,r)});return this.write(A.logon(e),o,n),o}logoff({onComplete:e,onError:t,flush:r}={}){e=new Jo({onCompleted:e,onError:t});return this.write(A.logoff(),e,r),e}}var Ds={...As};const{BOLT_PROTOCOL_V5_2:Bs,FETCH_ALL:xs}=t["constants"];class Ms extends Ls{get version(){return Bs}get transformer(){return void 0===this._transformer&&(this._transformer=new U(Object.values(Ds).map(e=>e(this._config,this._log)))),this._transformer}get supportsReAuth(){return!0}initialize({userAgent:e,authToken:t,notificationFilter:r,onError:n,onComplete:o}={}){const i={};var s=new k({onError:e=>this._onLoginError(e,n),onCompleted:e=>(i.metadata=e,this._onLoginCompleted(e))});return this.write(A.hello5x2(e,r,this._serversideRouting),s,!1),this.logon({authToken:t,onComplete:e=>o({...e,...i.metadata}),onError:n,flush:!0})}beginTransaction({bookmarks:e,txConfig:t,database:r,mode:n,impersonatedUser:o,notificationFilter:i,beforeError:s,afterError:a,beforeComplete:u,afterComplete:l}={}){s=new I({server:this._server,beforeError:s,afterError:a,beforeComplete:u,afterComplete:l});return s.prepareToHandleSingleResponse(),this.write(A.begin({bookmarks:e,txConfig:t,database:r,mode:n,impersonatedUser:o,notificationFilter:i}),s,!0),s}run(e,t,{bookmarks:r,txConfig:n,database:o,mode:i,impersonatedUser:s,notificationFilter:a,beforeKeys:u,afterKeys:l,beforeError:h,afterError:c,beforeComplete:d,afterComplete:f,flush:_=!0,reactive:m=!1,fetchSize:p=xs,highRecordWatermark:g=Number.MAX_VALUE,lowRecordWatermark:b=Number.MAX_VALUE}={}){u=new I({server:this._server,reactive:m,fetchSize:p,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:u,afterKeys:l,beforeError:h,afterError:c,beforeComplete:d,afterComplete:f,highRecordWatermark:g,lowRecordWatermark:b}),l=m;return this.write(A.runWithMetadata(e,t,{bookmarks:r,txConfig:n,database:o,mode:i,impersonatedUser:s,notificationFilter:a}),u,l&&_),m||this.write(A.pull({n:p}),u,_),u}}var Fs={...Ds};const js=t["constants"]["BOLT_PROTOCOL_V5_3"];class qs extends Ms{get version(){return js}get transformer(){return void 0===this._transformer&&(this._transformer=new U(Object.values(Fs).map(e=>e(this._config,this._log)))),this._transformer}initialize({userAgent:e,boltAgent:t,authToken:r,notificationFilter:n,onError:o,onComplete:i}={}){const s={};var a=new k({onError:e=>this._onLoginError(e,o),onCompleted:e=>(s.metadata=e,this._onLoginCompleted(e))});return this.write(A.hello5x3(e,t,n,this._serversideRouting),a,!1),this.logon({authToken:r,onComplete:e=>i({...e,...s.metadata}),onError:o,flush:!0})}}var zs={...Fs};const Hs=t["constants"]["BOLT_PROTOCOL_V5_4"];class Ws extends qs{get version(){return Hs}get transformer(){return void 0===this._transformer&&(this._transformer=new U(Object.values(zs).map(e=>e(this._config,this._log)))),this._transformer}telemetry({api:e},{onError:t,onCompleted:r}={}){r=new ti({onCompleted:r,onError:t});return this.write(A.telemetry({api:e}),r,!1),r}}function Vs(){}function $s(e){return e}const Ks={onNext:Vs,onCompleted:Vs,onError:Vs};class Gs{constructor({transformMetadata:e,log:t,observer:r}={}){this._pendingObservers=[],this._log=t,this._transformMetadata=e||$s,this._observer=Object.assign({onObserversCountChange:Vs,onError:Vs,onFailure:Vs,onErrorApplyTransformation:$s},r)}get currentFailure(){return this._currentFailure}handleResponse(e){var t=e.fields[0];switch(e.signature){case 113:this._log.isDebugEnabled()&&this._log.debug("S: RECORD "+f(e)),this._currentObserver.onNext(t);break;case 112:this._log.isDebugEnabled()&&this._log.debug("S: SUCCESS "+f(e));try{var r=this._transformMetadata(t);this._currentObserver.onCompleted(r)}finally{this._updateCurrentObserver()}break;case 127:this._log.isDebugEnabled()&&this._log.debug("S: FAILURE "+f(e));try{var n=function(e){{if("Neo.TransientError.Transaction.Terminated"===e)return"Neo.ClientError.Transaction.Terminated";if("Neo.TransientError.Transaction.LockClientStopped"===e)return"Neo.ClientError.Transaction.LockClientStopped"}return e}(t.code),o=b(t.message,n);this._currentFailure=this._observer.onErrorApplyTransformation(o),this._currentObserver.onError(this._currentFailure)}finally{this._updateCurrentObserver(),this._observer.onFailure(this._currentFailure)}break;case 126:this._log.isDebugEnabled()&&this._log.debug("S: IGNORED "+f(e));try{this._currentFailure&&this._currentObserver.onError?this._currentObserver.onError(this._currentFailure):this._currentObserver.onError&&this._currentObserver.onError(b("Ignored either because of an error or RESET"))}finally{this._updateCurrentObserver()}break;default:this._observer.onError(b("Unknown Bolt protocol message: "+e))}}_updateCurrentObserver(){this._currentObserver=this._pendingObservers.shift(),this._observer.onObserversCountChange(this._observersCount)}get _observersCount(){return null==this._currentObserver?this._pendingObservers.length:this._pendingObservers.length+1}_queueObserver(e){return(e=e||Ks).onCompleted=e.onCompleted||Vs,e.onError=e.onError||Vs,e.onNext=e.onNext||Vs,void 0===this._currentObserver?this._currentObserver=e:this._pendingObservers.push(e),this._observer.onObserversCountChange(this._observersCount),!0}_notifyErrorToObservers(e){for(this._currentObserver&&this._currentObserver.onError&&this._currentObserver.onError(e);0<this._pendingObservers.length;){var t=this._pendingObservers.shift();t&&t.onError&&t.onError(e)}}hasOngoingObservableRequests(){return null!=this._currentObserver||0<this._pendingObservers.length}_resetFailure(){this._currentFailure=null}}var qr=Cs,Wr=$o,Ys={handshake:function(t,o){return new Promise((r,n)=>{var e=e=>{n(e)};t.onerror=e.bind(this),t._error&&e(t._error),t.onmessage=t=>{try{var e=function(e,t){if(72===(e=[e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8()])[0]&&84===e[1]&&84===e[2]&&80===e[3])throw t.error("Handshake failed since server responded with HTTP."),b("Server responded HTTP. Make sure you are not trying to connect to the http endpoint (HTTP defaults to port 7474 whereas BOLT defaults to port 7687)");return Number(e[3]+"."+e[2])}(t,o);r({protocolVersion:e,consumeRemainingBuffer:e=>{t.hasRemaining()&&e(t.readSlice(t.remaining()))}})}catch(e){n(e)}},t.write(Vo())})},create:function({version:e,chunker:t,dechunker:n,channel:o,disableLosslessIntegers:r,useBigInt:i,serversideRouting:s,server:a,log:u,observer:l}={}){var h=e,c=a,d=t,f={disableLosslessIntegers:r,useBigInt:i},_=s,m=t=>{const r=new Gs({transformMetadata:t.transformMetadata.bind(t),log:u,observer:l});return o.onerror=l.onError.bind(l),o.onmessage=e=>n.write(e),n.onmessage=e=>{try{r.handleResponse(t.unpack(e))}catch(e){return l.onError(e)}},r},p=l.onProtocolError.bind(l),g=u;switch(h){case 1:return new Ai(c,d,f,m,g,p);case 2:return new Zi(c,d,f,m,g,p);case 3:return new rs(c,d,f,m,g,p);case 4:return new ls(c,d,f,m,g,p);case 4.1:return new ds(c,d,f,m,g,p,_);case 4.2:return new ms(c,d,f,m,g,p,_);case 4.3:return new Cs(c,d,f,m,g,p,_);case 4.4:return new Rs(c,d,f,m,g,p,_);case 5:return new Ns(c,d,f,m,g,p,_);case 5.1:return new Ls(c,d,f,m,g,p,_);case 5.2:return new Ms(c,d,f,m,g,p,_);case 5.3:return new qs(c,d,f,m,g,p,_);case 5.4:return new Ws(c,d,f,m,g,p,_);default:throw b("Unknown Bolt protocol version: "+h)}}},ie=Object.freeze({__proto__:null,BoltProtocol:qr,RawRoutingTable:Wr,default:Ys,StreamObserver:Qo,ResultStreamObserver:I,LoginObserver:k,LogoffObserver:Jo,ResetObserver:ei,FailedObserver:class extends I{constructor({error:e,onError:t}){super({beforeError:t}),this.onError(e)}},CompletedObserver:ri,RouteObserver:oi,ProcedureRouteObserver:ni,TelemetryObserver:ti});class Zs{constructor(e,t){this.maxSize=Xs(e,100),this.acquisitionTimeout=Xs(t,6e4)}static defaultConfig(){return new Zs(100,6e4)}static fromDriverConfig(e){var t=Qs(e.maxConnectionPoolSize)?e.maxConnectionPoolSize:100,e=Qs(e.connectionAcquisitionTimeout)?e.connectionAcquisitionTimeout:6e4;return new Zs(t,e)}}function Xs(e,t){return 0===e||e?e:t}function Qs(e){return 0===e||e}const Js=t["logger"]["Logger"];class ea{constructor({create:e=(e,t,r)=>Promise.resolve(),destroy:t=e=>Promise.resolve(),validateOnAcquire:r=(e,t)=>!0,validateOnRelease:n=e=>!0,installIdleObserver:o=(e,t)=>{},removeIdleObserver:i=e=>{},config:s=Zs.defaultConfig(),log:a=Js.noOp()}={}){this._create=e,this._destroy=t,this._validateOnAcquire=r,this._validateOnRelease=n,this._installIdleObserver=o,this._removeIdleObserver=i,this._maxSize=s.maxSize,this._acquisitionTimeout=s.acquisitionTimeout,this._pools={},this._pendingCreates={},this._acquireRequests={},this._activeResourceCounts={},this._release=this._release.bind(this),this._log=a,this._closed=!1}acquire(o,i,s){const a=i.asKey(),u=this._acquireRequests;return u[a]||(u[a]=[]),new Promise((e,t)=>{let r=null;var n=setTimeout(()=>{var e,t=u[a];t&&(u[a]=t.filter(e=>e!==r)),r.isCompleted()||(t=this.activeResourceCount(i),e=this.has(i)?this._pools[a].length:0,r.reject(b(`Connection acquisition timed out in ${this._acquisitionTimeout} ms. Pool status: Active conn count = ${t}, Idle conn count = ${e}.`)))},this._acquisitionTimeout);r=new ra(a,o,s,e,t,n,this._log),u[a].push(r),this._processPendingAcquireRequests(i)})}purge(e){return this._purgeKey(e.asKey())}apply(e,t){e=e.asKey();e in this._pools&&this._pools[e].apply(t)}async close(){return this._closed=!0,Promise.all(Object.keys(this._pools).map(e=>this._purgeKey(e)))}keepAll(e){const t=e.map(e=>e.asKey());e=Object.keys(this._pools).filter(e=>-1===t.indexOf(e));return Promise.all(e.map(e=>this._purgeKey(e)))}has(e){return e.asKey()in this._pools}activeResourceCount(e){return this._activeResourceCounts[e.asKey()]||0}_getOrInitializePoolFor(e){let t=this._pools[e];return t||(t=new na,this._pools[e]=t,this._pendingCreates[e]=0),t}async _acquire(e,t,r){if(this._closed)throw b("Pool is closed, it is no more able to serve requests.");var n=t.asKey();const o=this._getOrInitializePoolFor(n);if(!r)for(;o.length;){const i=o.pop();if(this._removeIdleObserver&&this._removeIdleObserver(i),await this._validateOnAcquire(e,i))return ta(n,this._activeResourceCounts),this._log.isDebugEnabled()&&this._log.debug(i+" acquired from the pool "+n),{resource:i,pool:o};o.removeInUse(i),await this._destroy(i)}if(0<this._maxSize&&this.activeResourceCount(t)+this._pendingCreates[n]>=this._maxSize)return{resource:null,pool:o};this._pendingCreates[n]=this._pendingCreates[n]+1;let i;try{if(this.activeResourceCount(t)+o.length>=this._maxSize&&r){const i=o.pop();this._removeIdleObserver&&this._removeIdleObserver(i),o.removeInUse(i),await this._destroy(i)}i=await this._create(e,t,(e,t)=>this._release(e,t,o)),o.pushInUse(i),ta(n,this._activeResourceCounts),this._log.isDebugEnabled()&&this._log.debug(i+" created for the pool "+n)}finally{this._pendingCreates[n]=this._pendingCreates[n]-1}return{resource:i,pool:o}}async _release(e,t,r){const n=e.asKey();try{r.isActive()?await this._validateOnRelease(t)?(this._installIdleObserver&&this._installIdleObserver(t,{onError:e=>{this._log.debug(`Idle connection ${t} destroyed because of error: `+e);e=this._pools[n];e&&(this._pools[n]=e.filter(e=>e!==t),e.removeInUse(t)),this._destroy(t).catch(()=>{})}}),r.push(t),this._log.isDebugEnabled()&&this._log.debug(t+" released to the pool "+n)):(this._log.isDebugEnabled()&&this._log.debug(`${t} destroyed and can't be released to the pool ${n} because it is not functional`),r.removeInUse(t),await this._destroy(t)):(this._log.isDebugEnabled()&&this._log.debug(`${t} destroyed and can't be released to the pool ${n} because pool has been purged`),r.removeInUse(t),await this._destroy(t))}finally{r=n,o=this._activeResourceCounts,i=o[r]||0,0<(i-=1)?o[r]=i:delete o[r],this._processPendingAcquireRequests(e)}var o,i}async _purgeKey(e){var t=this._pools[e],r=[];if(t){for(;t.length;){var n=t.pop();this._removeIdleObserver&&this._removeIdleObserver(n),r.push(this._destroy(n))}t.close(),delete this._pools[e],await Promise.all(r)}}_processPendingAcquireRequests(r){const n=r.asKey();var e=this._acquireRequests[n];if(e){const o=e.shift();o?this._acquire(o.context,r,o.requireNew).catch(e=>(o.reject(e),{resource:null})).then(({resource:e,pool:t})=>{e?o.isCompleted()?this._release(r,e,t):o.resolve(e):o.isCompleted()||(this._acquireRequests[n]||(this._acquireRequests[n]=[]),this._acquireRequests[n].unshift(o))}):delete this._acquireRequests[n]}}}function ta(e,t){var r=t[e]||0;t[e]=r+1}class ra{constructor(e,t,r,n,o,i,s){this._key=e,this._context=t,this._resolve=n,this._reject=o,this._timeoutId=i,this._log=s,this._completed=!1,this._config=r||{}}get context(){return this._context}get requireNew(){return this._config.requireNew||!1}isCompleted(){return this._completed}resolve(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._log.isDebugEnabled()&&this._log.debug(e+" acquired from the pool "+this._key),this._resolve(e))}reject(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._reject(e))}}class na{constructor(){this._active=!0,this._elements=[],this._elementsInUse=new Set}isActive(){return this._active}close(){this._active=!1,this._elements=[],this._elementsInUse=new Set}filter(e){return this._elements=this._elements.filter(e),this}apply(e){this._elements.forEach(e),this._elementsInUse.forEach(e)}get length(){return this._elements.length}pop(){var e=this._elements.pop();return this._elementsInUse.add(e),e}push(e){return this._elementsInUse.delete(e),this._elements.push(e)}pushInUse(e){this._elementsInUse.add(e)}removeInUse(e){this._elementsInUse.delete(e)}}ur=Object.freeze({__proto__:null,default:ea,Pool:ea,PoolConfig:Zs,DEFAULT_ACQUISITION_TIMEOUT:6e4,DEFAULT_MAX_SIZE:100});class oa extends Xr{constructor(e){super(),this._connection=e}acquireConnection({}={}){var e=this._connection;return this._connection=null,Promise.resolve(e)}}class ia extends Qr{constructor(e){super(),this._errorHandler=e}get id(){throw new Error("not implemented")}get databaseId(){throw new Error("not implemented")}set databaseId(e){throw new Error("not implemented")}get authToken(){throw new Error("not implemented")}set authToken(e){throw new Error("not implemented")}get supportsReAuth(){throw new Error("not implemented")}get creationTimestamp(){throw new Error("not implemented")}set idleTimestamp(e){throw new Error("not implemented")}get idleTimestamp(){throw new Error("not implemented")}protocol(){throw new Error("not implemented")}get address(){throw new Error("not implemented")}get version(){throw new Error("not implemented")}set version(e){throw new Error("not implemented")}get server(){throw new Error("not implemented")}connect(e,t,r,n){throw new Error("not implemented")}write(e,t,r){throw new Error("not implemented")}close(){throw new Error("not implemented")}handleAndTransformError(e,t){return this._errorHandler?this._errorHandler.handleAndTransformError(e,t,this):e}}const sa=s["PROTOCOL_ERROR"],aa=t["logger"]["Logger"];let ua=0;function la(i,s,a,u,l=null,e=e=>new go(e)){const h=e(new Oo(i,s,a.errorCode()));return Ys.handshake(h,u).then(({protocolVersion:e,consumeRemainingBuffer:t})=>{const r=new vo(h),n=new wo;var o=new ha(h,a,i,u,s.disableLosslessIntegers,l,r,s.notificationFilter,t=>Ys.create({version:e,channel:h,chunker:r,dechunker:n,disableLosslessIntegers:s.disableLosslessIntegers,useBigInt:s.useBigInt,serversideRouting:l,server:t.server,log:t.logger,observer:{onObserversCountChange:t._handleOngoingRequestsNumberChange.bind(t),onError:t._handleFatalError.bind(t),onFailure:t._resetOnFailure.bind(t),onProtocolError:t._handleProtocolError.bind(t),onErrorApplyTransformation:e=>t.handleAndTransformError(e,t._address)}}),s.telemetryDisabled);return t(e=>n.write(e)),o}).catch(e=>h.close().then(()=>{throw e}))}class ha extends ia{constructor(e,t,r,n,o=!1,i=null,s,a,u,l){var h,c;super(t),this._authToken=null,this._idle=!1,this._reseting=!1,this._resetObservers=[],this._id=ua++,this._address=r,this._server={address:r.asHostPort()},this._creationTimestamp=Date.now(),this._disableLosslessIntegers=o,this._ch=e,this._chunker=s,this._log=(h=this,c=n,new aa(c._level,(e,t)=>c._loggerFunction(e,h+" "+t))),this._serversideRouting=i,this._notificationFilter=a,this._telemetryDisabledDriverConfig=!0===l,this._telemetryDisabledConnection=!0,this._dbConnectionId=null,this._protocol=u(this),this._isBroken=!1,this._log.isDebugEnabled()&&this._log.debug("created towards "+r)}beginTransaction(e){return this._sendTelemetryIfEnabled(e),this._protocol.beginTransaction(e)}run(e,t,r){return this._sendTelemetryIfEnabled(r),this._protocol.run(e,t,r)}_sendTelemetryIfEnabled(e){this._telemetryDisabledConnection||this._telemetryDisabledDriverConfig||null==e||null==e.apiTelemetryConfig||this._protocol.telemetry({api:e.apiTelemetryConfig.api},{onCompleted:e.apiTelemetryConfig.onTelemetrySuccess,onError:e.beforeError})}commitTransaction(e){return this._protocol.commitTransaction(e)}rollbackTransaction(e){return this._protocol.rollbackTransaction(e)}getProtocolVersion(){return this._protocol.version}get authToken(){return this._authToken}set authToken(e){this._authToken=e}get supportsReAuth(){return this._protocol.supportsReAuth}get id(){return this._id}get databaseId(){return this._dbConnectionId}set databaseId(e){this._dbConnectionId=e}set idleTimestamp(e){this._idleTimestamp=e}get idleTimestamp(){return this._idleTimestamp}get creationTimestamp(){return this._creationTimestamp}async connect(e,t,r,n){if(this._protocol.initialized&&!this._protocol.supportsReAuth)throw b("Connection does not support re-auth");return this._authToken=r,this._protocol.initialized?n?new Promise((e,t)=>{this._protocol.logoff({onError:t}),this._protocol.logon({authToken:r,onError:t,onComplete:()=>e(this),flush:!0})}):(this._protocol.logoff(),this._protocol.logon({authToken:r,flush:!0}),this):this._initialize(e,t,r)}_initialize(e,n,o){const i=this;return new Promise((r,t)=>{this._protocol.initialize({userAgent:e,boltAgent:n,authToken:o,notificationFilter:this._notificationFilter,onError:e=>t(e),onComplete:e=>{var t;e&&(t=e.server,this.version&&!t||(this.version=t),t=e.connection_id,this.databaseId||(this.databaseId=t),e.hints)&&(null!=(t=e.hints["connection.recv_timeout_seconds"])&&(t=J(t),Number.isInteger(t)&&0<t?this._ch.setupReceiveTimeout(1e3*t):this._log.info(`Server located at ${this._address} supplied an invalid connection receive timeout value (${t}). `+"Please, verify the server configuration and status because this can be the symptom of a bigger issue.")),!0===e.hints["telemetry.enabled"])&&(this._telemetryDisabledConnection=!1),r(i)}})})}protocol(){return this._protocol}get address(){return this._address}get version(){return this._server.version}set version(e){this._server.version=e}get server(){return this._server}get logger(){return this._log}_handleFatalError(e){this._isBroken=!0,this._error=this.handleAndTransformError(this._protocol.currentFailure||e,this._address),this._log.isErrorEnabled()&&this._log.error(`experienced a fatal error caused by ${this._error} (${f(this._error)})`),this._protocol.notifyFatalError(this._error)}_setIdle(e){this._idle=!0,this._ch.stopReceiveTimeout(),this._protocol.queueObserverIfProtocolIsNotBroken(e)}_unsetIdle(){this._idle=!1,this._updateCurrentObserver()}_queueObserver(e){return this._protocol.queueObserverIfProtocolIsNotBroken(e)}hasOngoingObservableRequests(){return!this._idle&&this._protocol.hasOngoingObservableRequests()}resetAndFlush(){return new Promise((e,t)=>{this._reset({onError:e=>{this._isBroken?t(e):(e=this._handleProtocolError("Received FAILURE as a response for RESET: "+e),t(e))},onComplete:()=>{e()}})})}_resetOnFailure(){this.isOpen()&&this._reset({onError:()=>{this._protocol.resetFailure()},onComplete:()=>{this._protocol.resetFailure()}})}_reset(t){if(this._reseting)this._protocol.isLastMessageReset()?this._resetObservers.push(t):this._protocol.reset({onError:e=>{t.onError(e)},onComplete:()=>{t.onComplete()}});else{this._resetObservers.push(t),this._reseting=!0;const e=e=>{this._reseting=!1;var t=this._resetObservers;this._resetObservers=[],t.forEach(e)};this._protocol.reset({onError:t=>{e(e=>e.onError(t))},onComplete:()=>{e(e=>e.onComplete())}})}}_updateCurrentObserver(){this._protocol.updateCurrentObserver()}isOpen(){return!this._isBroken&&this._ch._open}_handleOngoingRequestsNumberChange(e){this._idle||(0===e?this._ch.stopReceiveTimeout():this._ch.startReceiveTimeout())}async close(){this._log.isDebugEnabled()&&this._log.debug("closing"),this._protocol&&this.isOpen()&&this._protocol.prepareToClose(),await this._ch.close(),this._log.isDebugEnabled()&&this._log.debug("closed")}toString(){return`Connection [${this.id}][${this.databaseId||""}]`}_handleProtocolError(e){this._protocol.resetFailure(),this._updateCurrentObserver();e=b(e,sa);return this._handleFatalError(e),e}}class ca extends ia{constructor(e,t){super(t),t&&(this._originalErrorHandler=e._errorHandler,e._errorHandler=this._errorHandler),this._delegate=e}beginTransaction(e){return this._delegate.beginTransaction(e)}run(e,t,r){return this._delegate.run(e,t,r)}commitTransaction(e){return this._delegate.commitTransaction(e)}rollbackTransaction(e){return this._delegate.rollbackTransaction(e)}getProtocolVersion(){return this._delegate.getProtocolVersion()}get id(){return this._delegate.id}get databaseId(){return this._delegate.databaseId}set databaseId(e){this._delegate.databaseId=e}get server(){return this._delegate.server}get authToken(){return this._delegate.authToken}get supportsReAuth(){return this._delegate.supportsReAuth}set authToken(e){this._delegate.authToken=e}get address(){return this._delegate.address}get version(){return this._delegate.version}set version(e){this._delegate.version=e}get creationTimestamp(){return this._delegate.creationTimestamp}set idleTimestamp(e){this._delegate.idleTimestamp=e}get idleTimestamp(){return this._delegate.idleTimestamp}isOpen(){return this._delegate.isOpen()}protocol(){return this._delegate.protocol()}connect(e,t,r,n){return this._delegate.connect(e,t,r,n)}write(e,t,r){return this._delegate.write(e,t,r)}resetAndFlush(){return this._delegate.resetAndFlush()}hasOngoingObservableRequests(){return this._delegate.hasOngoingObservableRequests()}close(){return this._delegate.close()}release(){return this._originalErrorHandler&&(this._delegate._errorHandler=this._originalErrorHandler),this._delegate.release()}}const{SERVICE_UNAVAILABLE:da,SESSION_EXPIRED:fa}=s;class _a{constructor(e,t,r,n){this._errorCode=e,this._handleUnavailability=t||ma,this._handleWriteFailure=r||ma,this._handleSecurityError=n||ma}static create({errorCode:e,handleUnavailability:t,handleWriteFailure:r,handleSecurityError:n}){return new _a(e,t,r,n)}errorCode(){return this._errorCode}handleAndTransformError(e,t,r){var n;return null!=(n=e)&&null!=n.code&&n.code.startsWith("Neo.ClientError.Security.")?this._handleSecurityError(e,t,r):function(e){if(e)return e.code===fa||e.code===da||"Neo.TransientError.General.DatabaseUnavailable"===e.code;return}(e)?this._handleUnavailability(e,t,r):function(e){if(e)return"Neo.ClientError.Cluster.NotALeader"===e.code||"Neo.ClientError.General.ForbiddenOnReadOnlyDatabase"===e.code;return}(e)?this._handleWriteFailure(e,t,r):e}}function ma(e){return e}class pa{constructor({authTokenManager:e,userAgent:t,boltAgent:r}){this._authTokenManager=e||bn({}),this._userAgent=t,this._boltAgent=r}async authenticate({connection:e,auth:t,skipReAuth:r,waitReAuth:n,forceReAuth:o}){return null!=t?(r=!0===e.supportsReAuth&&(!ui(e.authToken,t)&&!0!==r||!0===o),null==e.authToken||r?e.connect(this._userAgent,this._boltAgent,t,n||!1):e):ui(o=await this._authTokenManager.getToken(),e.authToken)?e:e.connect(this._userAgent,this._boltAgent,o,!1)}handleError({connection:e,code:t}){return!(!e||!t.startsWith("Neo.ClientError.Security."))&&this._authTokenManager.handleSecurityException(e.authToken,t)}}class ga{constructor({connectionLivenessCheckTimeout:e}){this._connectionLivenessCheckTimeout=e}async check(e){var t;return!(!this._isCheckDisabled&&!this._isNewlyCreatedConnection(e)&&(t=Date.now()-e.idleTimestamp,0===this._connectionLivenessCheckTimeout||t>this._connectionLivenessCheckTimeout))||e.resetAndFlush().then(()=>!0)}get _isCheckDisabled(){return null==this._connectionLivenessCheckTimeout||this._connectionLivenessCheckTimeout<0}_isNewlyCreatedConnection(e){return null==e.authToken}}const ba=s["SERVICE_UNAVAILABLE"],ya=["Neo.ClientError.Security.CredentialsExpired","Neo.ClientError.Security.Forbidden","Neo.ClientError.Security.TokenExpired","Neo.ClientError.Security.Unauthorized"];class va extends Xr{constructor({id:e,config:t,log:r,userAgent:n,boltAgent:o,authTokenManager:i,newPool:s=(...e)=>new ea(...e)},a=null){super(),this._id=e,this._config=t,this._log=r,this._authenticationProvider=new pa({authTokenManager:i,userAgent:n,boltAgent:o}),this._livenessCheckProvider=new ga({connectionLivenessCheckTimeout:t.connectionLivenessCheckTimeout}),this._userAgent=n,this._boltAgent=o,this._createChannelConnection=a||(e=>la(e,this._config,this._createConnectionErrorHandler(),this._log)),this._connectionPool=s({create:this._createConnection.bind(this),destroy:this._destroyConnection.bind(this),validateOnAcquire:this._validateConnectionOnAcquire.bind(this),validateOnRelease:this._validateConnectionOnRelease.bind(this),installIdleObserver:va._installIdleObserverOnConnection.bind(this),removeIdleObserver:va._removeIdleObserverOnConnection.bind(this),config:Zs.fromDriverConfig(t),log:this._log}),this._openConnections={}}_createConnectionErrorHandler(){return new _a(ba)}_createConnection({auth:e},r,n){return this._createChannelConnection(r).then(t=>(t.release=()=>(t.idleTimestamp=Date.now(),n(r,t)),this._openConnections[t.id]=t,this._authenticationProvider.authenticate({connection:t,auth:e}).catch(e=>{throw this._destroyConnection(t),e})))}async _validateConnectionOnAcquire({auth:e,skipReAuth:t},r){if(!this._validateConnection(r))return!1;try{await this._livenessCheckProvider.check(r)}catch(e){return this._log.debug(`The connection ${r.id} is not alive because of an error ${e.code} '${e.message}'`),!1}try{return await this._authenticationProvider.authenticate({connection:r,auth:e,skipReAuth:t}),!0}catch(e){return this._log.debug(`The connection ${r.id} is not valid because of an error ${e.code} '${e.message}'`),!1}}_validateConnectionOnRelease(e){return!0!==e._sticky&&this._validateConnection(e)}_validateConnection(e){return!(!e.isOpen()||this._config.maxConnectionLifetime<Date.now()-e.creationTimestamp)}_destroyConnection(e){return delete this._openConnections[e.id],e.close()}async _verifyConnectivityAndGetServerVersion({address:e}){var e=await this._connectionPool.acquire({},e),t=new Jt(e.server,e.protocol().version);try{e.protocol().isLastMessageLogon()||await e.resetAndFlush()}finally{await e.release()}return t}async _verifyAuthentication({getAddress:e,auth:t}){var r=[];try{var n,o=await e(),i=await this._connectionPool.acquire({auth:t,skipReAuth:!0},o),s=(r.push(i),!i.protocol().isLastMessageLogon());if(i.supportsReAuth)return s&&i.supportsReAuth?await this._authenticationProvider.authenticate({connection:i,auth:t,waitReAuth:!0,forceReAuth:!0}):s&&!i.supportsReAuth&&((n=await this._connectionPool.acquire({auth:t},o,{requireNew:!0}))._sticky=!0,r.push(n)),!0;throw b("Driver is connected to a database that does not support user switch.")}catch(e){if(ya.includes(e.code))return!1;throw e}finally{await Promise.all(r.map(e=>e.release()))}}async _verifyStickyConnection({auth:e,connection:t}){var e=ui(e,t.authToken),r=!e;if(t._sticky=e&&!t.supportsReAuth,r||t._sticky)throw await t.release(),b("Driver is connected to a database that does not support user switch.")}async close(){await this._connectionPool.close(),await Promise.all(Object.values(this._openConnections).map(e=>e.close()))}static _installIdleObserverOnConnection(e,t){e._setIdle(t)}static _removeIdleObserverOnConnection(e){e._unsetIdle()}_handleSecurityError(e,t,r){return this._authenticationProvider.handleError({connection:r,code:e.code})&&(e.retriable=!0),"Neo.ClientError.Security.AuthorizationExpired"===e.code&&this._connectionPool.apply(t,e=>{e.authToken=null}),r&&r.close().catch(()=>{}),e}}const{BOLT_PROTOCOL_V3:wa,BOLT_PROTOCOL_V4_0:Ea,BOLT_PROTOCOL_V4_4:Ta,BOLT_PROTOCOL_V5_1:Ca}=t["constants"],Oa=s["SERVICE_UNAVAILABLE"];class Ia extends va{constructor({id:e,config:t,log:r,address:n,userAgent:o,boltAgent:i,authTokenManager:s,newPool:a}){super({id:e,config:t,log:r,userAgent:o,boltAgent:i,authTokenManager:s,newPool:a}),this._address=n}async acquireConnection({database:n,auth:e,forceReAuth:t}={}){var r=_a.create({errorCode:Oa,handleSecurityError:(e,t,r)=>this._handleSecurityError(e,t,r,n)}),t=await this._connectionPool.acquire({auth:e,forceReAuth:t},this._address);return e?(await this._verifyStickyConnection({auth:e,connection:t,address:this._address}),t):new ca(t,r)}_handleSecurityError(e,t,r,n){return this._log.warn(`Direct driver ${this._id} will close connection to ${t} for database '${n}' because of an error ${e.code} '${e.message}'`),super._handleSecurityError(e,t,r)}async _hasProtocolVersion(e){var t=await la(this._address,this._config,this._createConnectionErrorHandler(),this._log),r=t.protocol()?t.protocol().version:null;return await t.close(),!!r&&e(r)}async supportsMultiDb(){return this._hasProtocolVersion(e=>e>=Ea)}getNegotiatedProtocolVersion(){return new Promise((e,t)=>{this._hasProtocolVersion(e).catch(t)})}async supportsTransactionConfig(){return this._hasProtocolVersion(e=>e>=wa)}async supportsUserImpersonation(){return this._hasProtocolVersion(e=>e>=Ta)}async supportsSessionAuth(){return this._hasProtocolVersion(e=>e>=Ca)}async verifyAuthentication({auth:e}){return this._verifyAuthentication({auth:e,getAddress:()=>this._address})}async verifyConnectivityAndGetServerInfo(){return this._verifyConnectivityAndGetServerVersion({address:this._address})}}const{constants:{ACCESS_MODE_WRITE:ka,ACCESS_MODE_READ:Ra},serverAddress:{ServerAddress:Sa}}=t,Pa=s["PROTOCOL_ERROR"];class Na{constructor({database:e,routers:t,readers:r,writers:n,expirationTime:o,ttl:i}={}){this.database=e||null,this.databaseName=e||"default database",this.routers=t||[],this.readers=r||[],this.writers=n||[],this.expirationTime=o||c(0),this.ttl=i}static fromRawRoutingTable(e,t,r){var n=r.ttl,o=function(t,r){try{var e=c(Date.now()),n=c(t.ttl).multiply(1e3).add(e);return n.lessThan(e)?d.MAX_VALUE:n}catch(e){throw b(`Unable to parse TTL entry from router ${r} from raw routing table:
${f(t)}
Error message: `+e.message,Pa)}}(r,t),{routers:i,readers:s,writers:a}=function(t,r){try{let r=[],n=[],o=[];return t.servers.forEach(e=>{var t=e.role,e=e.addresses;"ROUTE"===t?r=La(e).map(e=>Sa.fromUrl(e)):"WRITE"===t?o=La(e).map(e=>Sa.fromUrl(e)):"READ"===t&&(n=La(e).map(e=>Sa.fromUrl(e)))}),{routers:r,readers:n,writers:o}}catch(e){throw b(`Unable to parse servers entry from router ${r} from addresses:
${f(t.servers)}
Error message: `+e.message,Pa)}}(r,t);return Ua(i,"routers",t),Ua(s,"readers",t),new Na({database:e||r.db,routers:i,readers:s,writers:a,expirationTime:o,ttl:n})}forget(e){this.readers=Aa(this.readers,e),this.writers=Aa(this.writers,e)}forgetRouter(e){this.routers=Aa(this.routers,e)}forgetWriter(e){this.writers=Aa(this.writers,e)}isStaleFor(e){return this.expirationTime.lessThan(Date.now())||this.routers.length<1||e===Ra&&0===this.readers.length||e===ka&&0===this.writers.length}isExpiredFor(e){return this.expirationTime.add(e).lessThan(Date.now())}allServers(){return[...this.routers,...this.readers,...this.writers]}toString(){return"RoutingTable["+`database=${this.databaseName}, `+`expirationTime=${this.expirationTime}, `+`currentTime=${Date.now()}, `+`routers=[${this.routers}], `+`readers=[${this.readers}], `+`writers=[${this.writers}]]`}}function Aa(e,t){return e.filter(e=>e.asKey()!==t.asKey())}function Ua(e,t,r){if(0===e.length)throw b("Received no "+t+" from router "+r,Pa)}function La(e){if(Array.isArray(e))return Array.from(e);throw new TypeError("Array expected but got: "+e)}class Da{constructor(e){this._routingContext=e}lookupRoutingTableOnRouter(t,r,n,o){return t._acquireConnection(e=>this._requestRawRoutingTable(e,t,r,n,o).then(e=>e.isNull?null:Na.fromRawRoutingTable(r,n,e)))}_requestRawRoutingTable(r,n,o,e,i){return new Promise((e,t)=>{r.protocol().requestRoutingInformation({routingContext:this._routingContext,databaseName:o,impersonatedUser:i,sessionContext:{bookmarks:n._lastBookmarks,mode:n._mode,database:n._database,afterComplete:n._onComplete},onCompleted:e,onError:t})})}}const{SERVICE_UNAVAILABLE:Ba,SESSION_EXPIRED:xa}=s,{bookmarks:{Bookmarks:Ma},constants:{ACCESS_MODE_READ:Fa,ACCESS_MODE_WRITE:ja,BOLT_PROTOCOL_V3:qa,BOLT_PROTOCOL_V4_0:za,BOLT_PROTOCOL_V4_4:Ha,BOLT_PROTOCOL_V5_1:Wa}}=t,Va=null,$a=c(3e4);class Ka extends va{constructor({id:e,address:t,routingContext:r,hostNameResolver:n,config:o,log:i,userAgent:s,boltAgent:a,authTokenManager:u,routingTablePurgeDelay:l,newPool:h}){super({id:e,config:o,log:i,userAgent:s,boltAgent:a,authTokenManager:u,newPool:h},e=>la(e,this._config,this._createConnectionErrorHandler(),this._log,this._routingContext)),this._routingContext={...r,address:t.toString()},this._seedRouter=t,this._rediscovery=new Da(this._routingContext),this._loadBalancingStrategy=new On(this._connectionPool),this._hostNameResolver=n,this._dnsResolver=new bo,this._log=i,this._useSeedRouter=!0,this._routingTableRegistry=new Ga(l?c(l):$a),this._refreshRoutingTable=function(r,n=null){const o=new Map;return function(...e){const t=f(e);return o.has(t)?o.get(t):(e=r.apply(n,e),o.set(t,e),e.finally(()=>{o.delete(t)}))}}(this._refreshRoutingTable,this)}_createConnectionErrorHandler(){return new _a(xa)}_handleUnavailability(e,t,r){return this._log.warn(`Routing driver ${this._id} will forget ${t} for database '${r}' because of an error ${e.code} '${e.message}'`),this.forget(t,r||Va),e}_handleSecurityError(e,t,r,n){return this._log.warn(`Routing driver ${this._id} will close connections to ${t} for database '${n}' because of an error ${e.code} '${e.message}'`),super._handleSecurityError(e,t,r,n)}_handleWriteFailure(e,t,r){return this._log.warn(`Routing driver ${this._id} will forget writer ${t} for database '${r}' because of an error ${e.code} '${e.message}'`),this.forgetWriter(t,r||Va),b("No longer possible to write to server at "+t,xa,e)}async acquireConnection({accessMode:e,database:t,bookmarks:r,impersonatedUser:n,onDatabaseNameResolved:o,auth:i}={}){let s,a;const u={database:t||Va};t=new _a(xa,(e,t)=>this._handleUnavailability(e,t,u.database),(e,t)=>this._handleWriteFailure(e,t,u.database),(e,t,r)=>this._handleSecurityError(e,t,r,u.database)),r=await this._freshRoutingTable({accessMode:e,database:u.database,bookmarks:r,impersonatedUser:n,auth:i,onDatabaseNameResolved:e=>{u.database=u.database||e,o&&o(e)}});if(e===Fa)a=this._loadBalancingStrategy.selectReader(r.readers),s="read";else{if(e!==ja)throw b("Illegal mode "+e);a=this._loadBalancingStrategy.selectWriter(r.writers),s="write"}if(!a)throw b(`Failed to obtain connection towards ${s} server. Known routing table is: `+r,xa);try{var l=await this._connectionPool.acquire({auth:i},a);return i?(await this._verifyStickyConnection({auth:i,connection:l,address:a}),l):new ca(l,t)}catch(e){throw t.handleAndTransformError(e,a)}}async _hasProtocolVersion(t){var r=await this._resolveSeedRouter(this._seedRouter);let n;for(let e=0;e<r.length;e++)try{var o=await la(r[e],this._config,this._createConnectionErrorHandler(),this._log),i=o.protocol()?o.protocol().version:null;return await o.close(),i?t(i):!1}catch(e){n=e}if(n)throw n;return!1}async supportsMultiDb(){return this._hasProtocolVersion(e=>e>=za)}async supportsTransactionConfig(){return this._hasProtocolVersion(e=>e>=qa)}async supportsUserImpersonation(){return this._hasProtocolVersion(e=>e>=Ha)}async supportsSessionAuth(){return this._hasProtocolVersion(e=>e>=Wa)}getNegotiatedProtocolVersion(){return new Promise((e,t)=>{this._hasProtocolVersion(e).catch(t)})}async verifyAuthentication({database:r,accessMode:n,auth:o}){return this._verifyAuthentication({auth:o,getAddress:async()=>{const t={database:r||Va};var e=await this._freshRoutingTable({accessMode:n,database:t.database,auth:o,onDatabaseNameResolved:e=>{t.database=t.database||e}}),e=n===ja?e.writers:e.readers;if(0===e.length)throw b(`No servers available for database '${t.database}' with access mode '${n}'`,Ba);return e[0]}})}async verifyConnectivityAndGetServerInfo({database:e,accessMode:t}){const r={database:e||Va};e=await this._freshRoutingTable({accessMode:t,database:r.database,onDatabaseNameResolved:e=>{r.database=r.database||e}}),e=t===ja?e.writers:e.readers;let n=b(`No servers available for database '${r.database}' with access mode '${t}'`,Ba);for(const o of e)try{return await this._verifyConnectivityAndGetServerVersion({address:o})}catch(e){n=e}throw n}forget(t,e){this._routingTableRegistry.apply(e,{applyWhenExists:e=>e.forget(t)}),this._connectionPool.purge(t).catch(()=>{})}forgetWriter(t,e){this._routingTableRegistry.apply(e,{applyWhenExists:e=>e.forgetWriter(t)})}_freshRoutingTable({accessMode:e,database:t,bookmarks:r,impersonatedUser:n,onDatabaseNameResolved:o,auth:i}={}){var s=this._routingTableRegistry.get(t,()=>new Na({database:t}));return s.isStaleFor(e)?(this._log.info(`Routing table is stale for database: "${t}" and access mode: "${e}": `+s),this._refreshRoutingTable(s,r,n,i).then(e=>(o(e.database),e))):s}_refreshRoutingTable(e,t,r,n){var o=e.routers;return this._useSeedRouter?this._fetchRoutingTableFromSeedRouterFallbackToKnownRouters(o,e,t,r,n):this._fetchRoutingTableFromKnownRoutersFallbackToSeedRouter(o,e,t,r,n)}async _fetchRoutingTableFromSeedRouterFallbackToKnownRouters(e,t,r,n,o){let[i,s]=await this._fetchRoutingTableUsingSeedRouter([],this._seedRouter,t,r,n,o);return i?this._useSeedRouter=!1:([e,r]=await this._fetchRoutingTableUsingKnownRouters(e,t,r,n,o),i=e,s=r||s),this._applyRoutingTableIfPossible(t,i,s)}async _fetchRoutingTableFromKnownRoutersFallbackToSeedRouter(e,t,r,n,o){let[i,s]=await this._fetchRoutingTableUsingKnownRouters(e,t,r,n,o);return i||([i,s]=await this._fetchRoutingTableUsingSeedRouter(e,this._seedRouter,t,r,n,o)),this._applyRoutingTableIfPossible(t,i,s)}async _fetchRoutingTableUsingKnownRouters(e,t,r,n,o){var[r,n]=await this._fetchRoutingTable(e,t,r,n,o);return r?[r,null]:(o=e.length-1,Ka._forgetRouter(t,e,o),[null,n])}async _fetchRoutingTableUsingSeedRouter(t,e,r,n,o,i){e=(await this._resolveSeedRouter(e)).filter(e=>t.indexOf(e)<0);return this._fetchRoutingTable(e,r,n,o,i)}async _resolveSeedRouter(e){e=await this._hostNameResolver.resolve(e),e=await Promise.all(e.map(e=>this._dnsResolver.resolve(e)));return[].concat.apply([],e)}async _fetchRoutingTable(o,i,s,a,u){return o.reduce(async(e,t,r)=>{var[e]=await e;if(e)return[e,null];var e=r-1,[r,n]=(Ka._forgetRouter(i,o,e),await this._createSessionForRediscovery(t,s,a,u));if(!r)return[null,n];try{return[await this._rediscovery.lookupRoutingTableOnRouter(r,i.database,t,a),null]}catch(n){return this._handleRediscoveryError(n,t)}finally{r.close()}},Promise.resolve([null,null]))}async _createSessionForRediscovery(t,e,r,n){try{var o=await this._connectionPool.acquire({auth:n},t),i=(n&&await this._verifyStickyConnection({auth:n,connection:o,address:t}),_a.create({errorCode:xa,handleSecurityError:(e,t,r)=>this._handleSecurityError(e,t,r)})),s=o._sticky?new ca(o):new ca(o,i),a=new oa(s);return o.protocol().version<4?[new nn({mode:ja,bookmarks:Ma.empty(),connectionProvider:a}),null]:[new nn({mode:Fa,database:"system",bookmarks:e,connectionProvider:a,impersonatedUser:r}),null]}catch(e){return this._handleRediscoveryError(e,t)}}_handleRediscoveryError(e,t){if(["Neo.ClientError.Database.DatabaseNotFound","Neo.ClientError.Transaction.InvalidBookmark","Neo.ClientError.Transaction.InvalidBookmarkMixture","Neo.ClientError.Statement.ArgumentError","Neo.ClientError.Request.Invalid","Neo.ClientError.Statement.TypeError","N/A"].includes(e.code)||(r=e).code.startsWith("Neo.ClientError.Security.")&&!["Neo.ClientError.Security.AuthorizationExpired"].includes(r.code))throw e;if("Neo.ClientError.Procedure.ProcedureNotFound"===e.code)throw b(`Server at ${t.asHostPort()} can't perform routing. Make sure you are connecting to a causal cluster`,Ba,e);var r;return this._log.warn("unable to fetch routing table because of an error "+e),[null,e]}async _applyRoutingTableIfPossible(e,t,r){if(t)return 0===t.writers.length&&(this._useSeedRouter=!0),await this._updateRoutingTable(t),t;throw b("Could not perform discovery. No routing servers available. Known routing table: "+e,Ba,r)}async _updateRoutingTable(e){await this._connectionPool.keepAll(e.allServers()),this._routingTableRegistry.removeExpired(),this._routingTableRegistry.register(e),this._log.info("Updated routing table "+e)}static _forgetRouter(e,t,r){t=t[r];e&&t&&e.forgetRouter(t)}}class Ga{constructor(e){this._tables=new Map,this._routingTablePurgeDelay=e}register(e){return this._tables.set(e.database,e),this}apply(e,{applyWhenExists:t,applyWhenDontExists:r=()=>{}}={}){return this._tables.has(e)?t(this._tables.get(e)):"string"==typeof e||null===e?r():this._forEach(t),this}get(e,t){return this._tables.has(e)?this._tables.get(e):"function"==typeof t?t():t}removeExpired(){return this._removeIf(e=>e.isExpiredFor(this._routingTablePurgeDelay))}_forEach(e){for(var[,t]of this._tables)e(t);return this}_remove(e){return this._tables.delete(e),this}_removeIf(e){for(var[t,r]of this._tables)e(r)&&this._remove(t);return this}}var Ya,Za,Xa,Qa,D,Ja,eu,tu,ru,nu,ou,iu,ee=M(Object.freeze({__proto__:null,loadBalancing:Fr,bolt:ie,buf:Ir,channel:sr,packstream:Pr,pool:ur,SingleConnectionProvider:oa,PooledConnectionProvider:va,DirectConnectionProvider:Ia,RoutingConnectionProvider:Ka}));function su(e,t,r){void 0===r&&(r={}),tu(e,"Bolt URL");var n,o,i=ou.parseDatabaseUrl(e),s=!1,a=!1;switch(i.scheme){case"bolt":break;case"bolt+s":a=!0,o="TRUST_SYSTEM_CA_SIGNED_CERTIFICATES";break;case"bolt+ssc":a=!0,o="TRUST_ALL_CERTIFICATES";break;case"neo4j":s=!0;break;case"neo4j+s":o="TRUST_SYSTEM_CA_SIGNED_CERTIFICATES",s=a=!0;break;case"neo4j+ssc":o="TRUST_ALL_CERTIFICATES",s=a=!0;break;default:throw new Error("Unknown scheme: ".concat(null!=(n=i.scheme)?n:"null"))}if(a){if("encrypted"in r||"trust"in r)throw new Error("Encryption/trust can only be configured either through URL or config, not both");r.encrypted=eu,r.trust=o}var u="object"==typeof(h=t=t)&&null!=h&&"getToken"in h&&"handleSecurityException"in h&&"function"==typeof h.getToken&&"function"==typeof h.handleSecurityException?t:((h=null!=(h=t)?h:{}).scheme=null!=(t=h.scheme)?t:"none",(0,D.staticAuthTokenManager)({authToken:h})),l=(r.userAgent=null!=(t=r.userAgent)?t:iu,r.boltAgent=D.internal.boltAgent.fromVersion("neo4j-javascript/"+Xa.default),nu.fromUrl(i.hostAndPort)),h={address:l,typename:s?"Routing":"Direct",routing:s};return new D.Driver(h,r,function(){{if(s)return function(e,t,r,n){return new Ja.RoutingConnectionProvider({id:e,config:t,log:r,hostNameResolver:n,authTokenManager:u,address:l,userAgent:t.userAgent,boltAgent:t.boltAgent,routingContext:i.query})};if(ru(i.query))return function(e,t,r){return new Ja.DirectConnectionProvider({id:e,config:t,log:r,authTokenManager:u,address:l,userAgent:t.userAgent,boltAgent:t.boltAgent})};throw new Error("Parameters are not supported with none routed scheme. Given URL: '".concat(e,"'"))}}())}function au(r,n){return Ya(this,void 0,void 0,function(){var t;return Za(this,function(e){switch(e.label){case 0:t=su(r,{scheme:"none",principal:"",credentials:""},n),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,t.getNegotiatedProtocolVersion()];case 2:return e.sent(),[2,!0];case 3:return[4,t.close()];case 4:return e.sent(),[7];case 5:return[2]}})})}return e=F,Ya=B&&B.__awaiter||function(e,s,a,u){return new(a=a||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}i((u=u.apply(e,s||[])).next())})},Za=B&&B.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},l={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=l&&t[l=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},i=B&&B.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(e,"__esModule",{value:!0}),e.Point=e.TransactionPromise=e.ManagedTransaction=e.Transaction=e.Session=e.ServerInfo=e.Notification=e.QueryStatistics=e.ProfiledPlan=e.Plan=e.Integer=e.Path=e.PathSegment=e.UnboundRelationship=e.Relationship=e.Node=e.ResultSummary=e.Record=e.EagerResult=e.Result=e.Driver=e.temporal=e.spatial=e.graph=e.error=e.routing=e.session=e.types=e.logging=e.auth=e.isRetriableError=e.Neo4jError=e.integer=e.isUnboundRelationship=e.isRelationship=e.isPathSegment=e.isPath=e.isNode=e.isDateTime=e.isLocalDateTime=e.isDate=e.isTime=e.isLocalTime=e.isDuration=e.isPoint=e.isInt=e.int=e.hasReachableServer=e.driver=e.authTokenManagers=void 0,e.notificationFilterMinimumSeverityLevel=e.notificationFilterDisabledCategory=e.notificationSeverityLevel=e.notificationCategory=e.resultTransformers=e.bookmarkManager=e.Connection=e.ConnectionProvider=e.DateTime=e.LocalDateTime=e.Date=e.Time=e.LocalTime=e.Duration=void 0,Xa=i(j),Qa=q,Object.defineProperty(e,"logging",{enumerable:!0,get:function(){return Qa.logging}}),D=wr,Object.defineProperty(e,"auth",{enumerable:!0,get:function(){return D.auth}}),Object.defineProperty(e,"authTokenManagers",{enumerable:!0,get:function(){return D.authTokenManagers}}),Object.defineProperty(e,"bookmarkManager",{enumerable:!0,get:function(){return D.bookmarkManager}}),Object.defineProperty(e,"Connection",{enumerable:!0,get:function(){return D.Connection}}),Object.defineProperty(e,"ConnectionProvider",{enumerable:!0,get:function(){return D.ConnectionProvider}}),Object.defineProperty(e,"Date",{enumerable:!0,get:function(){return D.Date}}),Object.defineProperty(e,"DateTime",{enumerable:!0,get:function(){return D.DateTime}}),Object.defineProperty(e,"Driver",{enumerable:!0,get:function(){return D.Driver}}),Object.defineProperty(e,"Duration",{enumerable:!0,get:function(){return D.Duration}}),Object.defineProperty(e,"EagerResult",{enumerable:!0,get:function(){return D.EagerResult}}),Object.defineProperty(e,"error",{enumerable:!0,get:function(){return D.error}}),Object.defineProperty(e,"int",{enumerable:!0,get:function(){return D.int}}),Object.defineProperty(e,"Integer",{enumerable:!0,get:function(){return D.Integer}}),Object.defineProperty(e,"isDate",{enumerable:!0,get:function(){return D.isDate}}),Object.defineProperty(e,"isDateTime",{enumerable:!0,get:function(){return D.isDateTime}}),Object.defineProperty(e,"isDuration",{enumerable:!0,get:function(){return D.isDuration}}),Object.defineProperty(e,"isInt",{enumerable:!0,get:function(){return D.isInt}}),Object.defineProperty(e,"isLocalDateTime",{enumerable:!0,get:function(){return D.isLocalDateTime}}),Object.defineProperty(e,"isLocalTime",{enumerable:!0,get:function(){return D.isLocalTime}}),Object.defineProperty(e,"isNode",{enumerable:!0,get:function(){return D.isNode}}),Object.defineProperty(e,"isPath",{enumerable:!0,get:function(){return D.isPath}}),Object.defineProperty(e,"isPathSegment",{enumerable:!0,get:function(){return D.isPathSegment}}),Object.defineProperty(e,"isPoint",{enumerable:!0,get:function(){return D.isPoint}}),Object.defineProperty(e,"isRelationship",{enumerable:!0,get:function(){return D.isRelationship}}),Object.defineProperty(e,"isRetriableError",{enumerable:!0,get:function(){return D.isRetriableError}}),Object.defineProperty(e,"isTime",{enumerable:!0,get:function(){return D.isTime}}),Object.defineProperty(e,"isUnboundRelationship",{enumerable:!0,get:function(){return D.isUnboundRelationship}}),Object.defineProperty(e,"LocalDateTime",{enumerable:!0,get:function(){return D.LocalDateTime}}),Object.defineProperty(e,"LocalTime",{enumerable:!0,get:function(){return D.LocalTime}}),Object.defineProperty(e,"ManagedTransaction",{enumerable:!0,get:function(){return D.ManagedTransaction}}),Object.defineProperty(e,"Neo4jError",{enumerable:!0,get:function(){return D.Neo4jError}}),Object.defineProperty(e,"Node",{enumerable:!0,get:function(){return D.Node}}),Object.defineProperty(e,"Notification",{enumerable:!0,get:function(){return D.Notification}}),Object.defineProperty(e,"notificationCategory",{enumerable:!0,get:function(){return D.notificationCategory}}),Object.defineProperty(e,"notificationFilterDisabledCategory",{enumerable:!0,get:function(){return D.notificationFilterDisabledCategory}}),Object.defineProperty(e,"notificationFilterMinimumSeverityLevel",{enumerable:!0,get:function(){return D.notificationFilterMinimumSeverityLevel}}),Object.defineProperty(e,"notificationSeverityLevel",{enumerable:!0,get:function(){return D.notificationSeverityLevel}}),Object.defineProperty(e,"Path",{enumerable:!0,get:function(){return D.Path}}),Object.defineProperty(e,"PathSegment",{enumerable:!0,get:function(){return D.PathSegment}}),Object.defineProperty(e,"Plan",{enumerable:!0,get:function(){return D.Plan}}),Object.defineProperty(e,"Point",{enumerable:!0,get:function(){return D.Point}}),Object.defineProperty(e,"ProfiledPlan",{enumerable:!0,get:function(){return D.ProfiledPlan}}),Object.defineProperty(e,"QueryStatistics",{enumerable:!0,get:function(){return D.QueryStatistics}}),Object.defineProperty(e,"Record",{enumerable:!0,get:function(){return D.Record}}),Object.defineProperty(e,"Relationship",{enumerable:!0,get:function(){return D.Relationship}}),Object.defineProperty(e,"Result",{enumerable:!0,get:function(){return D.Result}}),Object.defineProperty(e,"ResultSummary",{enumerable:!0,get:function(){return D.ResultSummary}}),Object.defineProperty(e,"resultTransformers",{enumerable:!0,get:function(){return D.resultTransformers}}),Object.defineProperty(e,"routing",{enumerable:!0,get:function(){return D.routing}}),Object.defineProperty(e,"ServerInfo",{enumerable:!0,get:function(){return D.ServerInfo}}),Object.defineProperty(e,"Session",{enumerable:!0,get:function(){return D.Session}}),Object.defineProperty(e,"Time",{enumerable:!0,get:function(){return D.Time}}),Object.defineProperty(e,"Transaction",{enumerable:!0,get:function(){return D.Transaction}}),Object.defineProperty(e,"TransactionPromise",{enumerable:!0,get:function(){return D.TransactionPromise}}),Object.defineProperty(e,"UnboundRelationship",{enumerable:!0,get:function(){return D.UnboundRelationship}}),Ja=ee,i=D.driver.READ,r=D.driver.WRITE,n=D.internal.util,eu=n.ENCRYPTION_ON,tu=n.assertString,ru=n.isEmptyObjectOrNull,nu=D.internal.serverAddress.ServerAddress,ou=D.internal.urlUtil,iu="neo4j-javascript/"+Xa.default,e.driver=su,e.hasReachableServer=au,n={Node:D.Node,Relationship:D.Relationship,UnboundRelationship:D.UnboundRelationship,PathSegment:D.PathSegment,Path:D.Path,Result:D.Result,EagerResult:D.EagerResult,ResultSummary:D.ResultSummary,Record:D.Record,Point:D.Point,Date:D.Date,DateTime:D.DateTime,Duration:D.Duration,LocalDateTime:D.LocalDateTime,LocalTime:D.LocalTime,Time:D.Time,Integer:D.Integer},e.types=n,i={READ:i,WRITE:r},e.session=i,r={toNumber:D.toNumber,toString:D.toString,inSafeRange:D.inSafeRange},e.integer=r,se={isPoint:D.isPoint},e.spatial=se,rr={isDuration:D.isDuration,isLocalTime:D.isLocalTime,isTime:D.isTime,isDate:D.isDate,isLocalDateTime:D.isLocalDateTime,isDateTime:D.isDateTime},e.temporal=rr,nr={isNode:D.isNode,isPath:D.isPath,isPathSegment:D.isPathSegment,isRelationship:D.isRelationship,isUnboundRelationship:D.isUnboundRelationship},e.graph=nr,r={authTokenManagers:D.authTokenManagers,driver:su,hasReachableServer:au,int:D.int,isInt:D.isInt,isPoint:D.isPoint,isDuration:D.isDuration,isLocalTime:D.isLocalTime,isTime:D.isTime,isDate:D.isDate,isLocalDateTime:D.isLocalDateTime,isDateTime:D.isDateTime,isNode:D.isNode,isPath:D.isPath,isPathSegment:D.isPathSegment,isRelationship:D.isRelationship,isUnboundRelationship:D.isUnboundRelationship,integer:r,Neo4jError:D.Neo4jError,isRetriableError:D.isRetriableError,auth:D.auth,logging:Qa.logging,types:n,session:i,routing:D.routing,error:D.error,graph:nr,spatial:se,temporal:rr,Driver:D.Driver,Result:D.Result,EagerResult:D.EagerResult,Record:D.Record,ResultSummary:D.ResultSummary,Node:D.Node,Relationship:D.Relationship,UnboundRelationship:D.UnboundRelationship,PathSegment:D.PathSegment,Path:D.Path,Integer:D.Integer,Plan:D.Plan,ProfiledPlan:D.ProfiledPlan,QueryStatistics:D.QueryStatistics,Notification:D.Notification,ServerInfo:D.ServerInfo,Session:D.Session,Transaction:D.Transaction,ManagedTransaction:D.ManagedTransaction,TransactionPromise:D.TransactionPromise,Point:D.Point,Duration:D.Duration,LocalTime:D.LocalTime,Time:D.Time,Date:D.Date,LocalDateTime:D.LocalDateTime,DateTime:D.DateTime,ConnectionProvider:D.ConnectionProvider,Connection:D.Connection,bookmarkManager:D.bookmarkManager,resultTransformers:D.resultTransformers,notificationCategory:D.notificationCategory,notificationSeverityLevel:D.notificationSeverityLevel,notificationFilterDisabledCategory:D.notificationFilterDisabledCategory,notificationFilterMinimumSeverityLevel:D.notificationFilterMinimumSeverityLevel},e.default=r,x(F)});